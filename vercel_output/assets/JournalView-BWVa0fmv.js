import{r,j as e,b as je,u as V,X as se,i as we,v as Ne,E as ve,w as ae,o as ye,x as Ie}from"./index-C_wh12VC.js";import{L as Ee}from"./layers-BfTQ0xnS.js";import{A as Ce}from"./activity-CSpgSpRj.js";import{C as ie}from"./cpu-CzvPIB9o.js";import{T as B}from"./trash-2-jU8c7DBL.js";import{P as oe}from"./plus-DxWt7pTx.js";import{P as _}from"./pen-eXhOs42E.js";import{C as le}from"./calendar-DDJebUyn.js";import{S as ke}from"./save-DCqxreCc.js";import{C as Se}from"./check-DWNOK3BQ.js";const Fe=({journalEntries:u,addJournalEntry:ne,customers:X,suppliers:G,treasuries:H,employees:S,partners:q,currentUser:I,deleteJournalEntry:J,editJournalEntry:re,searchTerm:A="",currencies:K,settings:f,costCenters:R,masterTrips:T,programs:E,enableCostCenters:L,formatCurrency:de,initialEditingId:z,onClearInitialEdit:Q})=>{const d=I?.permissions?.includes("HIDE_FINANCIAL_AMOUNTS"),ce=I?.role==="BOOKING_EMPLOYEE",xe=d||ce,[w,P]=r.useState(!1),[$,M]=r.useState(""),[O,D]=r.useState(new Date().toISOString().split("T")[0]),[c,N]=r.useState([{accountId:"",accountType:"TREASURY",accountName:"",debit:0,credit:0,currencyCode:f.baseCurrency,exchangeRate:1,originalAmount:0,programId:"",componentId:""},{accountId:"",accountType:"EXPENSE",accountName:"",debit:0,credit:0,currencyCode:f.baseCurrency,exchangeRate:1,originalAmount:0,programId:"",componentId:""}]),[C,W]=r.useState(null),[v,F]=r.useState([]),[U,Z]=r.useState(null),[pe,ee]=r.useState(null),me=(s,a)=>{navigator.clipboard.writeText(s),Z(a),setTimeout(()=>Z(null),2e3)};r.useEffect(()=>{if(z){const s=u.find(a=>a.id===z);s&&(s.description.includes("سند")||s.description.includes("حجز")||s.description.includes("تأشيرة")||s.description.includes("تسكين")||s.description.includes("مقاصة")?(ee(s.id),setTimeout(()=>{const a=document.getElementById(`journal-entry-${s.id}`);a&&(a.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>ee(null),3e3))},500)):te(s)),Q?.()}},[z,u,Q]);const ue=()=>{v.length===y.length?F([]):F(y.map(s=>s.id))},he=()=>{const s=v.filter(a=>{const t=u.find(n=>n.id===a);return t&&!(t.description.includes("سند")||t.description.includes("حجز")||t.description.includes("تأشيرة"))});if(s.length===0){alert("لا يمكن حذف القيود الآلية جماعياً، يرجى تحديد قيود يدوية فقط");return}confirm(`هل أنت متأكد من حذف ${s.length} من القيود اليدوية المحددة؟`)&&(s.forEach(a=>J(a)),F([]))},k=r.useMemo(()=>{const s=u||[],a=s.length,t=s.reduce((j,h)=>j+(h?.totalAmount||0),0),n=s.filter(j=>{const h=j?.description||"";return!h.includes("سند")&&!h.includes("حجز")&&!h.includes("تأشيرة")}).length,i=a-n;return{total:a,totalValue:t,manual:n,automated:i}},[u]),p=r.useMemo(()=>(c||[]).reduce((s,a)=>({debit:s.debit+(parseFloat(a?.debit)||0),credit:s.credit+(parseFloat(a?.credit)||0)}),{debit:0,credit:0}),[c]),y=r.useMemo(()=>(u||[]).filter(s=>{if(!s)return!1;if(!A)return!0;const a=A.toLowerCase();return(s.description||"").toLowerCase().includes(a)||(s.refNo||"").toLowerCase().includes(a)||(s.lines||[]).some(t=>(t?.accountName||"").toLowerCase().includes(a))}).sort((s,a)=>(a?.date||"").localeCompare(s?.date||"")),[u,A]),g=p.debit===p.credit&&p.debit>0,ge=()=>{N([...c,{accountId:"",accountType:"TREASURY",accountName:"",debit:0,credit:0,currencyCode:f.baseCurrency,exchangeRate:1,originalAmount:0,programId:"",componentId:""}])},be=s=>{c.length<=2||N(c.filter((a,t)=>t!==s))},te=s=>{s&&(W(s.id),M(s.description||""),D(s.date||new Date().toISOString().split("T")[0]),N((s.lines||[]).map(a=>({...a,id:void 0,currencyCode:a?.currencyCode||f.baseCurrency,exchangeRate:a?.exchangeRate||1,originalAmount:a?.originalAmount||parseFloat(a?.debit)||parseFloat(a?.credit)||0}))),P(!0))},x=(s,a,t)=>{const n=[...c];if(!n[s])return;let i={...n[s],[a]:t};if(a==="currencyCode"){const o=(K||[]).find(m=>m&&m.code===t);i.exchangeRate=o?.rateToMain||1}if(a==="originalAmount"||a==="exchangeRate"||a==="currencyCode"){const o=(parseFloat(i.originalAmount)||0)*(parseFloat(i.exchangeRate)||1);(i.debit||0)>0?(i.debit=o,i.credit=0):(i.credit||0)>0?(i.credit=o,i.debit=0):(i.debit=o,i.credit=0)}const j=parseFloat(i.exchangeRate)||1,h=j!==0?1/j:1;if(a==="debit"?(i.credit=0,i.originalAmount=(parseFloat(t)||0)*h):a==="credit"&&(i.debit=0,i.originalAmount=(parseFloat(t)||0)*h),a==="accountId"||a==="accountType"){const o=i.accountType,m=i.accountId;let b="";o==="TREASURY"?b=(H||[]).find(l=>l&&l.id===m)?.name||"":o==="CUSTOMER"?b=(X||[]).find(l=>l&&l.id===m)?.name||"":o==="SUPPLIER"?b=(G||[]).find(l=>l&&l.id===m)?.company||"":o==="LIABILITY"||o==="EMPLOYEE_ADVANCE"?b=(S||[]).find(l=>l&&l.id===m)?.name||"":o==="PARTNER"?b=(q||[]).find(l=>l&&l.id===m)?.name||"":(o==="EXPENSE"||o==="REVENUE")&&(b=m||""),i.accountName=b}n[s]=i,N(n)},Y=()=>{P(!1),W(null),M(""),D(new Date().toISOString().split("T")[0]),N([{accountId:"",accountType:"TREASURY",accountName:"",debit:0,credit:0,currencyCode:f.baseCurrency,exchangeRate:1,originalAmount:0,programId:"",componentId:""},{accountId:"",accountType:"EXPENSE",accountName:"",debit:0,credit:0,currencyCode:f.baseCurrency,exchangeRate:1,originalAmount:0,programId:"",componentId:""}])},fe=s=>{if(s.preventDefault(),!g)return;if(c.some(t=>!t.accountId)){alert("يرجى اختيار حساب لكل طرف في القيد");return}C?re(C,$,O,c):ne({date:O,description:$,lines:c.map((t,n)=>({...t,id:n.toString()})),totalAmount:p.debit}),Y()};return e.jsxs("div",{className:"space-y-12 pb-20",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 no-print",children:[e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm flex items-center gap-4 transition-all duration-300",children:[e.jsx("div",{className:"w-14 h-14 bg-indigo-600 text-white rounded-2xl flex items-center justify-center shadow-md",children:e.jsx(Ee,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"إجمالي القيود"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:k.total})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm flex items-center gap-4 transition-all duration-300",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-indigo-500 to-indigo-600 text-white rounded-2xl flex items-center justify-center shadow-md",children:e.jsx(je,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"حجم العمليات"}),e.jsx("p",{className:"text-2xl font-bold text-indigo-600 tracking-tight",children:xe?"****":de(k.totalValue||0)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm flex items-center gap-4 transition-all duration-300",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-indigo-400 to-indigo-500 text-white rounded-2xl flex items-center justify-center shadow-md",children:e.jsx(Ce,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"قيود يدوية"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:k.manual})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm flex items-center gap-4 transition-all duration-300",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-slate-600 to-slate-700 text-white rounded-2xl flex items-center justify-center shadow-md",children:e.jsx(ie,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"قيود مؤتمتة"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:k.automated})]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center bg-white p-8 rounded-3xl shadow-sm border border-slate-100 gap-8 no-print mt-8",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-16 h-16 bg-indigo-600 text-white rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(V,{size:32})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"دفتر اليومية الموحد"}),e.jsx("p",{className:"text-slate-400 font-bold text-sm uppercase tracking-widest",children:"المحرك المالي وتتبع القيود المزدوجة"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[v.length>0&&I.role==="ADMIN"&&e.jsxs("button",{onClick:he,className:"bg-rose-50 text-rose-600 px-8 py-3 rounded-xl font-bold text-sm flex items-center gap-3 hover:bg-rose-100 transition-all shadow-md active:scale-95",children:[e.jsx(B,{size:18}),"حذف المحدد (",v.length,")"]}),e.jsxs("button",{onClick:w?Y:()=>P(!0),className:`px-8 py-3 rounded-xl font-bold text-sm flex items-center gap-3 transition-all shadow-md active:scale-95 ${w?"bg-rose-50 text-rose-600 hover:bg-rose-100":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:[w?e.jsx(se,{size:18}):e.jsx(oe,{size:18}),w?"إلغاء العملية":"إضافة قيد يدوي"]})]})]}),w&&e.jsxs("form",{onSubmit:fe,className:"bg-white p-10 rounded-3xl border border-slate-200 shadow-xl space-y-10 animate-in fade-in zoom-in duration-500",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"p-4 rounded-2xl bg-indigo-600 text-white shadow-lg",children:e.jsx(_,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:C?"تعديل القيد اليدوي":"تحرير قيد يومية جديد"}),e.jsx("p",{className:"text-slate-400 font-bold text-xs mt-1 uppercase tracking-widest",children:"نموذج الإدخال المحاسبي المزدوج"})]})]}),e.jsx("button",{onClick:Y,className:"w-10 h-10 flex items-center justify-center rounded-full bg-slate-50 text-slate-400 hover:bg-rose-50 hover:text-rose-600 transition-all duration-300",children:e.jsx(se,{size:20})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{className:"text-[11px] font-bold text-slate-500 uppercase tracking-widest px-2",children:"البيان / وصف القيد"}),e.jsx("input",{required:!0,placeholder:"مثال: تسوية رصيد عهدة / شراء أصول...",className:"w-full p-4 bg-slate-50 rounded-xl font-bold text-slate-900 outline-none focus:ring-4 focus:ring-indigo-600 ring-opacity-10 border border-slate-200 focus:border-indigo-600 transition-all placeholder:text-slate-300",value:$,onChange:s=>M(s.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{className:"text-[11px] font-bold text-slate-500 uppercase tracking-widest px-2",children:"التاريخ"}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"date",required:!0,className:"w-full p-4 pr-12 bg-slate-50 rounded-xl font-bold text-slate-900 outline-none border border-slate-200 focus:border-slate-900 transition-all",value:O,onChange:s=>D(s.target.value)})]})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 shadow-sm bg-white",children:e.jsxs("table",{className:"w-full min-w-[1100px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white",children:[e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold uppercase tracking-widest text-right",children:"نوع الحساب"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold uppercase tracking-widest text-right",children:"الحساب المالي التفصيلي"}),L&&e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold uppercase tracking-widest text-right",children:"مركز التكلفة"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold uppercase tracking-widest text-right",children:"البرنامج والمكون"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold uppercase tracking-widest text-center w-24",children:"العملة"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold uppercase tracking-widest text-center w-28",children:"سعر الصرف"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold uppercase tracking-widest text-center w-36",children:"المبلغ (عملة)"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold uppercase tracking-widest text-center w-36",children:"مدين (+)"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold uppercase tracking-widest text-center w-36",children:"دائن (-)"}),e.jsx("th",{className:"px-6 py-5 w-16"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:c.map((s,a)=>e.jsxs("tr",{className:"group hover:bg-slate-50 bg-opacity-50 transition-colors duration-300",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsxs("select",{className:"w-full p-3 bg-white rounded-lg font-bold text-xs text-slate-900 border border-slate-200 focus:border-slate-900 outline-none shadow-sm transition-all",value:s.accountType,onChange:t=>x(a,"accountType",t.target.value),children:[e.jsx("option",{value:"TREASURY",children:"خزينة / بنك"}),e.jsx("option",{value:"CUSTOMER",children:"عميل (ذمم مدينة)"}),e.jsx("option",{value:"SUPPLIER",children:"مورد (ذمم دائنة)"}),e.jsx("option",{value:"LIABILITY",children:"موظف (حساب جاري)"}),e.jsx("option",{value:"EMPLOYEE_ADVANCE",children:"موظف (سلف)"}),e.jsx("option",{value:"PARTNER",children:"شريك (حساب جاري)"}),e.jsx("option",{value:"EXPENSE",children:"مصروف تشغيلي"}),e.jsx("option",{value:"REVENUE",children:"إيراد نشاط"})]})}),e.jsx("td",{className:"py-5 px-4",children:e.jsx(we,{options:s.accountType==="TREASURY"?(H||[]).map(t=>({id:t.id,name:t.name,subtext:`الرصيد: ${d?"****":(t.balance||0).toLocaleString()}`})):s.accountType==="CUSTOMER"?(X||[]).map(t=>({id:t.id,name:t.name,subtext:`الرصيد: ${d?"****":(t.balance||0).toLocaleString()}`})):s.accountType==="SUPPLIER"?(G||[]).map(t=>({id:t.id,name:t.company,subtext:`الرصيد: ${d?"****":(t.balance||0).toLocaleString()}`})):s.accountType==="LIABILITY"?(S||[]).map(t=>({id:t.id,name:t.name,subtext:`المستحقات: ${d?"****":(t.balance||0).toLocaleString()}`})):s.accountType==="EMPLOYEE_ADVANCE"?(S||[]).map(t=>({id:t.id,name:t.name,subtext:`السلف: ${d?"****":(t.advances||0).toLocaleString()}`})):s.accountType==="PARTNER"?(q||[]).map(t=>({id:t.id,name:t.name,subtext:`الرصيد: ${d?"****":(t.balance||0).toLocaleString()}`})):s.accountType==="REVENUE"?(Ne||[]).map(t=>({id:t,name:t})):(ve||[]).map(t=>({id:t,name:t})),value:s.accountId,onChange:t=>x(a,"accountId",t),placeholder:"ابحث عن الحساب...",className:"!p-0"})}),L&&e.jsx("td",{className:"py-4 px-2",children:e.jsxs("select",{className:"w-full p-3 bg-white rounded-lg font-bold text-xs text-slate-900 border border-slate-200 focus:border-slate-900 outline-none shadow-sm transition-all",value:s.costCenterId||"",onChange:t=>x(a,"costCenterId",t.target.value),children:[e.jsx("option",{value:"",children:"عام / بدون مركز"}),(R||[]).length>0&&e.jsx("optgroup",{label:"مراكز التكلفة العامة",children:(R||[]).filter(t=>t.isActive).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))}),(T||[]).length>0&&e.jsx("optgroup",{label:"الرحلات المجمعة",children:(T||[]).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]})}),e.jsx("td",{className:"py-4 px-2",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("select",{className:"w-full p-2 bg-white rounded-lg font-bold text-[10px] text-slate-900 border border-slate-200 outline-none",value:s.programId||"",onChange:t=>x(a,"programId",t.target.value),children:[e.jsx("option",{value:"",children:"برنامج (اختياري)"}),(E||[]).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),s.programId&&e.jsxs("select",{className:"w-full p-2 bg-indigo-50 rounded-lg font-bold text-[10px] text-indigo-700 border border-indigo-100 outline-none",value:s.componentId||"",onChange:t=>x(a,"componentId",t.target.value),children:[e.jsx("option",{value:"",children:"المكون..."}),((E||[]).find(t=>t.id===s.programId)?.components||[]).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]})}),e.jsx("td",{className:"py-4 px-2 text-center",children:e.jsx("select",{className:"w-full p-3 bg-white rounded-lg font-bold text-xs text-slate-900 border border-slate-200 outline-none shadow-sm",value:s.currencyCode,onChange:t=>x(a,"currencyCode",t.target.value),children:(K||[]).map(t=>e.jsx("option",{value:t.code,children:t.code},t.code))})}),e.jsx("td",{className:"py-4 px-2",children:e.jsx("input",{type:"number",step:"0.0001",className:"w-full p-3 bg-white rounded-lg font-bold text-center text-xs text-slate-900 border border-slate-200 outline-none shadow-sm",value:s.exchangeRate||"",onChange:t=>x(a,"exchangeRate",parseFloat(t.target.value||"0"))})}),e.jsx("td",{className:"py-4 px-2",children:e.jsx("input",{type:"number",className:"w-full p-3 bg-white rounded-lg font-bold text-center text-xs text-slate-900 border border-slate-200 focus:border-slate-900 outline-none shadow-sm",value:s.originalAmount||"",placeholder:"0",onChange:t=>x(a,"originalAmount",parseFloat(t.target.value||"0"))})}),e.jsx("td",{className:"py-4 px-2",children:e.jsx("input",{type:"number",className:"w-full p-3 bg-emerald-50 text-emerald-700 rounded-lg font-bold text-center text-sm border border-emerald-100 focus:border-emerald-600 outline-none shadow-sm",value:s.debit||"",placeholder:"0",onChange:t=>x(a,"debit",parseFloat(t.target.value||"0"))})}),e.jsx("td",{className:"py-4 px-2",children:e.jsx("input",{type:"number",className:"w-full p-3 bg-rose-50 text-rose-700 rounded-lg font-bold text-center text-sm border border-rose-100 focus:border-rose-500 outline-none shadow-sm",value:s.credit||"",placeholder:"0",onChange:t=>x(a,"credit",parseFloat(t.target.value||"0"))})}),e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsx("button",{type:"button",onClick:()=>be(a),className:"w-9 h-9 flex items-center justify-center rounded-lg text-slate-300 hover:bg-rose-50 hover:text-rose-600 transition-all duration-300",children:e.jsx(B,{size:18})})})]},a))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-indigo-600 text-white",children:[e.jsx("td",{colSpan:L?4:3,className:"py-6 px-10",children:e.jsxs("button",{type:"button",onClick:ge,className:"group flex items-center gap-4 hover:translate-x-[-4px] transition-transform",children:[e.jsx("div",{className:"w-8 h-8 bg-white text-indigo-600 rounded-lg flex items-center justify-center font-bold group-hover:rotate-90 transition-transform duration-500",children:e.jsx(oe,{size:20})}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-white",children:"إضافة طرف محاسبي للقيد"})]})}),e.jsx("td",{colSpan:4,className:"py-6 px-6 text-left",children:e.jsxs("div",{className:"flex justify-end gap-12",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest text-emerald-300 mb-1",children:"إجمالي مدين (+)"}),e.jsx("span",{className:"text-2xl font-bold tabular-nums tracking-tight text-white",children:d?"****":(p.debit||0).toLocaleString()})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest text-rose-300 mb-1",children:"إجمالي دائن (-)"}),e.jsx("span",{className:"text-2xl font-bold tabular-nums tracking-tight text-white",children:d?"****":(p.credit||0).toLocaleString()})]})]})}),e.jsx("td",{})]})})]})}),e.jsxs("div",{className:"flex items-center justify-between p-8 bg-indigo-600 rounded-2xl shadow-lg relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 left-0 w-64 h-64 bg-white bg-opacity-5 rounded-full blur-3xl -ml-32 -mt-32"}),e.jsxs("div",{className:"flex items-center gap-8 relative z-10",children:[e.jsxs("div",{className:`flex items-center gap-3 px-6 py-2.5 rounded-full font-bold text-[10px] uppercase tracking-widest shadow-inner ${g?"bg-white bg-opacity-20 text-white border border-white border-opacity-30":"bg-rose-500 bg-opacity-20 text-rose-400 border border-rose-500 border-opacity-30 animate-pulse"}`,children:[g?e.jsx(ae,{size:16}):e.jsx(ye,{size:16}),g?"توازن محاسبي مكتمل":"خلل في توازن القيد"]}),!g&&p.debit>0&&e.jsxs("p",{className:"text-rose-100 text-[10px] font-bold",children:["فرق التوازن: ",Math.abs(p.debit-p.credit).toLocaleString()]})]}),e.jsxs("button",{type:"submit",disabled:!g,className:`px-12 py-4 rounded-xl font-bold text-base shadow-xl transition-all duration-500 flex items-center gap-3 relative z-10 transform active:scale-95 ${g?"bg-white text-indigo-600 hover:bg-slate-50 shadow-white/10":"bg-indigo-800 text-indigo-400 cursor-not-allowed"}`,children:[e.jsx(ke,{size:20}),C?"حفظ التعديلات النهائية":"ترحيل القيد للمحرك المالي"]})]})]}),e.jsxs("div",{className:"bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"p-8 bg-indigo-600 flex justify-between items-center relative overflow-hidden no-print",children:[e.jsx("div",{className:"absolute right-0 top-0 w-64 h-64 bg-white bg-opacity-10 rounded-full blur-3xl -mr-32 -mt-32"}),e.jsxs("div",{className:"flex items-center gap-6 relative z-10",children:[I.role==="ADMIN"&&e.jsx("div",{className:"flex items-center bg-white/10 p-2 rounded-xl border border-white/20",children:e.jsx("input",{type:"checkbox",className:"w-5 h-5 rounded border-white/20 text-white focus:ring-white cursor-pointer bg-white/10",checked:y.length>0&&v.length===y.length,onChange:ue})}),e.jsx("div",{className:"w-14 h-14 bg-white text-indigo-600 rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(V,{size:28})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white uppercase tracking-widest text-lg",children:"أرشيف القيود المكتملة"}),e.jsxs("p",{className:"text-[10px] text-white text-opacity-70 font-bold uppercase tracking-widest mt-1 flex items-center gap-2",children:[e.jsx(ae,{size:12})," تتبع النشاط المالي الكامل (آلي + يدوي)"]})]})]}),e.jsx("div",{className:"flex items-center gap-3 bg-white/5 p-2 rounded-xl border border-white/10",children:e.jsx("span",{className:"text-[10px] font-bold text-white/40 uppercase tracking-widest px-4",children:"الترتيب الزمني: الأحدث أولاً"})})]}),e.jsxs("div",{className:"divide-y divide-slate-100",children:[(y||[]).map(s=>{const a=(s.description||"").includes("سند")||(s.description||"").includes("حجز")||(s.description||"").includes("تأشيرة");return e.jsxs("div",{id:`journal-entry-${s.id}`,className:`p-10 hover:bg-slate-50 bg-opacity-50 transition-all duration-500 group relative ${pe===s.id?"ring-4 ring-indigo-500 border-indigo-500 scale-[1.01] z-10 shadow-2xl bg-indigo-50/30":""}`,children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-10 gap-8",children:[e.jsxs("div",{className:"flex items-start gap-8",children:[e.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center shadow-sm transition-transform group-hover:scale-110 duration-500 ${a?"bg-slate-100 text-slate-400":"bg-emerald-50 text-indigo-600"}`,children:a?e.jsx(ie,{size:24}):e.jsx(_,{size:24})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsxs("button",{onClick:()=>me(s.refNo||s.id,s.id),className:`flex items-center gap-2 px-3 py-1 rounded-full font-bold uppercase tracking-widest transition-all duration-300 ${U===s.id?"bg-indigo-600 text-white shadow-lg shadow-indigo-200":"bg-indigo-50 text-indigo-600 hover:bg-indigo-600 hover:text-white hover:shadow-md"}`,children:[U===s.id?e.jsx(Se,{size:10}):e.jsx(Ie,{size:10}),e.jsx("span",{className:"text-[10px]",children:U===s.id?"تم النسخ":`REF: ${s.refNo||s.id}`})]}),a&&e.jsx("span",{className:"flex items-center gap-2 text-[9px] bg-slate-900 text-indigo-400 px-3 py-1 rounded-full font-bold uppercase tracking-widest border border-slate-800",children:"نظام آلي"}),!a&&e.jsx("span",{className:"flex items-center gap-2 text-[9px] bg-indigo-700 text-white px-3 py-1 rounded-full font-bold uppercase tracking-widest shadow-sm",children:"قيد يدوي"})]}),e.jsx("h5",{className:"text-2xl font-bold text-slate-900 tracking-tight group-hover:text-indigo-600 transition-colors",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(le,{size:12}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:new Date(s.date).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"})})]}),!a&&e.jsxs("div",{className:"flex gap-2 no-print opacity-0 group-hover:opacity-100 transition-all duration-500 transform translate-x-4 group-hover:translate-x-0",children:[e.jsx("button",{onClick:()=>te(s),className:"w-9 h-9 flex items-center justify-center bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-900 hover:text-white transition-all",children:e.jsx(_,{size:14})}),e.jsx("button",{onClick:()=>J(s.id),className:"w-9 h-9 flex items-center justify-center bg-rose-50 text-rose-600 rounded-lg hover:bg-rose-600 hover:text-white transition-all",children:e.jsx(B,{size:14})})]})]})]})]}),e.jsxs("div",{className:"text-right bg-white p-6 rounded-2xl border border-slate-100 shadow-sm min-w-[200px] group-hover:shadow-md transition-all duration-500",children:[e.jsx("p",{className:"text-3xl font-bold text-slate-900 tracking-tight tabular-nums",children:d?"****":(s.totalAmount||0).toLocaleString()}),e.jsx("span",{className:"text-[10px] text-slate-400 block font-bold uppercase tracking-widest mt-1",children:"إجمالي قيمة القيد"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:(s.lines||[]).map((t,n)=>e.jsxs("div",{className:`p-6 rounded-2xl flex justify-between items-center transition-all duration-500 border ${t.debit>0?"bg-emerald-50 bg-opacity-10 border-emerald-100 border-opacity-50 hover:border-indigo-600 border-opacity-30":"bg-rose-50 bg-opacity-10 border-rose-100 border-opacity-50 hover:border-rose-500 border-opacity-30"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-1.5 h-10 rounded-full ${t.debit>0?"bg-indigo-600":"bg-rose-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900 text-base leading-tight",children:t.accountName}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-[9px] text-slate-400 font-bold uppercase tracking-widest",children:t.accountType}),t.costCenterId&&e.jsx("span",{className:"text-[9px] bg-slate-100 text-slate-600 px-2 py-0.5 rounded-full font-bold",children:R.find(i=>i.id===t.costCenterId)?.name||T.find(i=>i.id===t.costCenterId)?.name||"مركز غير معروف"}),t.programId&&e.jsx("span",{className:"text-[9px] bg-indigo-50 text-indigo-600 px-2 py-0.5 rounded-full font-bold",children:E.find(i=>i.id===t.programId)?.name||"برنامج غير معروف"}),t.componentId&&e.jsx("span",{className:"text-[9px] bg-emerald-50 text-emerald-600 px-2 py-0.5 rounded-full font-bold",children:E.flatMap(i=>i.components||[]).find(i=>i.id===t.componentId)?.name||"مكون غير معروف"})]})]})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:`text-xl font-bold tabular-nums tracking-tight ${t.debit>0?"text-indigo-600":"text-rose-600"}`,children:d?"****":t.debit>0?`+${(t.debit||0).toLocaleString()}`:`-${(t.credit||0).toLocaleString()}`}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mt-0.5",children:t.debit>0?"طرف مدين":"طرف دائن"})]})]},n))})]},s.id)}),u.length===0&&e.jsxs("div",{className:"py-32 text-center flex flex-col items-center",children:[e.jsx("div",{className:"w-24 h-24 bg-slate-50 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(V,{size:48,className:"text-slate-200"})}),e.jsx("p",{className:"font-bold text-slate-300 uppercase tracking-widest text-xs",children:"دفتر قيود اليومية لا يحتوي على سجلات حالياً"})]})]})]})]})};export{Fe as default};
