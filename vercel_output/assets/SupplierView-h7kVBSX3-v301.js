import{c as pe,r as c,d as be,j as e,T as ue,b as fe,e as je,X as q,F as J,f as Ne}from"./index-DYzCRgaJ-v301.js";import{P as K}from"./package-ctwu1KXZ-v301.js";import{A as X}from"./activity-BjoEwgBs-v301.js";import{T as Y}from"./trash-2-DKdWUOi8-v301.js";import{P as Z}from"./plus-DPNLsHZB-v301.js";import{S as ve}from"./save-DyoiDrR2-v301.js";import{P as ye}from"./phone-80V2jr5X-v301.js";import{P as we}from"./pen-C9nJN1Z0-v301.js";const ke=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],Se=pe("building",ke),Ae=({suppliers:r,setSuppliers:A,deleteSupplier:D,customers:W,currentUser:g,transactions:I,journalEntries:N,recordJournalEntry:ee,currencies:u,searchTerm:te="",formatCurrency:v,addAuditLog:$,initialEditingId:T,onClearInitialEdit:L,settings:y,programs:ae})=>{const f=g?.permissions?.includes("HIDE_FINANCIAL_AMOUNTS"),se=g?.role==="BOOKING_EMPLOYEE",Q=f||se,[R,w]=c.useState(!1),[k,M]=c.useState(!1),[p,E]=c.useState(null),[n,x]=c.useState({name:"",phone:"",company:"",openingBalance:"0",openingBalanceCurrency:"EGP",isSaudiWallet:!1,visaQuota:"0"}),[m,S]=c.useState([]),[F,ne]=c.useState(""),[le,G]=c.useState(null),oe=()=>{m.length===b.length?S([]):S(b.map(t=>t.id))},ie=t=>{S(a=>a.includes(t)?a.filter(s=>s!==t):[...a,t])},re=()=>{confirm(`هل أنت متأكد من حذف ${m.length} من الموردين المحددين؟`)&&(m.forEach(t=>D(t)),S([]))},[z,O]=c.useState(!1),de=te||F,[ce,H]=c.useState(!1),[j,xe]=c.useState(null);be.useEffect(()=>{if(T){const t=r.find(a=>a.id===T);t&&(G(t.id),setTimeout(()=>{const a=document.getElementById(`supplier-${t.id}`);a&&(a.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>G(null),3e3))},500)),L?.()}},[T,r,L]);const C=c.useMemo(()=>{const t={};return(r||[]).forEach(a=>{a?.id&&(t[a.id]={base:a.openingBalanceInBase||0,original:a.openingBalance||0})}),(N||[]).forEach(a=>{a?.lines&&(a.lines||[]).forEach(s=>{if(s?.accountId&&s.accountType==="SUPPLIER"&&t[s.accountId]!==void 0){t[s.accountId].base+=(s.credit||0)-(s.debit||0);const i=(r||[]).find(l=>l&&l.id===s.accountId);if(i&&s.currencyCode===i.openingBalanceCurrency){const l=(s.credit||0)>0?1:-1;t[s.accountId].original+=(s.originalAmount||0)*l}}})}),(r||[]).forEach(a=>{a?.id&&a.openingBalanceCurrency!==(y?.baseCurrency||"EGP")&&Math.abs(t[a.id]?.original||0)<.01&&t[a.id]&&(t[a.id].base=0)}),t},[r,N,y?.baseCurrency]),B=c.useMemo(()=>{const t=(r||[]).length,a=(r||[]).reduce((l,o)=>{const d=(C[o?.id||""]||{}).base||0;return l+(d>0?d:0)},0),s=(r||[]).reduce((l,o)=>{const d=(C[o?.id||""]||{}).base||0;return l+(d<0?Math.abs(d):0)},0),i=(r||[]).filter(l=>{if(!l?.id)return!1;const o=Date.now()-720*60*60*1e3;return(I||[]).some(d=>{if(!d?.date)return!1;const h=new Date(d.date).getTime();return(d.supplierId===l.id||d.relatedEntityId===l.id)&&h>o})}).length;return{total:t,payables:a,receivables:s,activeLastMonth:i}},[r,I,C]),he=t=>{t.preventDefault();const a=parseFloat(n.openingBalance)||0,s=(u||[]).find(l=>l?.code===n.openingBalanceCurrency)||u&&u[0]||{rateToMain:1},i=a*(s.rateToMain||1);if(k&&p){if((r||[]).some(h=>h?.id!==p&&h?.company===n.company)){alert("اسم الشركة موجود مسبقاً، يرجى اختيار اسم مختلف");return}if((W||[]).some(h=>h?.name===n.company)){alert("هذا الاسم موجود كعميل، يرجى اختيار اسم مختلف أو عمل مقاصة إذا لزم الأمر");return}const l=(r||[]).find(h=>h?.id===p);if(!l)return;A(h=>(h||[]).map(P=>{if(P?.id===p){const V={...P,name:n.name,phone:n.phone,company:n.company,openingBalance:a,openingBalanceCurrency:n.openingBalanceCurrency,openingBalanceInBase:i,isSaudiWallet:n.isSaudiWallet,visaQuota:n.isSaudiWallet?parseInt(n.visaQuota)||0:void 0};return $("UPDATE","SUPPLIER",p,`تعديل بيانات المورد: ${n.company}`,l,V),V}return P}));const o=i-(l.openingBalanceInBase||0),d=a-(l.openingBalance||0);(o!==0||d!==0)&&ee(`تعديل رصيد أول المدة للمورد ${n.company}`,new Date().toISOString().split("T")[0],[{accountId:p,accountType:"SUPPLIER",accountName:n.company,debit:o>0?o:0,credit:o<0?-o:0,originalAmount:Math.abs(d),currencyCode:n.openingBalanceCurrency}]),M(!1),E(null)}else{if((r||[]).some(o=>o.company===n.company)){alert("اسم الشركة موجود مسبقاً، يرجى اختيار اسم مختلف");return}if((W||[]).some(o=>o.name===n.company)){alert("هذا الاسم موجود كعميل، يرجى اختيار اسم مختلف أو عمل مقاصة إذا لزم الأمر");return}const l={id:Date.now().toString(),name:n.name,phone:n.phone,company:n.company,openingBalance:a,openingBalanceCurrency:n.openingBalanceCurrency,openingBalanceInBase:i,isSaudiWallet:n.isSaudiWallet,visaQuota:n.isSaudiWallet?parseInt(n.visaQuota):void 0,balance:i,currencyBalance:a};A(o=>[...o,l]),$("CREATE","SUPPLIER",l.id,`إضافة مورد جديد: ${l.company}`,void 0,l)}x({name:"",phone:"",company:"",openingBalance:"0",openingBalanceCurrency:"EGP",isSaudiWallet:!1,visaQuota:"0"}),w(!1)},me=t=>{x({name:t.name,phone:t.phone,company:t.company,openingBalance:t.openingBalance.toString(),openingBalanceCurrency:t.openingBalanceCurrency||"EGP",isSaudiWallet:!!t.isSaudiWallet,visaQuota:(t.visaQuota||0).toString()}),E(t.id),M(!0),w(!0),window.scrollTo({top:0,behavior:"smooth"})},_=()=>{w(!1),M(!1),E(null),x({name:"",phone:"",company:"",openingBalance:"0",openingBalanceCurrency:"EGP",isSaudiWallet:!1,visaQuota:"0"})},b=(r||[]).filter(t=>{if(!t)return!1;const a=(de||"").toLowerCase(),s=(t.name||"").toLowerCase().includes(a)||(t.company||"").toLowerCase().includes(a)||(t.phone||"").toLowerCase().includes(a),i=z?t.isSaudiWallet:!0;return s&&i}),ge=t=>{xe(t),H(!0)},U=c.useMemo(()=>{if(!j)return[];const t=[];return(N||[]).forEach(a=>{a&&a.lines&&(a.lines||[]).forEach(s=>{s&&s.accountId===j&&s.accountType==="SUPPLIER"&&t.push({id:`${a.id}-${s.id}`,date:a.date,description:a.description,refNo:a.refNo,debit:s.debit,credit:s.credit,amount:s.originalAmount||s.debit||s.credit,currencyCode:s.currencyCode||y?.baseCurrency,programId:s.programId,componentId:s.componentId})})}),t.sort((a,s)=>{const i=new Date(a.date).getTime(),l=new Date(s.date).getTime();return isNaN(i)||isNaN(l)?0:l-i})},[j,N,y?.baseCurrency]);return e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-2 duration-500",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm flex items-center gap-5 hover:shadow-md transition-all",children:[e.jsx("div",{className:"w-14 h-14 bg-slate-900 text-indigo-400 rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(K,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"إجمالي الموردين"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:B.total})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm flex items-center gap-5 hover:shadow-md transition-all",children:[e.jsx("div",{className:"w-14 h-14 bg-rose-50 text-rose-600 rounded-2xl flex items-center justify-center",children:e.jsx(ue,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"مستحقات (دائن)"}),e.jsx("p",{className:"text-2xl font-bold text-rose-600 tracking-tight",children:Q?"****":v(B.payables||0)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm flex items-center gap-5 hover:shadow-md transition-all",children:[e.jsx("div",{className:"w-14 h-14 bg-emerald-50 text-emerald-600 rounded-2xl flex items-center justify-center",children:e.jsx(fe,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"دفعات مقدمة (مدين)"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-600 tracking-tight",children:Q?"****":v(B.receivables||0)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm flex items-center gap-5 hover:shadow-md transition-all",children:[e.jsx("div",{className:"w-14 h-14 bg-slate-100 text-slate-600 rounded-2xl flex items-center justify-center",children:e.jsx(X,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"نشط مؤخراً"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:B.activeLastMonth})]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{className:"relative flex-1 max-w-2xl group",children:[e.jsx(je,{className:"absolute right-6 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-indigo-500 transition-colors",size:20}),e.jsx("input",{type:"text",placeholder:"بحث في الموردين...",className:"w-full pr-14 pl-10 py-4 bg-white border border-slate-200 rounded-2xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500 ring-opacity-5 outline-none font-bold text-sm shadow-sm transition-all placeholder:text-slate-400",value:F,onChange:t=>ne(t.target.value)})]}),e.jsxs("div",{className:"flex bg-slate-100 p-1.5 rounded-2xl border border-slate-200 shadow-inner",children:[e.jsx("button",{onClick:()=>O(!1),className:`px-8 py-2.5 rounded-xl font-bold text-xs transition-all ${z?"text-slate-500 hover:text-slate-900":"bg-white text-slate-900 shadow-sm"}`,children:"الكل"}),e.jsx("button",{onClick:()=>O(!0),className:`px-8 py-2.5 rounded-xl font-bold text-xs transition-all ${z?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-indigo-600"}`,children:"المحافظ السعودية"})]}),!R&&e.jsxs("div",{className:"flex items-center gap-3",children:[m.length>0&&g.role==="ADMIN"&&e.jsxs("button",{onClick:re,className:"bg-rose-50 text-rose-600 px-6 py-4 rounded-2xl font-bold text-sm flex items-center gap-3 hover:bg-rose-100 transition-all shadow-sm active:scale-95",children:[e.jsx(Y,{size:18}),"حذف المحدد (",m.length,")"]}),e.jsxs("button",{onClick:()=>w(!0),className:"bg-slate-900 text-indigo-400 px-8 py-4 rounded-2xl font-bold text-sm flex items-center gap-3 hover:bg-slate-800 transition-all shadow-xl shadow-slate-900/10 active:scale-95",children:[e.jsx(Z,{size:18}),"إضافة مورد جديد"]})]})]}),R&&e.jsxs("div",{className:"bg-white p-8 rounded-3xl border border-slate-200 shadow-2xl animate-in zoom-in-95 duration-200 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500 bg-opacity-5 rounded-full -mr-16 -mt-16 blur-2xl"}),e.jsxs("div",{className:"flex justify-between items-center mb-8 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1.5 h-8 bg-indigo-500 rounded-full"}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 tracking-tight",children:k?"تعديل بيانات المورد":"تسجيل مورد جديد"})]}),e.jsx("button",{onClick:_,className:"text-slate-400 hover:text-rose-500 transition-all bg-slate-50 hover:bg-rose-50 p-2.5 rounded-xl",children:e.jsx(q,{size:20})})]}),e.jsxs("form",{onSubmit:he,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 relative z-10",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 ml-1",children:"اسم الشركة"}),e.jsx("input",{type:"text",placeholder:"الاسم التجاري",required:!0,className:"p-3.5 bg-slate-50 border border-slate-200 rounded-xl focus:border-indigo-500 focus:bg-white outline-none font-bold text-sm text-slate-900 transition-all",value:n.company,onChange:t=>x({...n,company:t.target.value})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 ml-1",children:"جهة الاتصال"}),e.jsx("input",{type:"text",placeholder:"اسم المسؤول",className:"p-3.5 bg-slate-50 border border-slate-200 rounded-xl focus:border-indigo-500 focus:bg-white outline-none font-bold text-sm text-slate-900 transition-all",value:n.name,onChange:t=>x({...n,name:t.target.value})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 ml-1",children:"رقم الهاتف"}),e.jsx("input",{type:"text",placeholder:"أرقام التواصل",className:"p-3.5 bg-slate-50 border border-slate-200 rounded-xl focus:border-indigo-500 focus:bg-white outline-none font-bold text-sm text-slate-900 transition-all",value:n.phone,onChange:t=>x({...n,phone:t.target.value})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 ml-1",children:"رصيد أول المدة"}),e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"number",placeholder:"0",className:"w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl focus:border-indigo-500 focus:bg-white outline-none font-bold text-sm text-center text-slate-900 transition-all",value:n.openingBalance,onChange:t=>x({...n,openingBalance:t.target.value})}),e.jsx("div",{className:"absolute left-2 top-1/2 -translate-y-1/2",children:e.jsx("select",{className:"bg-white border border-slate-200 rounded-lg px-2 py-1 font-bold text-[10px] outline-none focus:border-indigo-500 transition-all shadow-sm cursor-pointer",value:n.openingBalanceCurrency,onChange:t=>x({...n,openingBalanceCurrency:t.target.value}),children:(u||[]).map(t=>e.jsx("option",{value:t.code,children:t.code},t.code))})})]})]}),e.jsx("div",{className:"flex items-end pb-0.5",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group bg-slate-50 p-3 rounded-xl border border-slate-200 w-full hover:border-indigo-500 transition-all",children:[e.jsx("input",{type:"checkbox",className:"w-5 h-5 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer",checked:n.isSaudiWallet,onChange:t=>x({...n,isSaudiWallet:t.target.checked})}),e.jsx("span",{className:"text-xs font-bold text-slate-600 group-hover:text-indigo-600 transition-colors",children:"محفظة سعودية"})]})}),n.isSaudiWallet&&e.jsxs("div",{className:"lg:col-span-5 flex flex-col gap-2 animate-in slide-in-from-left-2 duration-300",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 ml-1 uppercase tracking-widest",children:"كوتة التأشيرات"}),e.jsx("input",{type:"number",placeholder:"0",className:"p-3.5 bg-slate-50 border border-slate-200 rounded-xl focus:border-indigo-500 outline-none font-bold text-sm text-slate-900 transition-all focus:bg-white w-48",value:n.visaQuota,onChange:t=>x({...n,visaQuota:t.target.value})})]}),e.jsxs("div",{className:"lg:col-span-5 flex justify-end gap-4 mt-6 pt-6 border-t border-slate-100",children:[e.jsx("button",{type:"button",onClick:_,className:"px-8 py-2.5 text-slate-400 font-bold text-sm hover:text-rose-600 transition-colors",children:"إلغاء"}),e.jsxs("button",{type:"submit",className:"bg-slate-900 text-indigo-400 px-10 py-3 rounded-xl font-bold text-sm shadow-xl hover:bg-slate-800 transition-all flex items-center gap-2 active:scale-95",children:[k?e.jsx(ve,{size:18}):e.jsx(Z,{size:18}),k?"تحديث البيانات":"حفظ البيانات"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[g?.role==="ADMIN"&&e.jsx("th",{className:"px-6 py-5 text-center w-10",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer",checked:(b||[]).length>0&&m.length===(b||[]).length,onChange:oe})}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"المورد / الشركة"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold text-slate-400 uppercase tracking-widest text-center",children:"الرصيد الافتتاحي"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold text-slate-400 uppercase tracking-widest text-center",children:"كوتا التأشيرات"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"الوضعية المالية"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-bold text-slate-400 uppercase tracking-widest text-center",children:"التحكم"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:(b||[]).map(t=>e.jsxs("tr",{id:`supplier-${t.id}`,className:`hover:bg-slate-50 bg-opacity-50 transition-all group ${le===t.id?"ring-4 ring-indigo-500 border-indigo-500 bg-indigo-50/30 scale-[1.002] z-10 shadow-2xl":m.includes(t.id)?"bg-indigo-50 bg-opacity-30":""}`,children:[g?.role==="ADMIN"&&e.jsx("td",{className:"px-6 py-5 text-center",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer",checked:m.includes(t.id),onChange:()=>ie(t.id)})}),e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-11 h-11 bg-slate-100 text-slate-500 rounded-xl flex items-center justify-center font-bold text-lg group-hover:bg-slate-900 group-hover:text-indigo-400 transition-all duration-300",children:(t.company||"").charAt(0)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-bold text-slate-900 group-hover:text-indigo-600 transition-colors tracking-tight",children:t.company}),t.isSaudiWallet&&e.jsx("span",{className:"bg-indigo-100 text-indigo-700 text-[9px] font-bold px-2 py-0.5 rounded-md uppercase",children:"محفظة"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] text-slate-400 font-bold mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(Se,{size:12,className:"text-slate-300"})," ",t.name]}),t.phone&&e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(ye,{size:12,className:"text-slate-300"})," ",t.phone]})]})]})]})}),e.jsx("td",{className:"px-6 py-5 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-sm font-bold text-slate-700",children:f?"****":(t.openingBalance||0).toLocaleString()}),e.jsx("span",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-tight mt-0.5",children:(u||[]).find(a=>a.code===t.openingBalanceCurrency)?.code||"EGP"})]})}),e.jsx("td",{className:"px-6 py-5 text-center",children:t.isSaudiWallet?e.jsx("div",{className:"flex flex-col items-center gap-2",children:(()=>{const a=(I||[]).filter(o=>!o.isVoided&&(o.supplierId===t.id||o.relatedEntityId===t.id)&&(o.category==="HAJJ"||o.category==="UMRAH")).reduce((o,d)=>o+(d.adultCount||0)+(d.childCount||0),0),s=t.visaQuota||0,i=s-a,l=s>0?a*(1/s)*100:0;return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:`text-[10px] font-bold px-3 py-1 rounded-lg ${i<=0?"bg-rose-50 text-rose-600":"bg-indigo-50 text-indigo-600"}`,children:[a," / ",s]}),e.jsx("div",{className:"w-24 h-1.5 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-1000 ${l>90?"bg-rose-500":l>70?"bg-amber-500":"bg-indigo-600"}`,style:{width:`${Math.min(100,l)}%`}})})]})})()}):e.jsx("span",{className:"text-slate-200 text-xs font-bold italic",children:"---"})}),e.jsx("td",{className:"px-6 py-5",children:(()=>{const a=C[t.id]||{base:0,original:0},s=a.base>0,i=a.base<0;return e.jsxs("div",{className:`inline-flex flex-col items-end px-5 py-2.5 rounded-2xl border ${s?"bg-rose-50 bg-opacity-50 border-rose-100 text-rose-700":i?"bg-emerald-50 bg-opacity-50 border-emerald-100 text-emerald-700":"bg-slate-50 bg-opacity-50 border-slate-100 text-slate-400"}`,children:[e.jsx("span",{className:"text-base font-bold tracking-tight",children:f?"****":v(Math.abs(a.base))}),t.openingBalanceCurrency!=="EGP"&&Math.abs(a.original)>.01&&e.jsxs("span",{className:"text-[10px] font-bold opacity-80 border-t border-current mt-1 pt-0.5",children:[f?"****":Math.abs(a.original).toLocaleString()," ",t.openingBalanceCurrency]}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-1.5",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${s?"bg-rose-500":i?"bg-emerald-500":"bg-slate-300"}`}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-tight opacity-70",children:s?"مستحق له":i?"دفعات مقدمة":"خالص الرصيد"})]})]})})()}),e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>ge(t.id),className:"p-2.5 text-slate-400 hover:text-slate-900 hover:bg-slate-100 rounded-xl transition-all",title:"كشف حساب",children:e.jsx(J,{size:18})}),g?.role==="ADMIN"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>me(t),className:"p-2.5 text-slate-400 hover:text-slate-900 hover:bg-slate-100 rounded-xl transition-all",title:"تعديل",children:e.jsx(we,{size:18})}),e.jsx("button",{onClick:()=>D(t.id),className:"p-2.5 text-slate-400 hover:text-rose-600 hover:bg-rose-50 rounded-xl transition-all",title:"حذف",children:e.jsx(Y,{size:18})})]})]})})]},t.id))})]})}),b.length===0&&e.jsxs("div",{className:"p-20 text-center flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 bg-slate-50 rounded-3xl flex items-center justify-center mb-6 border border-dashed border-slate-200",children:e.jsx(Ne,{size:40,className:"text-slate-200"})}),e.jsx("h4",{className:"text-lg font-bold text-slate-400 mb-1",children:"لا توجد سجلات مطابقة"}),e.jsx("p",{className:"text-slate-300 font-bold text-sm",children:"جرّب استخدام كلمات بحث مختلفة"})]})]}),ce&&j&&e.jsx("div",{className:"fixed inset-0 bg-slate-900 bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden border border-slate-200 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"p-8 border-b border-slate-100 flex justify-between items-center bg-slate-50 bg-opacity-50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-900 text-indigo-400 rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(J,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"كشف حساب المورد"}),e.jsx("p",{className:"text-slate-500 font-medium text-sm",children:(r||[]).find(t=>t.id===j)?.company})]})]}),e.jsx("button",{onClick:()=>H(!1),className:"text-slate-400 hover:text-rose-500 hover:bg-rose-50 p-2.5 rounded-2xl transition-all",children:e.jsx(q,{size:24})})]}),e.jsx("div",{className:"p-8 overflow-y-auto max-h-[70vh]",children:(U||[]).length===0?e.jsxs("div",{className:"py-20 text-center flex flex-col items-center",children:[e.jsx(X,{size:48,className:"text-slate-200 mb-4"}),e.jsx("p",{className:"text-slate-400 font-bold",children:"لا توجد عمليات لهذا المورد حتى الآن"})]}):e.jsx("div",{className:"overflow-hidden rounded-2xl border border-slate-100",children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-100",children:[e.jsx("th",{className:"p-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest w-24",children:"التاريخ"}),e.jsx("th",{className:"p-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest w-28",children:"المرجع"}),e.jsx("th",{className:"p-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"البيان"}),e.jsx("th",{className:"p-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"المبلغ"}),e.jsx("th",{className:"p-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest text-center",children:"النوع"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:(U||[]).slice(0,50).map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 bg-opacity-50 transition-all group",children:[e.jsx("td",{className:"p-4 text-xs font-bold text-slate-400",children:t.date}),e.jsx("td",{className:"p-4",children:t.refNo&&e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(t.refNo);const a=document.getElementById(`ref-sup-${t.id}`);if(a){const s=a.innerText;a.innerText="تم النسخ",setTimeout(()=>{a.innerText=s},1e3)}},id:`ref-sup-${t.id}`,className:"px-2 py-1 bg-indigo-50 text-indigo-700 rounded text-[10px] font-black border border-indigo-100 hover:bg-indigo-100 transition-all",title:"اضغط للنسخ والبحث",children:t.refNo})}),e.jsxs("td",{className:"p-4 text-sm font-bold text-slate-700",children:[e.jsx("div",{children:t.description}),t.componentId&&e.jsxs("div",{className:"text-[10px] text-indigo-500 mt-1 flex items-center gap-1",children:[e.jsx(K,{size:10}),(ae||[]).find(i=>i.id===t.programId)?.components?.find(i=>i.id===t.componentId)?.name||"مكون غير معروف"]})]}),e.jsxs("td",{className:"p-4 font-bold text-slate-900",children:[e.jsx("span",{className:t.credit>0?"text-rose-600":"text-emerald-600",children:f?"****":v(t.amount)}),e.jsx("span",{className:"text-[10px] text-slate-400 mr-1",children:t.currencyCode})]}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:`px-3 py-1 rounded-lg text-[10px] font-bold ${t.credit>0?"bg-rose-50 text-rose-600":"bg-emerald-50 text-emerald-600"}`,children:t.credit>0?"دائن":"مدين"})})]},t.id))})]})})})]})})]})};export{Ae as default};
