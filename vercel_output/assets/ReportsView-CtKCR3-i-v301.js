import{c as xt,j as e,b as ie,a as T,y as ne,U as Z,R as A,r as S,h as de,T as rt,e as se,M as at,W as Ce,w as mt,o as pt,z as lt,A as nt,I as bt,H as Me,X as xe,x as ht,d as dt,k as ut,G as jt,i as Se,J as ft}from"./index-CnE16RuQ-v301.js";import{A as Nt}from"./activity-uFnnTRgz-v301.js";import{C as gt,T as ke,u as vt,a as wt,b as yt,c as Et,d as St,e as Lt,f as Rt,g as Ct,h as kt}from"./useReportData-D8h6fuuf-v301.js";import{L as re}from"./landmark-D1jWtIVj-v301.js";import{C as me,a as te,A as le}from"./circle-arrow-up-DCmAoNxK-v301.js";import{P as Te}from"./phone-CsGZ6JDg-v301.js";import{L as Ne}from"./layers-C9odC2LH-v301.js";import{P as Re}from"./package-BCljNeLc-v301.js";import{C as Tt}from"./clock-DIy8dwqr-v301.js";import{T as It}from"./triangle-alert-DXJiqlm4-v301.js";import{C as it}from"./calculator-nlz8n_tK-v301.js";import{C as ge}from"./calendar-MgrGiAEH-v301.js";import{S as Ye}from"./save-D9SZdYmd-v301.js";import{C as zt}from"./check-Dyv9p-Gq-v301.js";import{P as Ge}from"./pen-DFeg_vJr-v301.js";import{P as At}from"./printer-NI-2ePcL-v301.js";import{M as _t}from"./mail-DTBYkCu8-v301.js";import{F as Pt}from"./facebook-BDWLwsR3-v301.js";const Ot=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Fe=xt("arrow-right",Ot),Ve=({stats:c,costCenterName:n,fromDate:m,toDate:a,shouldMaskAggregate:d,isPrint:u=!1})=>c?u?e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 print:animate-none print:opacity-100 print:transform-none",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"border border-slate-900 p-4 text-center",children:[e.jsx("p",{className:"text-[8px] font-bold uppercase mb-1",children:"إجمالي الإيرادات"}),e.jsx("p",{className:"text-xl font-bold",children:d?"****":Number(c?.revenue||0).toLocaleString()})]}),e.jsxs("div",{className:"border border-slate-900 p-4 text-center",children:[e.jsx("p",{className:"text-[8px] font-bold uppercase mb-1",children:"إجمالي التكاليف"}),e.jsx("p",{className:"text-xl font-bold",children:d?"****":Number(c?.cost||0).toLocaleString()})]}),e.jsxs("div",{className:"border border-slate-900 p-4 text-center",children:[e.jsx("p",{className:"text-[8px] font-bold uppercase mb-1",children:"Pax / مشرفين"}),e.jsxs("p",{className:"text-xl font-bold",children:[Number(c?.bookings||0)," / ",Number(c?.supervisors||0)]})]}),e.jsxs("div",{className:"border border-slate-900 p-4 text-center bg-slate-900 text-white",children:[e.jsx("p",{className:"text-[8px] font-bold uppercase mb-1",children:"صافي الربح"}),e.jsx("p",{className:"text-xl font-bold text-emerald-400",children:d?"****":Number(c?.profit||0).toLocaleString()})]})]}),e.jsx("div",{className:"overflow-hidden rounded-xl border-2 border-slate-900 shadow-sm",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white text-[11px] font-bold uppercase tracking-wider",children:[e.jsx("th",{className:"p-4 text-right border-b border-slate-700",children:"البرنامج / العملية"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"Pax"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"Sup"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"الإيرادات"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"التكاليف"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700 bg-slate-800",children:"الربح"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"الهامش"})]})}),e.jsx("tbody",{className:"text-[10px] font-bold divide-y divide-slate-200",children:(c?.programs||[]).map((o,t)=>{const r=Number(o?.revenue||0)-Number(o?.cost||0),l=Number(o?.revenue||0)>0?r/Number(o.revenue)*100:0;return e.jsxs("tr",{className:t%2===0?"bg-white":"bg-slate-50/50",children:[e.jsx("td",{className:"p-3 border-x border-slate-200 text-slate-900 font-bold",children:o?.name}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center",children:Number(o?.bookings||0)}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center",children:Number(o?.supervisors||0)}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center text-emerald-700",children:d?"****":Number(o?.revenue||0).toLocaleString()}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center text-rose-700",children:d?"****":Number(o?.cost||0).toLocaleString()}),e.jsx("td",{className:`p-3 border-x border-slate-200 text-center font-bold ${r>=0?"bg-emerald-50 text-emerald-800":"bg-rose-50 text-rose-800"}`,children:d?"****":Number(r||0).toLocaleString()}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center font-bold",children:d?"****%":`${Number(l).toFixed(1)}%`})]},t)})})]})})]}):e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white p-6 rounded-3xl shadow-sm border border-white relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 top-0 w-64 h-64 bg-emerald-50 rounded-full blur-[100px] -mr-32 -mt-32 opacity-60"}),e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-600 text-white rounded-2xl flex items-center justify-center shadow-lg shadow-emerald-200 transform group-hover:scale-110 transition-transform duration-500",children:e.jsx(ie,{size:28})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight mb-1",children:["تحليل أرباح: ",n]}),e.jsxs("p",{className:"text-emerald-600 font-bold uppercase tracking-[0.2em] text-[9px] opacity-70 flex items-center gap-2",children:[e.jsx(T,{size:12})," ",n," Performance Analysis"]})]})]}),e.jsx("div",{className:"flex gap-4 relative z-10",children:e.jsxs("div",{className:"bg-slate-900 px-6 py-4 rounded-2xl text-white shadow-lg",children:[e.jsx("p",{className:"text-[9px] font-bold uppercase tracking-[0.2em] mb-1 opacity-60",children:"صافي ربح المركز"}),e.jsxs("p",{className:"text-2xl font-bold tabular-nums tracking-tight text-emerald-400",children:[d?"****":Number(c?.profit||0).toLocaleString()," ",e.jsx("span",{className:"text-xs font-bold opacity-40 text-white",children:"ج.م"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-100 flex flex-col gap-3 group hover:-translate-y-1 transition-all",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-50 text-emerald-600 rounded-xl flex items-center justify-center group-hover:bg-emerald-600 group-hover:text-white transition-all duration-500",children:e.jsx(gt,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"إجمالي الإيرادات"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:d?"****":Number(c?.revenue||0).toLocaleString()})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-100 flex flex-col gap-3 group hover:-translate-y-1 transition-all",children:[e.jsx("div",{className:"w-10 h-10 bg-rose-50 text-rose-600 rounded-xl flex items-center justify-center group-hover:bg-rose-600 group-hover:text-white transition-all duration-500",children:e.jsx(ne,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"إجمالي التكاليف"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:d?"****":Number(c?.cost||0).toLocaleString()})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-100 flex flex-col gap-3 group hover:-translate-y-1 transition-all",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-50 text-slate-600 rounded-xl flex items-center justify-center group-hover:bg-slate-900 group-hover:text-white transition-all duration-500",children:e.jsx(Z,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"عدد الأفراد (Pax)"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:Number(c?.bookings||0)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-100 flex flex-col gap-3 group hover:-translate-y-1 transition-all",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-50 text-amber-600 rounded-xl flex items-center justify-center group-hover:bg-amber-600 group-hover:text-white transition-all duration-500",children:e.jsx(ke,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"عدد المشرفين"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:Number(c?.supervisors||0)})]})]})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl border border-slate-100 bg-white shadow-sm",children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white",children:[e.jsx("th",{className:"p-4 font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"اسم البرنامج / العملية"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"Pax"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"مشرفين"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"الإيرادات"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"التكاليف"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800 bg-slate-800",children:"صافي الربح"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"الهامش"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 font-medium text-xs",children:(c?.programs||[]).map((o,t)=>{const r=Number(o?.revenue||0)-Number(o?.cost||0),l=Number(o?.revenue||0)>0?r/Number(o.revenue)*100:0;return e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-all group",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("p",{className:"text-slate-900 font-bold text-sm group-hover:text-emerald-600 transition-colors",children:o?.name}),e.jsxs("p",{className:"text-[9px] text-slate-400 font-bold uppercase mt-0.5 tracking-widest opacity-60",children:["Operations ID: ",(o?.id||"").slice(-6).toUpperCase()]})]}),e.jsx("td",{className:"p-4 text-center text-slate-600 tabular-nums",children:Number(o?.bookings||0)}),e.jsx("td",{className:"p-4 text-center text-slate-400 tabular-nums",children:Number(o?.supervisors||0)}),e.jsx("td",{className:"p-4 text-center text-emerald-600 font-bold text-base tabular-nums",children:d?"****":Number(o?.revenue||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center text-rose-600 font-bold text-base tabular-nums",children:d?"****":Number(o?.cost||0).toLocaleString()}),e.jsx("td",{className:`p-4 text-center font-bold text-lg tabular-nums ${r>=0?"text-emerald-700 bg-emerald-50/30":"text-rose-700 bg-rose-50/30"}`,children:d?"****":Number(r||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-12 bg-slate-100 h-1.5 rounded-full overflow-hidden shadow-inner",children:e.jsx("div",{className:`h-full ${r>=0?"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.3)]":"bg-rose-500"}`,style:{width:`${Math.min(100,Math.max(0,l))}%`}})}),e.jsxs("span",{className:`text-[10px] font-bold tabular-nums ${r>=0?"text-emerald-600":"text-rose-600"}`,children:[Number(l).toFixed(1),"%"]})]})})]},t)})})]})})]}):u?null:e.jsxs("div",{className:"p-10 text-center text-slate-400 italic bg-slate-50/50 rounded-3xl border-2 border-dashed border-slate-200",children:[e.jsx(Nt,{size:32,className:"mx-auto mb-4 opacity-20"}),e.jsx("p",{className:"text-lg font-bold text-slate-900 mb-1",children:"لا توجد بيانات متاحة"}),e.jsx("p",{className:"text-xs",children:"برجاء اختيار مركز تكلفة من القائمة لعرض التحليل"})]}),Be=({stats:c,fromDate:n,toDate:m,shouldMaskAggregate:a,isPrint:d=!1})=>{const u=(c||[]).reduce((l,b)=>l+(Number(b?.revenue||0)-Number(b?.cost||0)),0),o=(c||[]).reduce((l,b)=>l+Number(b?.revenue||0),0),t=(c||[]).reduce((l,b)=>l+Number(b?.cost||0),0),r=(c||[]).reduce((l,b)=>l+Number(b?.bookings||0),0);return d?e.jsx("div",{className:"space-y-8 animate-in fade-in duration-500 print:animate-none print:opacity-100 print:transform-none",children:e.jsx("div",{className:"overflow-hidden rounded-2xl border-2 border-slate-900 shadow-sm",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white text-[11px] font-bold uppercase tracking-wider",children:[e.jsx("th",{className:"p-4 text-right border-b border-slate-700",children:"اسم البرنامج / الرحلة"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"النوع"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"الحجوزات"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"الإيرادات"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"التكاليف"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700 bg-slate-800",children:"صافي الربح"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"الهامش"})]})}),e.jsx("tbody",{className:"text-[10px] font-bold divide-y divide-slate-200",children:(c||[]).map((l,b)=>{const s=Number(l?.revenue||0)-Number(l?.cost||0),i=Number(l?.revenue||0)>0?s/Number(l.revenue)*100:0;return e.jsxs("tr",{className:b%2===0?"bg-white":"bg-slate-50/50",children:[e.jsx("td",{className:"p-3 border-x border-slate-200 text-slate-900 font-bold",children:l?.name}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center",children:l?.type}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center",children:Number(l?.bookings||0)}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center text-emerald-700",children:a?"****":Number(l?.revenue||0).toLocaleString()}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center text-rose-700",children:a?"****":Number(l?.cost||0).toLocaleString()}),e.jsx("td",{className:`p-3 border-x border-slate-200 text-center font-bold ${s>=0?"bg-emerald-50 text-emerald-800":"bg-rose-50 text-rose-800"}`,children:a?"****":Number(s||0).toLocaleString()}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center font-bold",children:a?"****%":`${Number(i).toFixed(1)}%`})]},b)})}),e.jsx("tfoot",{className:"bg-slate-900 text-white font-bold text-xs",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"p-4 text-right",children:"الإجمالي النهائي للبرامج"}),e.jsx("td",{className:"p-4 text-center",children:a?"****":(o||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center",children:a?"****":(t||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center bg-slate-800 text-emerald-400",children:a?"****":(u||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center",children:a?"****%":`${Number(u/(o||1)*100).toFixed(1)}%`})]})})]})})}):e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white p-6 rounded-3xl shadow-sm border border-white relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 top-0 w-64 h-64 bg-emerald-50 rounded-full blur-[100px] -mr-32 -mt-32 opacity-60"}),e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-600 text-white rounded-2xl flex items-center justify-center shadow-lg shadow-emerald-200 transform group-hover:scale-110 transition-transform duration-500",children:e.jsx(ie,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight mb-1",children:"أرباح برامج الحج والعمرة"}),e.jsxs("p",{className:"text-emerald-600 font-bold uppercase tracking-[0.2em] text-[9px] opacity-70 flex items-center gap-2",children:[e.jsx(T,{size:12})," Religious Tourism Program Profitability Analysis"]})]})]}),e.jsx("div",{className:"flex gap-4 relative z-10",children:e.jsxs("div",{className:"bg-slate-900 px-6 py-4 rounded-2xl text-white shadow-lg",children:[e.jsx("p",{className:"text-[9px] font-bold uppercase tracking-[0.2em] mb-1 opacity-60",children:"إجمالي صافي الربح"}),e.jsxs("p",{className:"text-2xl font-bold tabular-nums tracking-tight text-emerald-400",children:[a?"****":u.toLocaleString()," ",e.jsx("span",{className:"text-xs font-bold opacity-40 text-white",children:"ج.م"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-100 flex flex-col gap-3 group hover:-translate-y-1 transition-all",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-50 text-emerald-600 rounded-xl flex items-center justify-center group-hover:bg-emerald-600 group-hover:text-white transition-all duration-500",children:e.jsx(re,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"إجمالي الإيرادات"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:a?"****":o.toLocaleString()})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-100 flex flex-col gap-3 group hover:-translate-y-1 transition-all",children:[e.jsx("div",{className:"w-10 h-10 bg-rose-50 text-rose-600 rounded-xl flex items-center justify-center group-hover:bg-rose-600 group-hover:text-white transition-all duration-500",children:e.jsx(ne,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"إجمالي التكاليف"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:a?"****":t.toLocaleString()})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-100 flex flex-col gap-3 group hover:-translate-y-1 transition-all",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-50 text-slate-600 rounded-xl flex items-center justify-center group-hover:bg-slate-900 group-hover:text-white transition-all duration-500",children:e.jsx(Z,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"إجمالي الحجوزات"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:r})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-100 flex flex-col gap-3 group hover:-translate-y-1 transition-all",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-50 text-amber-600 rounded-xl flex items-center justify-center group-hover:bg-amber-600 group-hover:text-white transition-all duration-500",children:e.jsx(ke,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"هامش الربح العام"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:a?"****":`${Number(u/(o||1)*100).toFixed(1)}%`})]})]})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl border border-slate-100 bg-white shadow-sm",children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white",children:[e.jsx("th",{className:"p-4 font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"البرنامج / الرحلة"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"النوع"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"الحجوزات"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"الإيرادات"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"التكاليف"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800 bg-slate-800",children:"صافي الربح"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"الأداء"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 font-medium text-xs",children:(c||[]).map((l,b)=>{const s=Number(l?.revenue||0)-Number(l?.cost||0),i=Number(l?.revenue||0)>0?s/Number(l.revenue)*100:0;return e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-all group",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-slate-900 font-bold text-sm group-hover:text-emerald-600 transition-colors",children:l?.name}),e.jsxs("span",{className:"text-[9px] text-slate-400 font-bold uppercase mt-0.5 tracking-widest opacity-60",children:["ID: ",(l?.id||"").slice(-6).toUpperCase()]})]})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"bg-slate-100 px-3 py-1 rounded-full text-[9px] font-bold text-slate-500 uppercase tracking-widest",children:l?.type==="HAJJ"?"حج":l?.type==="UMRAH"?"عمرة":l?.type==="INDIVIDUAL_UMRAH"?"عمرة فردي":"عام"})}),e.jsx("td",{className:"p-4 text-center text-slate-600 tabular-nums",children:Number(l?.bookings||0)}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-emerald-600 font-bold text-base tabular-nums",children:a?"****":Number(l?.revenue||0).toLocaleString()}),e.jsxs("div",{className:"flex gap-1 mt-1",children:[Number(l?.revenueBreakdown?.bookings||0)>0&&e.jsx("span",{title:"حجوزات",className:"w-1 h-1 rounded-full bg-emerald-400"}),Number(l?.revenueBreakdown?.flight||0)>0&&e.jsx("span",{title:"طيران",className:"w-1 h-1 rounded-full bg-blue-400"}),Number(l?.revenueBreakdown?.other||0)>0&&e.jsx("span",{title:"أخرى",className:"w-1 h-1 rounded-full bg-slate-300"})]})]})}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-rose-600 font-bold text-base tabular-nums",children:a?"****":Number(l?.cost||0).toLocaleString()}),e.jsxs("div",{className:"flex gap-1 mt-1",children:[Number(l?.costBreakdown?.purchase||0)>0&&e.jsx("span",{title:"مشتريات",className:"w-1 h-1 rounded-full bg-rose-400"}),Number(l?.costBreakdown?.expenses||0)>0&&e.jsx("span",{title:"مصروفات",className:"w-1 h-1 rounded-full bg-amber-400"}),Number(l?.costBreakdown?.flights||0)>0&&e.jsx("span",{title:"طيران",className:"w-1 h-1 rounded-full bg-slate-400"})]})]})}),e.jsx("td",{className:`p-4 text-center font-bold text-lg tabular-nums ${s>=0?"text-emerald-700 bg-emerald-50/30":"text-rose-700 bg-rose-50/30"}`,children:a?"****":Number(s||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-12 bg-slate-100 h-1.5 rounded-full overflow-hidden shadow-inner",children:e.jsx("div",{className:`h-full ${s>=0?"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.3)]":"bg-rose-500"}`,style:{width:`${Math.min(100,Math.max(0,i))}%`}})}),e.jsxs("span",{className:`text-[10px] font-bold tabular-nums ${s>=0?"text-emerald-600":"text-rose-600"}`,children:[Number(i).toFixed(1),"%"]})]})})]},b)})})]})})]})},Je=({trialBalance:c,shouldMaskAggregate:n,isPrint:m=!1})=>m?e.jsx("div",{className:"space-y-10 animate-in fade-in duration-500 print:animate-none print:opacity-100 print:transform-none font-['Cairo']",children:e.jsx("div",{className:"overflow-hidden rounded-2xl border-2 border-slate-900 shadow-sm",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white text-[12px] font-bold uppercase tracking-[0.2em]",children:[e.jsx("th",{className:"p-6 text-right border-b border-slate-800",children:"اسم الحساب المالي"}),e.jsx("th",{className:"p-6 text-center border-b border-slate-800",children:"التصنيف"}),e.jsx("th",{className:"p-6 text-center border-b border-slate-800",children:"مدين (Debit)"}),e.jsx("th",{className:"p-6 text-center border-b border-slate-800",children:"دائن (Credit)"}),e.jsx("th",{className:"p-6 text-center border-b border-slate-800",children:"الرصيد النهائي"})]})}),e.jsx("tbody",{className:"text-[11px] font-bold divide-y divide-slate-100",children:(c||[]).map((a,d)=>{const u=(a.debit||0)-(a.credit||0);return e.jsxs("tr",{className:d%2===0?"bg-white":"bg-slate-50/30",children:[e.jsx("td",{className:"p-5 text-slate-900 font-bold border-l border-slate-100 text-sm",children:a.name}),e.jsx("td",{className:"p-5 text-center text-slate-400 font-bold uppercase tracking-widest border-l border-slate-100",children:a.type}),e.jsx("td",{className:"p-5 text-center text-emerald-700 font-bold text-sm border-l border-slate-100",children:n?"****":(a.debit||0).toLocaleString()}),e.jsx("td",{className:"p-5 text-center text-rose-700 font-bold text-sm border-l border-slate-100",children:n?"****":(a.credit||0).toLocaleString()}),e.jsxs("td",{className:`p-5 text-center font-bold text-sm ${u!==0?u>0?"bg-emerald-50 text-emerald-900":"bg-rose-50 text-rose-900":"text-slate-300"}`,children:[n?"****":(Math.abs(u)||0).toLocaleString()," ",u>0?"مدين":u<0?"دائن":"0"]})]},d)})}),e.jsx("tfoot",{className:"bg-slate-900 text-white font-bold",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:2,className:"p-8 text-right text-lg",children:"إجمالي أرصدة ميزان المراجعة"}),e.jsx("td",{className:"p-8 text-center text-emerald-400 text-2xl tabular-nums tracking-tighter",children:n?"****":(c||[]).reduce((a,d)=>a+(d.debit||0),0).toLocaleString()}),e.jsx("td",{className:"p-8 text-center text-rose-400 text-2xl tabular-nums tracking-tighter",children:n?"****":(c||[]).reduce((a,d)=>a+(d.credit||0),0).toLocaleString()}),e.jsx("td",{className:"p-8 text-center bg-slate-800 text-white text-2xl tabular-nums tracking-tighter",children:n?"****":((c||[]).reduce((a,d)=>a+(d.debit||0),0)-(c||[]).reduce((a,d)=>a+(d.credit||0),0)).toLocaleString()})]})})]})})}):e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500 no-print",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-6 rounded-2xl border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-500 text-white rounded-xl flex items-center justify-center shadow-lg shadow-emerald-500/20",children:e.jsx(ne,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"ميزان المراجعة"}),e.jsx("p",{className:"text-slate-500 text-[10px] font-bold uppercase tracking-widest",children:"Trial Balance Statement"})]})]})}),e.jsx("div",{className:"overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm",children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white",children:[e.jsx("th",{className:"p-4 text-[10px] font-bold uppercase tracking-widest border-b border-slate-800",children:"الحساب المالي"}),e.jsx("th",{className:"p-4 text-[10px] font-bold uppercase tracking-widest text-center border-b border-slate-800",children:"النوع"}),e.jsx("th",{className:"p-4 text-[10px] font-bold uppercase tracking-widest text-center border-b border-slate-800",children:"مدين (+)"}),e.jsx("th",{className:"p-4 text-[10px] font-bold uppercase tracking-widest text-center border-b border-slate-800",children:"دائن (-)"}),e.jsx("th",{className:"p-4 text-[10px] font-bold uppercase tracking-widest text-center bg-slate-800 border-b border-slate-800",children:"الرصيد النهائي"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:(c||[]).map((a,d)=>{const u=(a.debit||0)-(a.credit||0);return e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-slate-900 font-bold text-sm",children:a.name}),e.jsxs("span",{className:"text-[8px] text-slate-400 font-bold",children:["ID: ",(a.id||"").slice(0,8)]})]})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"text-[9px] px-2 py-0.5 bg-slate-100 text-slate-600 rounded-md font-bold uppercase tracking-tighter",children:a.type})}),e.jsx("td",{className:"p-4 text-center text-emerald-600 font-bold text-base tabular-nums",children:(a.debit||0)>0?n?"****":(a.debit||0).toLocaleString():"-"}),e.jsx("td",{className:"p-4 text-center text-rose-600 font-bold text-base tabular-nums",children:(a.credit||0)>0?n?"****":(a.credit||0).toLocaleString():"-"}),e.jsx("td",{className:"p-4 text-center bg-slate-50/50",children:u!==0?e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2 py-1 rounded-lg font-bold text-sm ${u>0?"text-emerald-700":"text-rose-700"}`,children:[e.jsx("span",{children:n?"****":Math.abs(u||0).toLocaleString()}),e.jsx("span",{className:"text-[8px] opacity-70 font-bold",children:u>0?"(مدين)":"(دائن)"})]}):e.jsx("span",{className:"text-slate-300",children:"-"})})]},d)})}),e.jsx("tfoot",{className:"bg-slate-900 text-white font-bold",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:2,className:"p-5 text-sm",children:"إجمالي ميزان المراجعة"}),e.jsx("td",{className:"p-5 text-center text-emerald-400 text-lg tabular-nums",children:n?"****":(c||[]).reduce((a,d)=>a+(d.debit||0),0).toLocaleString()}),e.jsx("td",{className:"p-5 text-center text-rose-400 text-lg tabular-nums",children:n?"****":(c||[]).reduce((a,d)=>a+(d.credit||0),0).toLocaleString()}),e.jsx("td",{className:"p-5 text-center bg-slate-800 text-white",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[8px] opacity-60 mb-0.5 uppercase tracking-widest font-bold",children:"الصافي"}),e.jsx("span",{className:"text-lg tabular-nums tracking-tighter",children:n?"****":((c||[]).reduce((a,d)=>a+(d.debit||0),0)-(c||[]).reduce((a,d)=>a+(d.credit||0),0)).toLocaleString()})]})})]})})]})})]}),qe=({stats:c,fromDate:n,toDate:m,formatCurrency:a,shouldMaskAggregate:d,isPrint:u=!1})=>{const o=c||{},t=typeof a=="function"?a:r=>r.toLocaleString();return u?e.jsxs("div",{className:"space-y-8 animate-in zoom-in-95 duration-500 print:animate-none print:opacity-100 print:transform-none",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"text-xl font-bold border-b-2 border-emerald-500 pb-2 flex justify-between items-center text-slate-900",children:e.jsx("span",{children:"الإيرادات (Revenues)"})}),e.jsxs("div",{className:"space-y-3 text-slate-800",children:[e.jsxs("div",{className:"flex justify-between p-3 bg-slate-50 rounded-xl border border-slate-100",children:[e.jsx("span",{children:"إيرادات حجز طيران"})," ",e.jsx("span",{className:"font-bold",children:d?"****":(o.flightRevenue||0).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-slate-50 rounded-xl border border-slate-100",children:[e.jsx("span",{children:"إيرادات برامج الحج والعمرة"})," ",e.jsx("span",{className:"font-bold",children:d?"****":(o.hajjUmrahRevenue||0).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-slate-50 rounded-xl border border-slate-100",children:[e.jsx("span",{children:"إيرادات خدمات متنوعة"})," ",e.jsx("span",{className:"font-bold",children:d?"****":(o.serviceRevenue||0).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between p-4 bg-emerald-600 text-white rounded-xl font-bold text-lg shadow-lg",children:[e.jsx("span",{children:"إجمالي الإيرادات"}),e.jsx("span",{children:d?"****":(o.totalSales||0).toLocaleString()})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"text-xl font-bold border-b-2 border-rose-500 pb-2 flex justify-between items-center text-slate-900",children:e.jsx("span",{children:"المصروفات (Expenses)"})}),e.jsxs("div",{className:"space-y-3 text-slate-800",children:[e.jsxs("div",{className:"flex justify-between p-3 bg-slate-50 rounded-xl border border-slate-100",children:[e.jsx("span",{children:"تكلفة المبيعات المباشرة"})," ",e.jsx("span",{className:"font-bold",children:d?"****":(o.totalCost||0).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-slate-50 rounded-xl border border-slate-100",children:[e.jsx("span",{children:"المصروفات التشغيلية والديون"})," ",e.jsx("span",{className:"font-bold",children:d?"****":(o.expenses||0).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between p-4 bg-rose-600 text-white rounded-xl font-bold text-lg shadow-lg",children:[e.jsx("span",{children:"إجمالي التكاليف"}),e.jsx("span",{children:d?"****":((o.totalCost||0)+(o.expenses||0)).toLocaleString()||"0"})]})]})]})]}),e.jsxs("div",{className:"mt-12 flex justify-between items-center p-8 bg-slate-900 text-white rounded-3xl border-r-[15px] border-emerald-500 shadow-2xl relative overflow-hidden",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsx("p",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest mb-1",children:"النتيجة النهائية للفترة"}),e.jsx("h3",{className:"text-3xl font-bold",children:"صافي الربح / الخسارة التشغيلية"})]}),e.jsx("div",{className:"relative z-10 text-left",children:e.jsxs("p",{className:"text-5xl font-bold text-emerald-400 tabular-nums",children:[d?"****":(o.netProfit||0).toLocaleString()," ",e.jsx("span",{className:"text-xl font-medium text-white/60",children:"ج.م"})]})})]})]}):e.jsx("div",{className:"space-y-6 max-w-5xl mx-auto animate-in zoom-in-95 duration-500 no-print",children:e.jsxs("div",{className:"bg-white p-6 rounded-3xl text-slate-900 border border-slate-200 shadow-sm relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 top-0 w-32 h-32 bg-emerald-50 rounded-full blur-[60px] -mr-16 -mt-16 opacity-60"}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 border-b border-slate-100 pb-6 gap-4 relative z-10",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:"بيان الأرباح والخسائر التشغيلي"}),e.jsxs("p",{className:"text-slate-500 text-[9px] font-bold uppercase tracking-widest dir-ltr",dir:"ltr",children:[n," - ",m]})]}),e.jsxs("div",{className:`px-6 py-3 rounded-2xl border font-bold ${(o.netProfit||0)>=0?"bg-emerald-50 border-emerald-100 text-emerald-700":"bg-rose-50 border-rose-100 text-rose-700"}`,children:[e.jsx("p",{className:"text-[9px] uppercase tracking-widest mb-0.5 opacity-70",children:"صافي الربح / الخسارة"}),e.jsx("p",{className:"text-2xl tabular-nums tracking-tighter",children:d?"****":t(o.netProfit||0)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 relative z-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-emerald-700 font-bold text-[10px] uppercase tracking-widest border-r-4 border-emerald-500 pr-3",children:"تدفقات الإيرادات"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 rounded-xl border border-slate-50 hover:bg-slate-50 transition-colors",children:[e.jsx("span",{className:"text-slate-600 text-sm",children:"إيرادات حجز طيران"}),e.jsx("span",{className:"font-bold text-base tabular-nums",children:d?"****":(o.flightRevenue||0).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 rounded-xl border border-slate-50 hover:bg-slate-50 transition-colors",children:[e.jsx("span",{className:"text-slate-600 text-sm",children:"إيرادات العمرة والحج"}),e.jsx("span",{className:"font-bold text-base tabular-nums",children:d?"****":(o.hajjUmrahRevenue||0).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 rounded-xl border border-slate-50 hover:bg-slate-50 transition-colors",children:[e.jsx("span",{className:"text-slate-600 text-sm",children:"إيرادات خدمات أخرى"}),e.jsx("span",{className:"font-bold text-base tabular-nums",children:d?"****":(o.serviceRevenue||0).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 mt-2 border-t border-slate-100",children:[e.jsx("span",{className:"text-emerald-700 font-bold text-sm",children:"إجمالي الإيرادات"}),e.jsx("span",{className:"text-xl font-bold text-emerald-700 tabular-nums",children:d?"****":(o.totalRevenues||o.totalSales||0).toLocaleString()})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-rose-700 font-bold text-[10px] uppercase tracking-widest border-r-4 border-rose-500 pr-3",children:"التكاليف والمصروفات"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 rounded-xl border border-slate-50 hover:bg-slate-50 transition-colors",children:[e.jsx("span",{className:"text-slate-600 text-sm",children:"تكاليف مباشرة"}),e.jsx("span",{className:"font-bold text-base tabular-nums",children:d?"****":(o.totalDirectCosts||o.totalCost||0).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 rounded-xl border border-slate-50 hover:bg-slate-50 transition-colors",children:[e.jsx("span",{className:"text-slate-600 text-sm",children:"مصروفات إدارية"}),e.jsx("span",{className:"font-bold text-base tabular-nums",children:d?"****":(o.adminExpenses||o.expenses||0).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 mt-2 border-t border-slate-100",children:[e.jsx("span",{className:"text-rose-700 font-bold text-sm",children:"إجمالي التكاليف"}),e.jsx("span",{className:"text-xl font-bold text-rose-700 tabular-nums",children:d?"****":((o.totalDirectCosts||o.totalCost||0)+(o.adminExpenses||o.expenses||0)).toLocaleString()})]})]})]})]})]})})},We=({totals:c,trialBalance:n,formatCurrency:m,shouldMaskAggregate:a,isHidden:d,toDate:u,isPrint:o=!1})=>o?e.jsxs("div",{className:"grid grid-cols-2 gap-0 border-2 border-slate-900",children:[e.jsxs("div",{className:"border-l-2 border-slate-900",children:[e.jsx("div",{className:"bg-slate-900 text-white p-3 font-bold text-center text-xs uppercase tracking-widest",children:"الأصول (Assets)"}),e.jsxs("div",{className:"p-4 space-y-4 text-[10px] font-bold",children:[e.jsxs("div",{children:[e.jsx("p",{className:"border-b border-slate-200 text-[8px] text-slate-400 mb-2 uppercase font-bold",children:"السيولة النقدية والبنكية"}),e.jsx("div",{className:"space-y-1",children:(n||[]).filter(t=>t.type==="TREASURY").map((t,r)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:t.name})," ",e.jsx("span",{children:a?"****":(t.debit-t.credit).toLocaleString()||"0"})]},r))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"border-b border-slate-200 text-[8px] text-slate-400 mb-2 uppercase font-bold",children:"مديونيات العملاء"}),e.jsxs("div",{className:"space-y-1",children:[(n||[]).filter(t=>t.type==="CUSTOMER").sort((t,r)=>r.debit-r.credit-(t.debit-t.credit)).slice(0,15).map((t,r)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:t.name})," ",e.jsx("span",{children:d?"****":(t.debit-t.credit).toLocaleString()||"0"})]},r)),(n||[]).filter(t=>t.type==="CUSTOMER").length>15&&e.jsx("div",{className:"text-center text-[7px] text-slate-300 italic",children:"... وغيرهم من العملاء"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"border-b border-slate-200 text-[8px] text-slate-400 mb-2 uppercase font-bold",children:"سلف ومسحوبات موظفين"}),e.jsx("div",{className:"space-y-1",children:(n||[]).filter(t=>t.type==="EMPLOYEE_ADVANCE").map((t,r)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:t.name})," ",e.jsx("span",{children:d?"****":(t.debit-t.credit).toLocaleString()||"0"})]},r))})]}),(n||[]).filter(t=>t.type==="ASSET"&&t.id!=="INVENTORY_ASSET").map((t,r)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:t.name})," ",e.jsx("span",{children:a?"****":(t.debit-t.credit).toLocaleString()||"0"})]},r)),e.jsxs("div",{className:"mt-10 pt-4 border-t-2 border-slate-900 font-bold flex justify-between text-xs bg-slate-50 p-2",children:[e.jsx("span",{children:"إجمالي الأصول"}),e.jsx("span",{children:a?"****":((n||[]).filter(t=>t.type==="TREASURY"||t.type==="CUSTOMER"||t.type==="EMPLOYEE_ADVANCE").reduce((t,r)=>t+(r.debit-r.credit),0)+(n||[]).filter(t=>t.type==="ASSET"&&t.id!=="INVENTORY_ASSET").reduce((t,r)=>t+(r.debit-r.credit),0)).toLocaleString()||"0"})]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"bg-slate-900 text-white p-3 font-bold text-center text-xs uppercase tracking-widest",children:"الخصوم والملكبة (Liabilities)"}),e.jsxs("div",{className:"p-4 space-y-4 text-[10px] font-bold",children:[e.jsxs("div",{children:[e.jsx("p",{className:"border-b border-slate-200 text-[8px] text-slate-400 mb-2 uppercase font-bold",children:"مستحقات الموردين"}),e.jsxs("div",{className:"space-y-1",children:[(n||[]).filter(t=>t.type==="SUPPLIER").sort((t,r)=>t.debit-r.credit-(r.debit-r.credit)).slice(0,15).map((t,r)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:t.name})," ",e.jsx("span",{children:d?"****":Math.abs((t.debit||0)-(t.credit||0)).toLocaleString()||"0"})]},r)),(n||[]).filter(t=>t.type==="SUPPLIER").length>15&&e.jsx("div",{className:"text-center text-[7px] text-slate-300 italic",children:"... وغيرهم من الموردين"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"border-b border-slate-200 text-[8px] text-slate-400 mb-2 uppercase font-bold",children:"جاري الشركاء وحقوق الملكية"}),e.jsx("div",{className:"space-y-1",children:(n||[]).filter(t=>t.type==="PARTNER").map((t,r)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:t.name})," ",e.jsx("span",{children:d?"****":Math.abs((t.debit||0)-(t.credit||0)).toLocaleString()||"0"})]},r))})]}),(n||[]).filter(t=>t.type==="LIABILITY").map((t,r)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:t.name})," ",e.jsx("span",{children:a?"****":Math.abs((t.debit||0)-(t.credit||0)).toLocaleString()||"0"})]},r)),e.jsxs("div",{className:"flex justify-between pt-4 italic text-slate-500 border-t border-dashed",children:[e.jsx("span",{children:"الأرباح المحتجزة / رأس المال"}),e.jsx("span",{children:a?"****":((n||[]).filter(t=>t.type==="TREASURY"||t.type==="CUSTOMER"||t.type==="EMPLOYEE_ADVANCE").reduce((t,r)=>t+(r.debit-r.credit),0)+(n||[]).filter(t=>t.type==="ASSET"&&t.id!=="INVENTORY_ASSET").reduce((t,r)=>t+(r.debit-r.credit),0)-Math.abs((n||[]).filter(t=>t.type==="SUPPLIER"||t.type==="LIABILITY"||t.type==="PARTNER").reduce((t,r)=>t+(r.debit-r.credit),0))).toLocaleString()||"0"})]}),e.jsxs("div",{className:"mt-10 pt-4 border-t-2 border-slate-900 font-bold flex justify-between text-xs bg-slate-50 p-2",children:[e.jsx("span",{children:"إجمالي الخصوم والملكية"}),e.jsx("span",{children:a?"****":((n||[]).filter(t=>t.type==="TREASURY"||t.type==="CUSTOMER"||t.type==="EMPLOYEE_ADVANCE").reduce((t,r)=>t+(r.debit-r.credit),0)+(n||[]).filter(t=>t.type==="ASSET"&&t.id!=="INVENTORY_ASSET").reduce((t,r)=>t+(r.debit-r.credit),0)).toLocaleString()||"0"})]})]})]})]}):e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 print:animate-none print:opacity-100 print:transform-none",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white p-6 rounded-3xl shadow-sm border border-slate-200 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 top-0 w-32 h-32 bg-indigo-50 rounded-full blur-[60px] -mr-16 -mt-16 opacity-60"}),e.jsxs("div",{className:"flex items-center gap-6 relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-indigo-600 text-white rounded-2xl flex items-center justify-center shadow-lg transform group-hover:scale-105 transition-transform duration-500",children:e.jsx(re,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight mb-1",children:"قائمة المركز المالي"}),e.jsxs("p",{className:"text-indigo-400 font-bold uppercase tracking-widest text-[9px] opacity-70 flex items-center gap-2",children:[e.jsx(T,{size:12})," Statement of Financial Position • As of ",u]})]})]}),e.jsxs("div",{className:"text-left bg-indigo-50/50 px-6 py-4 rounded-2xl border border-indigo-100/50 relative z-10",children:[e.jsx("p",{className:"text-[9px] font-bold text-indigo-400 uppercase tracking-widest mb-1 opacity-60",children:"إجمالي الميزانية العمومية"}),e.jsxs("p",{className:"text-3xl font-bold text-indigo-600 tabular-nums tracking-tighter",children:[a?"****":(c?.assets||0).toLocaleString()," ",e.jsx("span",{className:"text-sm font-bold opacity-40",children:"ج.م"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2 px-2",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-500 text-white rounded-2xl flex items-center justify-center shadow-md",children:e.jsx(me,{size:24})}),e.jsx("h4",{className:"text-xl font-bold text-slate-900 tracking-tight",children:"الأصول والاستخدامات"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-200 hover:shadow-md transition-all duration-500",children:[e.jsx("h5",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-50 pb-3",children:"السيولة النقدية والبنكية"}),e.jsxs("div",{className:"space-y-3",children:[(n||[]).filter(t=>t.type==="TREASURY").map((t,r)=>e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-slate-600 font-bold text-sm group-hover:text-indigo-600 transition-colors",children:t.name}),e.jsx("span",{className:"font-bold text-slate-900 text-base tabular-nums tracking-tight",children:a?"****":((t.debit||0)-(t.credit||0)).toLocaleString()||"0"})]},r)),e.jsxs("div",{className:"pt-4 mt-1 border-t-2 border-slate-50 flex justify-between items-center",children:[e.jsx("span",{className:"text-indigo-600 font-bold uppercase tracking-widest text-[10px]",children:"إجمالي السيولة"}),e.jsx("div",{className:"bg-indigo-50 px-4 py-1.5 rounded-xl",children:e.jsx("span",{className:"text-indigo-600 font-bold text-lg tabular-nums tracking-tight",children:a?"****":((n||[]).filter(t=>t.type==="TREASURY").reduce((t,r)=>t+(r.debit-r.credit),0)||0).toLocaleString()||"0"})})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-200 hover:shadow-md transition-all duration-500",children:[e.jsx("h5",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-50 pb-3",children:"مديونيات العملاء (ذمم مدينة)"}),e.jsx("div",{className:"space-y-3 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:(n||[]).filter(t=>t.type==="CUSTOMER").sort((t,r)=>r.debit-r.credit-(t.debit-t.credit)).map((t,r)=>e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-slate-600 font-bold text-sm group-hover:text-emerald-600 transition-colors",children:t.name}),e.jsx("span",{className:"font-bold text-slate-900 text-base tabular-nums tracking-tight",children:d?"****":((t.debit||0)-(t.credit||0)).toLocaleString()||"0"})]},r))}),e.jsxs("div",{className:"pt-6 mt-3 border-t-2 border-slate-50 flex justify-between items-center",children:[e.jsx("span",{className:"text-emerald-600 font-bold uppercase tracking-widest text-[10px]",children:"إجمالي الذمم المدينة"}),e.jsx("div",{className:"bg-emerald-50 px-4 py-1.5 rounded-xl",children:e.jsx("span",{className:"text-emerald-600 font-bold text-lg tabular-nums tracking-tight",children:a?"****":((n||[]).filter(t=>t.type==="CUSTOMER").reduce((t,r)=>t+(r.debit-r.credit),0)||0).toLocaleString()||"0"})})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-200 hover:shadow-md transition-all duration-500",children:[e.jsx("h5",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-50 pb-3",children:"سلف ومسحوبات موظفين"}),e.jsxs("div",{className:"space-y-3",children:[(n||[]).filter(t=>t.type==="EMPLOYEE_ADVANCE").map((t,r)=>e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-slate-600 font-bold text-sm group-hover:text-amber-600 transition-colors",children:t.name}),e.jsx("span",{className:"font-bold text-slate-900 text-base tabular-nums tracking-tight",children:d?"****":((t.debit||0)-(t.credit||0)).toLocaleString()||"0"})]},r)),(n||[]).filter(t=>t.type==="EMPLOYEE_ADVANCE").length===0&&e.jsx("p",{className:"text-xs text-slate-300 font-bold text-center py-2",children:"لا توجد سلف قائمة حالياً"}),e.jsxs("div",{className:"pt-4 mt-1 border-t-2 border-slate-50 flex justify-between items-center font-bold",children:[e.jsx("span",{className:"text-slate-400 uppercase tracking-widest text-[9px]",children:"إجمالي العهد والسلف"}),e.jsx("span",{className:"text-slate-900 text-lg tabular-nums tracking-tight",children:a?"****":((n||[]).filter(t=>t.type==="EMPLOYEE_ADVANCE").reduce((t,r)=>t+(r.debit-r.credit),0)||0).toLocaleString()||"0"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-200 hover:shadow-md transition-all duration-500",children:[e.jsx("h5",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-50 pb-3",children:"أصول أخرى وخطابات ضمان"}),e.jsxs("div",{className:"space-y-3",children:[(n||[]).filter(t=>t.type==="ASSET"&&t.id!=="INVENTORY_ASSET").map((t,r)=>e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-slate-600 font-bold text-sm group-hover:text-indigo-600 transition-colors",children:t.name}),e.jsx("span",{className:"font-bold text-slate-900 text-base tabular-nums tracking-tight",children:a?"****":((t.debit||0)-(t.credit||0)).toLocaleString()||"0"})]},r)),(n||[]).filter(t=>t.type==="ASSET"&&t.id!=="INVENTORY_ASSET").length===0&&e.jsx("p",{className:"text-xs text-slate-300 font-bold text-center py-2",children:"لا توجد أصول أخرى"}),e.jsxs("div",{className:"pt-6 mt-2 border-t-2 border-slate-50 flex justify-between items-center font-bold",children:[e.jsx("span",{className:"text-slate-400 uppercase tracking-widest text-[10px]",children:"إجمالي الأصول غير المتداولة"}),e.jsx("span",{className:"text-slate-900 text-xl tabular-nums tracking-tighter",children:a?"****":((n||[]).filter(t=>t.type==="ASSET"&&t.id!=="INVENTORY_ASSET").reduce((t,r)=>t+(r.debit-r.credit),0)||0).toLocaleString()||"0"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2 px-2",children:[e.jsx("div",{className:"w-12 h-12 bg-rose-500 text-white rounded-2xl flex items-center justify-center shadow-md",children:e.jsx(te,{size:24})}),e.jsx("h4",{className:"text-xl font-bold text-slate-900 tracking-tight",children:"الخصوم والالتزامات"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-200 hover:shadow-md transition-all duration-500",children:[e.jsx("h5",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-50 pb-3",children:"مستحقات الموردين (ذمم دائنة)"}),e.jsx("div",{className:"space-y-3 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:(n||[]).filter(t=>t.type==="SUPPLIER").sort((t,r)=>r.credit-r.debit-(t.credit-t.debit)).map((t,r)=>e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-slate-600 font-bold text-sm group-hover:text-rose-600 transition-colors",children:t.name}),e.jsx("span",{className:"font-bold text-slate-900 text-base tabular-nums tracking-tight",children:d?"****":((t.credit||0)-(t.debit||0)).toLocaleString()||"0"})]},r))}),e.jsxs("div",{className:"pt-6 mt-3 border-t-2 border-slate-50 flex justify-between items-center",children:[e.jsx("span",{className:"text-rose-600 font-bold uppercase tracking-widest text-[10px]",children:"إجمالي الذمم الدائنة"}),e.jsx("div",{className:"bg-rose-50 px-4 py-1.5 rounded-xl",children:e.jsx("span",{className:"text-rose-600 font-bold text-lg tabular-nums tracking-tight",children:a?"****":((n||[]).filter(t=>t.type==="SUPPLIER").reduce((t,r)=>t+(r.credit-r.debit),0)||0).toLocaleString()||"0"})})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-200 hover:shadow-md transition-all duration-500",children:[e.jsx("h5",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-50 pb-3",children:"مستحقات الرواتب والالتزامات"}),e.jsxs("div",{className:"space-y-3",children:[(n||[]).filter(t=>t.type==="LIABILITY").map((t,r)=>e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-slate-600 font-bold text-sm group-hover:text-rose-600 transition-colors",children:t.name}),e.jsx("span",{className:"font-bold text-slate-900 text-base tabular-nums tracking-tight",children:d?"****":((t.credit||0)-(t.debit||0)).toLocaleString()||"0"})]},r)),e.jsxs("div",{className:"pt-6 mt-2 border-t-2 border-slate-50 flex justify-between items-center font-bold",children:[e.jsx("span",{className:"text-slate-400 uppercase tracking-widest text-[9px]",children:"إجمالي الالتزامات الجارية"}),e.jsx("span",{className:"text-rose-600 text-lg tabular-nums tracking-tight",children:a?"****":((n||[]).filter(t=>t.type==="LIABILITY").reduce((t,r)=>t+(r.credit-r.debit),0)||0).toLocaleString()||"0"})]})]})]}),e.jsxs("div",{className:"bg-slate-900 p-8 rounded-3xl text-white shadow-sm relative overflow-hidden group",children:[e.jsx("div",{className:"absolute -right-16 -top-16 w-32 h-32 bg-indigo-500/20 rounded-full blur-[40px]"}),e.jsxs("h5",{className:"text-[10px] font-bold text-indigo-400 uppercase tracking-widest mb-6 flex items-center gap-2 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full shadow-[0_0_10px_rgba(99,102,241,0.5)]"}),"حقوق الملكية والأرباح المحتجزة"]}),e.jsxs("div",{className:"space-y-4 relative z-10",children:[(n||[]).filter(t=>t.type==="PARTNER"||t.type==="EQUITY").map((t,r)=>e.jsxs("div",{className:"flex justify-between items-center group/item",children:[e.jsx("span",{className:"text-slate-400 font-bold text-sm group-hover/item:text-white transition-colors",children:t.name}),e.jsx("span",{className:"font-bold text-lg tabular-nums tracking-tight",children:a?"****":((t.credit||0)-(t.debit||0)).toLocaleString()||"0"})]},r)),e.jsxs("div",{className:"flex justify-between items-center bg-white/5 p-4 rounded-xl border border-white/5 hover:bg-white/10 transition-all",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-emerald-400 font-bold uppercase tracking-widest text-[8px] block mb-0.5",children:"Current Period Result"}),e.jsx("span",{className:"text-white font-bold text-sm",children:"أرباح / (خسائر) الفترة الحالية"})]}),e.jsx("span",{className:`text-xl font-bold tabular-nums tracking-tight ${c?.currentNetProfit>=0?"text-emerald-400":"text-rose-400"}`,children:a?"****":(c?.currentNetProfit||0).toLocaleString()})]}),e.jsxs("div",{className:"pt-6 mt-2 border-t border-white/10 flex justify-between items-center",children:[e.jsx("span",{className:"text-indigo-400 font-bold text-base uppercase tracking-widest",children:"إجمالي رأس المال والملكبة"}),e.jsx("span",{className:"text-2xl font-bold text-indigo-400 tabular-nums tracking-tighter",children:a?"****":(c?.totalEquity||0).toLocaleString()})]})]})]})]})]})]}),e.jsxs("div",{className:"bg-indigo-600 p-8 rounded-3xl text-white flex flex-col xl:flex-row justify-between items-center gap-6 shadow-sm relative overflow-hidden group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-700 to-transparent opacity-50"}),e.jsxs("div",{className:"relative z-10 text-center xl:text-right",children:[e.jsx("h4",{className:"text-2xl font-bold mb-1 tracking-tight",children:"توازن المركز المالي (Balanced)"}),e.jsx("p",{className:"text-indigo-100 text-[9px] font-bold uppercase tracking-widest opacity-80",children:"Accounting Equation: Assets = Liabilities + Equity"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-10 relative z-10",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[9px] font-bold text-indigo-200 uppercase tracking-widest mb-1.5 opacity-70",children:"إجمالي الأصول"}),e.jsx("p",{className:"text-3xl font-bold tabular-nums tracking-tighter",children:a?"****":(c?.assets||0).toLocaleString()})]}),e.jsx("div",{className:"hidden md:block w-px h-12 bg-white/20"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[9px] font-bold text-indigo-200 uppercase tracking-widest mb-1.5 opacity-70",children:"الخصوم + حقوق الملكية"}),e.jsx("p",{className:"text-3xl font-bold tabular-nums tracking-tighter",children:a?"****":((c?.liabilities||0)+(c?.totalEquity||0)).toLocaleString()})]}),Math.abs((c?.assets||0)-((c?.liabilities||0)+(c?.totalEquity||0)))<1?e.jsx("div",{className:"bg-white text-indigo-600 p-4 rounded-2xl shadow-lg transform group-hover:rotate-[360deg] transition-transform duration-1000",children:e.jsx(T,{size:28})}):e.jsx("div",{className:"bg-rose-500 text-white p-4 rounded-2xl shadow-lg animate-pulse",children:e.jsx(re,{size:28})})]})]})]}),$t=({customers:c,balanceMap:n,isHidden:m,currencies:a,searchTerm:d,isPrint:u=!1,baseCurrency:o="EGP"})=>{const t=S.useMemo(()=>{if(!d)return c;const l=d.toLowerCase();return(c||[]).filter(b=>(b.name||"").toLowerCase().includes(l))},[c,d]),r=S.useMemo(()=>(c||[]).reduce((l,b)=>{if(!b)return l;const s=(n||{})[`CUSTOMER-${b.id}`]?.base||0;return l+(s>0?s:0)},0),[c,n]);return u?e.jsx("div",{className:"space-y-6 animate-in fade-in duration-500 print:animate-none print:opacity-100 print:transform-none",children:e.jsx("div",{className:"overflow-hidden rounded-2xl border-2 border-slate-900 shadow-sm",children:e.jsxs("table",{className:"w-full text-right text-xs border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white font-bold uppercase tracking-widest",children:[e.jsx("th",{className:"p-4 border-b border-slate-700",children:"اسم العميل"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"الرصيد المحلي (ج.م)"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"الرصيد بالعملة"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"العملة"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"الحالة"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 font-bold text-[10px]",children:(t||[]).map((l,b)=>{if(!l)return null;const s=(n||{})[`CUSTOMER-${l.id}`],i=s?.base||0;if(i===0)return null;const j=l.openingBalanceCurrency||o,w=s?.currency||0;return(a||[]).find(I=>I&&I.code===j)?.symbol,e.jsxs("tr",{className:b%2===0?"bg-white":"bg-slate-50",children:[e.jsx("td",{className:"p-3 border-x border-slate-200 font-bold",children:l.name||"-"}),e.jsx("td",{className:`p-3 text-center border-x border-slate-200 ${i>0?"text-rose-700":"text-emerald-700"}`,children:m?"****":(i||0).toLocaleString()}),e.jsx("td",{className:`p-3 text-center border-x border-slate-200 ${w>0?"text-rose-700":"text-emerald-700"}`,children:m?"****":Math.abs(w||0).toLocaleString()}),e.jsx("td",{className:"p-3 text-center border-x border-slate-200",children:j}),e.jsx("td",{className:"p-3 text-center border-x border-slate-200 font-bold",children:i>0?"مدين (عليه)":"دائن (له)"})]},b)})}),e.jsx("tfoot",{className:"bg-slate-900 text-white font-bold text-xs",children:e.jsxs("tr",{children:[e.jsx("td",{className:"p-4",children:"إجمالي المديونيات"}),e.jsx("td",{className:"p-4 text-center",children:m?"****":r.toLocaleString()}),e.jsx("td",{colSpan:3})]})})]})})}):e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white p-6 rounded-3xl shadow-sm border border-white relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 top-0 w-64 h-64 bg-indigo-50 rounded-full blur-[100px] -mr-32 -mt-32 opacity-60"}),e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-indigo-600 text-white rounded-2xl flex items-center justify-center shadow-lg shadow-indigo-200 transform group-hover:scale-110 transition-transform duration-500",children:e.jsx(Z,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight mb-1",children:"مديونيات العملاء"}),e.jsxs("p",{className:"text-indigo-400 font-bold uppercase tracking-[0.2em] text-[9px] opacity-70 flex items-center gap-2",children:[e.jsx(T,{size:12})," Customers Accounts Summary • Credit Control"]})]})]}),e.jsx("div",{className:"flex gap-4 relative z-10",children:e.jsxs("div",{className:"bg-rose-50 px-6 py-4 rounded-2xl border border-rose-100 text-center",children:[e.jsx("p",{className:"text-[9px] font-bold text-rose-400 uppercase tracking-[0.2em] mb-1 opacity-60",children:"إجمالي المديونيات المستحقة"}),e.jsxs("p",{className:"text-2xl font-bold text-rose-600 tabular-nums tracking-tight",children:[m?"****":(r||0).toLocaleString()," ",e.jsx("span",{className:"text-xs font-bold opacity-40",children:"ج.م"})]})]})})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl border border-white bg-white shadow-sm",children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white",children:[e.jsx("th",{className:"p-4 font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"اسم العميل"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"الرصيد المحلي (ج.م)"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"الرصيد بالعملة"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"العملة"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800 bg-slate-900",children:"حالة الحساب"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 font-medium text-xs",children:!t||t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-10 text-center text-slate-400 italic font-medium",children:"لا توجد مديونيات قائمة حالياً"})}):t.map((l,b)=>{if(!l)return null;const s=(n||{})[`CUSTOMER-${l.id}`],i=s?.base||0;if(i===0)return null;const j=l.openingBalanceCurrency||o,w=s?.currency||0,I=(a||[]).find(Y=>Y&&Y.code===j)?.symbol||"ج.م";return e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-all group",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center text-slate-400 group-hover:bg-indigo-600 group-hover:text-white transition-all duration-500",children:e.jsx(de,{size:14})}),e.jsx("p",{className:"text-slate-900 font-bold text-sm group-hover:text-indigo-600 transition-colors",children:l.name||"-"})]})}),e.jsx("td",{className:`p-4 text-center font-bold text-base tabular-nums ${i>0?"text-rose-600":"text-emerald-600"}`,children:m?"****":(i||0).toLocaleString()}),e.jsx("td",{className:`p-4 text-center font-bold text-base tabular-nums ${w>0?"text-rose-600":"text-emerald-600"}`,children:m?"****":Math.abs(w||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("span",{className:"bg-slate-100 px-3 py-1 rounded-full text-[9px] font-bold text-slate-500 uppercase tracking-widest",children:[I," (",j,")"]})}),e.jsx("td",{className:"p-4 text-center bg-slate-50/30",children:i>0?e.jsxs("div",{className:"flex items-center justify-center gap-2 text-rose-600 bg-rose-50 px-3 py-1.5 rounded-xl",children:[e.jsx(ie,{size:12}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest",children:"عليه مديونية"})]}):e.jsxs("div",{className:"flex items-center justify-center gap-2 text-emerald-600 bg-emerald-50 px-3 py-1.5 rounded-xl",children:[e.jsx(rt,{size:12}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest",children:"له رصيد دائن"})]})})]},b)})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-indigo-900 p-6 rounded-3xl text-white shadow-lg relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 bottom-0 opacity-10 transform translate-x-10 translate-y-10 group-hover:translate-x-0 group-hover:translate-y-0 transition-transform duration-700",children:e.jsx(Z,{size:120})}),e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 mb-2",children:"عدد العملاء المشمولين"}),e.jsx("p",{className:"text-3xl font-bold tabular-nums",children:(t||[]).filter(l=>l&&((n||{})[`CUSTOMER-${l.id}`]?.base||0)!==0).length})]}),e.jsxs("div",{className:"bg-slate-900 p-6 rounded-3xl text-white shadow-lg relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 bottom-0 opacity-10 transform translate-x-10 translate-y-10 group-hover:translate-x-0 group-hover:translate-y-0 transition-transform duration-700",children:e.jsx(T,{size:120})}),e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 mb-2",children:"متوسط مديونية العميل"}),e.jsxs("p",{className:"text-3xl font-bold tabular-nums",children:[m?"****":Math.round(r/((t||[]).filter(l=>l&&((n||{})[`CUSTOMER-${l.id}`]?.base||0)>0).length||1)).toLocaleString(),e.jsx("span",{className:"text-sm font-medium opacity-40 mr-2",children:"ج.م"})]})]})]})]})},Ke=A.memo($t),Dt=({suppliers:c,balanceMap:n,isHidden:m,currencies:a,searchTerm:d,isPrint:u=!1,baseCurrency:o="EGP"})=>{const t=S.useMemo(()=>{if(!d)return c;const l=d.toLowerCase();return(c||[]).filter(b=>(b.company||"").toLowerCase().includes(l)||(b.name||"").toLowerCase().includes(l))},[c,d]),r=S.useMemo(()=>(c||[]).reduce((l,b)=>{if(!b)return l;const s=(n||{})[`SUPPLIER-${b.id}`]?.base||0;return l+(s>0?s:0)},0),[c,n]);return u?e.jsx("div",{className:"space-y-6 animate-in fade-in duration-500 print:animate-none print:opacity-100 print:transform-none",children:e.jsx("div",{className:"overflow-hidden rounded-2xl border-2 border-slate-900 shadow-sm",children:e.jsxs("table",{className:"w-full text-right text-xs border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white font-bold uppercase tracking-widest",children:[e.jsx("th",{className:"p-4 border-b border-slate-700",children:"اسم المورد / الشركة"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"الرصيد المحلي (ج.م)"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"الرصيد بالعملة"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"العملة"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"الحالة"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 font-bold text-[10px]",children:(t||[]).map((l,b)=>{if(!l)return null;const s=(n||{})[`SUPPLIER-${l.id}`],i=s?.base||0;if(i===0)return null;const j=l.openingBalanceCurrency||o,w=s?.currency||0;return(a||[]).find(I=>I&&I.code===j)?.symbol,e.jsxs("tr",{className:b%2===0?"bg-white":"bg-slate-50",children:[e.jsx("td",{className:"p-3 border-x border-slate-200 font-bold",children:l.company||l.name||"-"}),e.jsx("td",{className:`p-3 text-center border-x border-slate-200 ${i>0?"text-rose-700":"text-emerald-700"}`,children:m?"****":(i||0).toLocaleString()}),e.jsx("td",{className:`p-3 text-center border-x border-slate-200 ${w>0?"text-rose-700":"text-emerald-700"}`,children:m?"****":Math.abs(w||0).toLocaleString()}),e.jsx("td",{className:"p-3 text-center border-x border-slate-200",children:j}),e.jsx("td",{className:"p-3 text-center border-x border-slate-200 font-bold",children:i>0?"دائن (له علينا)":"مدين (عليه لنا)"})]},b)})}),e.jsx("tfoot",{className:"bg-slate-900 text-white font-bold text-xs",children:e.jsxs("tr",{children:[e.jsx("td",{className:"p-4",children:"إجمالي مستحقات الموردين"}),e.jsx("td",{className:"p-4 text-center",children:m?"****":r.toLocaleString()}),e.jsx("td",{colSpan:3})]})})]})})}):e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white p-6 rounded-3xl shadow-sm border border-slate-200 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 top-0 w-32 h-32 bg-rose-50 rounded-full blur-[60px] -mr-16 -mt-16 opacity-60"}),e.jsxs("div",{className:"flex items-center gap-6 relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-rose-600 text-white rounded-2xl flex items-center justify-center shadow-lg transform group-hover:scale-105 transition-transform duration-500",children:e.jsx(se,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight mb-1",children:"مستحقات الموردين"}),e.jsxs("p",{className:"text-rose-400 font-bold uppercase tracking-widest text-[9px] opacity-70 flex items-center gap-2",children:[e.jsx(T,{size:12})," Suppliers Accounts Summary • Accounts Payable"]})]})]}),e.jsx("div",{className:"flex gap-4 relative z-10",children:e.jsxs("div",{className:"bg-rose-50/50 px-6 py-4 rounded-2xl border border-rose-100/50 text-center",children:[e.jsx("p",{className:"text-[9px] font-bold text-rose-400 uppercase tracking-widest mb-1 opacity-60",children:"إجمالي المستحقات للموردين"}),e.jsxs("p",{className:"text-3xl font-bold text-rose-600 tabular-nums tracking-tighter",children:[m?"****":(r||0).toLocaleString()," ",e.jsx("span",{className:"text-sm font-bold opacity-40",children:"ج.م"})]})]})})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm",children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white",children:[e.jsx("th",{className:"p-4 font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"اسم المورد / الشركة"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"الرصيد المحلي (ج.م)"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"الرصيد بالعملة"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"العملة"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800 bg-slate-800",children:"الحالة المالية"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 font-bold text-sm",children:!t||t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-12 text-center text-slate-400 italic font-medium",children:"لا توجد مستحقات قائمة للموردين حالياً"})}):t.map((l,b)=>{if(!l)return null;const s=(n||{})[`SUPPLIER-${l.id}`],i=s?.base||0;if(i===0)return null;const j=l.openingBalanceCurrency||o,w=s?.currency||0,I=(a||[]).find(Y=>Y&&Y.code===j)?.symbol||"ج.م";return e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-all group",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center text-slate-400 group-hover:bg-rose-600 group-hover:text-white transition-all duration-500",children:e.jsx(se,{size:14})}),e.jsx("p",{className:"text-slate-900 font-bold text-sm group-hover:text-rose-600 transition-colors",children:l.company||l.name||"-"})]})}),e.jsx("td",{className:`p-4 text-center font-bold text-base tabular-nums ${i>0?"text-rose-600":"text-emerald-600"}`,children:m?"****":(i||0).toLocaleString()}),e.jsx("td",{className:`p-4 text-center font-bold text-base tabular-nums ${w>0?"text-rose-600":"text-emerald-600"}`,children:m?"****":Math.abs(w||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("span",{className:"bg-slate-100 px-3 py-1 rounded-full text-[9px] font-bold text-slate-500 uppercase tracking-widest",children:[I," (",j,")"]})}),e.jsx("td",{className:"p-4 text-center bg-slate-50/30",children:i>0?e.jsxs("div",{className:"flex items-center justify-center gap-2 text-rose-600 bg-rose-50 px-3 py-1.5 rounded-xl",children:[e.jsx(ie,{size:12}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest",children:"له مستحقات علينا"})]}):e.jsxs("div",{className:"flex items-center justify-center gap-2 text-emerald-600 bg-emerald-50 px-3 py-1.5 rounded-xl",children:[e.jsx(rt,{size:12}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest",children:"مدين للشركة"})]})})]},b)})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-rose-900 p-8 rounded-3xl text-white shadow-sm relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 bottom-0 opacity-10 transform translate-x-8 translate-y-8 group-hover:translate-x-0 group-hover:translate-y-0 transition-transform duration-700",children:e.jsx(se,{size:120})}),e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest opacity-60 mb-2",children:"عدد الموردين النشطين"}),e.jsx("p",{className:"text-3xl font-bold tabular-nums",children:(t||[]).filter(l=>l&&((n||{})[`SUPPLIER-${l.id}`]?.base||0)!==0).length})]}),e.jsxs("div",{className:"bg-slate-900 p-8 rounded-3xl text-white shadow-sm relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 bottom-0 opacity-10 transform translate-x-8 translate-y-8 group-hover:translate-x-0 group-hover:translate-y-0 transition-transform duration-700",children:e.jsx(re,{size:120})}),e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest opacity-60 mb-2",children:"متوسط مستحقات المورد"}),e.jsxs("p",{className:"text-3xl font-bold tabular-nums",children:[m?"****":Math.round(r/((t||[]).filter(l=>l&&((n||{})[`SUPPLIER-${l.id}`]?.base||0)>0).length||1)).toLocaleString(),e.jsx("span",{className:"text-base font-bold opacity-40 mr-2",children:"ج.م"})]})]})]})]})},Xe=A.memo(Dt),Ut=({customers:c,employees:n,transactions:m,balanceMap:a,isHidden:d,currencies:u,searchTerm:o,isPrint:t=!1,baseCurrency:r="EGP"})=>{const l=S.useMemo(()=>{const s={};return(m||[]).forEach(i=>{i&&!i.isVoided&&i.employeeId&&i.relatedEntityId&&(s[i.employeeId]||(s[i.employeeId]=new Set),s[i.employeeId].add(i.relatedEntityId))}),s},[m]),b=S.useMemo(()=>{const s=[];if((n||[]).forEach(j=>{if(!j)return;const w=l[j.id]||new Set,I=[];w.forEach(Y=>{const g=(c||[]).find(J=>J&&J.id===Y),X=(a||{})[`CUSTOMER-${Y}`]?.base||0;g&&X>0&&I.push({...g,debt:X})}),I.length>0&&(I.sort((Y,g)=>g.debt-Y.debt),s.push({employee:j,customers:I}))}),!o)return s;const i=o.toLowerCase();return(s||[]).filter(j=>j&&j.employee&&((j.employee.name||"").toLowerCase().includes(i)||(j.customers||[]).some(w=>w&&(w.name||"").toLowerCase().includes(i))))},[n,c,a,l,o]);return t?e.jsx("div",{className:"space-y-6",children:(b||[]).map((s,i)=>e.jsxs("div",{className:"space-y-2 break-inside-avoid mb-8",children:[e.jsxs("div",{className:"bg-slate-100 p-3 rounded-lg border border-slate-300",children:[e.jsxs("h3",{className:"font-bold text-sm",children:["الموظف: ",s.employee?.name||"-"]}),e.jsxs("p",{className:"text-[10px]",children:["عدد العملاء المدينين: ",s.customers?.length||0]})]}),e.jsxs("table",{className:"w-full text-right text-[10px] border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-200",children:[e.jsx("th",{className:"p-2 border border-slate-300",children:"اسم العميل"}),e.jsx("th",{className:"p-2 border border-slate-300",children:"رقم الهاتف"}),e.jsx("th",{className:"p-2 text-center border border-slate-300",children:"المديونية (ج.م)"})]})}),e.jsx("tbody",{children:(s.customers||[]).map((j,w)=>e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border border-slate-300",children:j.name||"-"}),e.jsx("td",{className:"p-2 border border-slate-300",children:j.phone||"-"}),e.jsx("td",{className:"p-2 text-center border border-slate-300 font-bold",children:d?"****":(j.debt||0).toLocaleString()})]},w))})]})]},i))}):e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white p-6 rounded-3xl shadow-sm border border-white relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 top-0 w-64 h-64 bg-indigo-50 rounded-full blur-[100px] -mr-32 -mt-32 opacity-60"}),e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-rose-600 text-white rounded-2xl flex items-center justify-center shadow-lg shadow-rose-200 transform group-hover:scale-110 transition-transform duration-500",children:e.jsx(T,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight mb-1",children:"متابعة تحصيل المديونيات"}),e.jsxs("p",{className:"text-rose-400 font-bold uppercase tracking-[0.2em] text-[9px] opacity-70 flex items-center gap-2",children:[e.jsx(T,{size:12})," Debt Collection Follow-up • Employee Assignment"]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-8",children:b.length===0?e.jsxs("div",{className:"bg-white p-12 rounded-3xl border border-slate-200 text-center shadow-sm",children:[e.jsx(Z,{size:48,className:"mx-auto text-slate-200 mb-4"}),e.jsx("p",{className:"text-slate-400 font-medium",children:"لا توجد مديونيات مرتبطة بموظفين حالياً"})]}):b.map((s,i)=>e.jsxs("div",{className:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"bg-slate-50 p-4 border-b border-slate-200 flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-600 text-white rounded-xl flex items-center justify-center shadow-sm",children:e.jsx(de,{size:20})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900",children:s.employee?.name||"-"}),e.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-bold tracking-widest",children:s.employee?.position||"موظف"})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"bg-white px-4 py-2 rounded-xl border border-slate-200 text-center min-w-[120px]",children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-0.5",children:"إجمالي التحصيل المطلوب"}),e.jsxs("p",{className:"text-lg font-bold text-rose-600",children:[d?"****":(s.customers||[]).reduce((j,w)=>j+(w.debt||0),0).toLocaleString()," ",e.jsx("span",{className:"text-[10px] opacity-40",children:"ج.م"})]})]}),e.jsxs("div",{className:"bg-white px-4 py-2 rounded-xl border border-slate-200 text-center",children:[e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-0.5",children:"عدد العملاء"}),e.jsx("p",{className:"text-lg font-bold text-indigo-600",children:s.customers?.length||0})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-white text-slate-400",children:[e.jsx("th",{className:"p-4 font-bold text-[9px] uppercase tracking-widest border-b border-slate-100",children:"العميل"}),e.jsx("th",{className:"p-4 font-bold text-[9px] uppercase tracking-widest border-b border-slate-100 text-center",children:"رقم الهاتف"}),e.jsx("th",{className:"p-4 font-bold text-[9px] uppercase tracking-widest border-b border-slate-100 text-center",children:"المديونية"}),e.jsx("th",{className:"p-4 font-bold text-[9px] uppercase tracking-widest border-b border-slate-100 text-center",children:"الإجراء"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:(s.customers||[]).map((j,w)=>e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors group",children:[e.jsx("td",{className:"p-4",children:e.jsx("p",{className:"font-bold text-slate-900 text-sm",children:j.name||"-"})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"text-slate-600 text-xs font-medium",children:j.phone||"---"})}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("span",{className:"font-bold text-rose-600 tabular-nums",children:[d?"****":(j.debt||0).toLocaleString()," ",e.jsx("span",{className:"text-[10px] opacity-40 font-normal",children:"ج.م"})]})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("div",{className:"flex items-center justify-center gap-2",children:j.phone&&typeof j.phone=="string"&&e.jsxs(e.Fragment,{children:[e.jsx("a",{href:`tel:${j.phone}`,className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"اتصال هاتفي",children:e.jsx(Te,{size:14})}),e.jsx("a",{href:`https://wa.me/${j.phone.replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",title:"واتساب",children:e.jsx(at,{size:14})})]})})})]},w))})]})})]},i))})]})},He=A.memo(Ut),D=A.memo(({active:c,onClick:n,label:m})=>e.jsx("button",{onClick:n,className:`px-6 py-3 rounded-2xl font-bold text-xs whitespace-nowrap transition-all duration-500 transform active:scale-95 ${c?"bg-slate-900 text-indigo-400 shadow-lg border-transparent":"text-slate-500 hover:text-slate-900 hover:bg-white hover:shadow-md border border-transparent"}`,children:m})),fe=A.memo(({title:c,value:n,icon:m,trend:a,color:d,highlight:u,isHidden:o})=>{const t={slate:"from-slate-900/10 to-transparent text-slate-900 border-slate-500/10",emerald:"from-emerald-600/10 to-transparent text-emerald-600 border-emerald-500/10",rose:"from-rose-600/10 to-transparent text-rose-600 border-rose-500/10",amber:"from-amber-600/10 to-transparent text-amber-600 border-amber-500/10"},r={slate:"bg-slate-900 text-indigo-400 shadow-slate-500/40",emerald:"bg-emerald-600 text-white shadow-emerald-500/40",rose:"bg-rose-600 text-white shadow-rose-500/40",amber:"bg-amber-600 text-white shadow-amber-500/40"},l={slate:"from-slate-800 to-slate-900 shadow-slate-900/30",emerald:"from-emerald-600 to-emerald-900 shadow-emerald-600/30",rose:"from-rose-600 to-rose-900 shadow-rose-600/30",amber:"from-amber-500 to-amber-700 shadow-amber-500/30"};return u?e.jsxs("div",{className:`relative overflow-hidden bg-gradient-to-br ${l[d]} p-6 rounded-3xl shadow-xl text-white transform transition-all hover:-translate-y-1 duration-500 group`,children:[e.jsx("div",{className:"absolute -right-10 -top-10 opacity-20 rotate-12 group-hover:rotate-0 transition-transform duration-700",children:A.isValidElement(m)?A.cloneElement(m,{size:120}):null}),e.jsxs("div",{className:"relative z-10 flex flex-col h-full gap-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:`p-3 rounded-2xl backdrop-blur-xl border border-white/20 ${d==="slate"?"bg-indigo-500/20":"bg-white/20"}`,children:A.isValidElement(m)?A.cloneElement(m,{size:20,className:d==="slate"?"text-indigo-400":"text-white"}):null}),a&&e.jsx("span",{className:"text-[9px] font-bold px-3 py-1 bg-white/10 rounded-full backdrop-blur-md uppercase tracking-widest",children:a})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/70 text-[10px] font-bold uppercase tracking-widest mb-1",children:c}),e.jsxs("h4",{className:"text-3xl font-bold tabular-nums tracking-tighter",children:[o?"****":(n||0).toLocaleString()," ",e.jsx("span",{className:"text-sm font-medium opacity-60",children:"ج.م"})]})]})]})]}):e.jsxs("div",{className:`bg-white bg-gradient-to-br ${t[d]} p-6 rounded-3xl shadow-md border border-white relative overflow-hidden group hover:-translate-y-1 transition-all duration-500`,children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-white/40 rounded-full blur-[30px] -mr-12 -mt-12 group-hover:bg-white transition-all duration-700"}),e.jsxs("div",{className:"flex flex-col gap-4 relative z-10",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-all duration-500 group-hover:scale-110 shadow-lg ${r[d]}`,children:A.isValidElement(m)?A.cloneElement(m,{size:22}):null}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2 opacity-70",children:c}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900 tracking-tighter tabular-nums leading-none",children:[o?"****":(n||0).toLocaleString()," ",e.jsx("span",{className:"text-xs font-bold text-slate-400",children:"ج.م"})]}),a&&e.jsx("p",{className:"text-[9px] font-bold text-slate-400 mt-3 bg-white/50 w-fit px-2.5 py-1 rounded-full",children:a})]})]})]})}),Le=A.memo(({title:c,value:n,icon:m,color:a})=>{const d={emerald:"bg-emerald-50 text-emerald-600 border-emerald-100/50 shadow-emerald-500/5",rose:"bg-rose-50 text-rose-600 border-rose-100/50 shadow-rose-500/5",amber:"bg-amber-50 text-amber-600 border-amber-100/50 shadow-amber-500/5",slate:"bg-slate-50 text-slate-900 border-slate-200 shadow-slate-900/5"},u={emerald:"bg-emerald-600",rose:"bg-rose-600",amber:"bg-amber-600",slate:"bg-slate-900"};return e.jsxs("div",{className:`p-6 rounded-3xl border shadow-lg flex items-center justify-between transition-all hover:-translate-y-1 hover:shadow-xl duration-500 ${d[a]}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest opacity-60",children:c}),e.jsxs("p",{className:"text-xl font-bold tracking-tighter",children:[(n||0).toLocaleString()," ",e.jsx("span",{className:"text-xs opacity-50",children:"ج.م"})]})]}),e.jsx("div",{className:`p-3 ${u[a]} ${a==="slate"?"text-indigo-400":"text-white"} rounded-2xl shadow-md`,children:A.isValidElement(m)?A.cloneElement(m,{size:18}):null})]})}),Mt=({stats:c,shouldMaskAggregate:n,fromDate:m,toDate:a,isPrint:d=!1})=>{const u=c||[],o=u.reduce((b,s)=>b+(Number(s?.revenue||0)-Number(s?.cost||0)),0)||0,t=u.reduce((b,s)=>b+Number(s?.revenue||0),0),r=u.reduce((b,s)=>b+Number(s?.cost||0),0),l=u.reduce((b,s)=>b+Number(s?.bookings||0),0);return d?e.jsx("div",{className:"space-y-8 animate-in fade-in duration-500 print:animate-none print:opacity-100 print:transform-none",children:e.jsx("div",{className:"overflow-hidden rounded-2xl border-2 border-slate-900 shadow-sm",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white text-[11px] font-bold uppercase tracking-wider",children:[e.jsx("th",{className:"p-4 text-right border-b border-slate-700",children:"اسم الرحلة المجمعة (Master Trip)"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"التصنيف"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"المعتمرين"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"البرامج"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"إجمالي الإيراد"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"إجمالي التكلفة"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700 bg-slate-800",children:"صافي الربح"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"الهامش"})]})}),e.jsx("tbody",{className:"text-[10px] font-bold divide-y divide-slate-200",children:(u||[]).map((b,s)=>{const i=Number(b?.revenue||0)-Number(b?.cost||0),j=Number(b?.revenue||0)>0?i/Number(b.revenue)*100:0;return e.jsxs("tr",{className:s%2===0?"bg-white":"bg-slate-50/50",children:[e.jsx("td",{className:"p-3 border-x border-slate-200 text-slate-900 font-bold",children:b?.name}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center",children:b?.type}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center",children:Number(b?.bookings||0)}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center",children:(b?.programs||[]).length}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center text-emerald-700",children:n?"****":Number(b?.revenue||0).toLocaleString()}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center text-rose-700",children:n?"****":Number(b?.cost||0).toLocaleString()}),e.jsx("td",{className:`p-3 border-x border-slate-200 text-center font-bold ${i>=0?"bg-emerald-50 text-emerald-800":"bg-rose-50 text-rose-800"}`,children:n?"****":Number(i||0).toLocaleString()}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center font-bold",children:n?"****%":`${Number(j).toFixed(1)}%`})]},s)})}),e.jsx("tfoot",{className:"bg-slate-900 text-white font-bold text-xs",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"p-4 text-right",children:"إجمالي أرباح الرحلات المجمعة"}),e.jsx("td",{className:"p-4 text-center",children:n?"****":t.toLocaleString()}),e.jsx("td",{className:"p-4 text-center",children:n?"****":r.toLocaleString()}),e.jsx("td",{className:"p-4 text-center bg-slate-800 text-emerald-400",children:n?"****":o.toLocaleString()}),e.jsx("td",{className:"p-4 text-center",children:n?"****%":`${Number(o/(t||1)*100).toFixed(1)}%`})]})})]})})}):e.jsx("div",{className:"space-y-8 animate-in zoom-in-95 duration-700 print:animate-none print:opacity-100 print:transform-none",children:e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-indigo-50 rounded-full blur-3xl -mr-32 -mt-32 opacity-40 group-hover:opacity-60 transition-opacity"}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-8 border-b border-slate-50 pb-6 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-indigo-600 to-indigo-800 text-white rounded-2xl flex items-center justify-center shadow-lg shadow-indigo-100 transform group-hover:scale-105 transition-transform duration-500",children:e.jsx(Ne,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"التقرير المجمع للرحلات"}),e.jsxs("p",{className:"text-slate-400 text-[9px] font-bold uppercase tracking-[0.2em] mt-1",children:["Consolidated Trip Performance • ",m," - ",a]})]})]}),e.jsxs("div",{className:"bg-slate-900 text-white px-6 py-4 rounded-2xl shadow-lg transform hover:-translate-y-1 transition-transform duration-500",children:[e.jsx("p",{className:"text-[9px] font-bold uppercase tracking-[0.2em] mb-1 opacity-50",children:"إجمالي صافي الأرباح"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("p",{className:"text-2xl font-bold tabular-nums tracking-tight text-emerald-400",children:n?"****":o.toLocaleString()}),e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase",children:"ج.م"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 relative z-10",children:[e.jsx(Le,{title:"إجمالي الإيرادات",value:n?0:t,icon:e.jsx(ie,{size:18}),color:"emerald"}),e.jsx(Le,{title:"إجمالي التكاليف",value:n?0:r,icon:e.jsx(Ce,{size:18}),color:"rose"}),e.jsx(Le,{title:"إجمالي المعتمرين",value:l,icon:e.jsx(Z,{size:18}),color:"emerald"})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl border border-slate-100 shadow-inner bg-slate-50/30 relative z-10",children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white",children:[e.jsx("th",{className:"px-4 py-4 text-[10px] font-bold uppercase tracking-[0.2em] opacity-60",children:"اسم الرحلة"}),e.jsx("th",{className:"px-4 py-4 text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 text-center",children:"التصنيف"}),e.jsx("th",{className:"px-4 py-4 text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 text-center",children:"الركاب"}),e.jsx("th",{className:"px-4 py-4 text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 text-center",children:"الإيرادات"}),e.jsx("th",{className:"px-4 py-4 text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 text-center",children:"التكاليف"}),e.jsx("th",{className:"px-4 py-4 text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 text-center bg-slate-800",children:"صافي الربح"}),e.jsx("th",{className:"px-4 py-4 text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 text-center",children:"الهامش"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 font-medium bg-white text-xs",children:(u||[]).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-10 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3 opacity-20",children:[e.jsx(Re,{size:48,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-[0.2em] text-slate-400",children:"لا توجد بيانات متاحة"})]})})}):(u||[]).map((b,s)=>{const i=Number(b?.revenue||0)-Number(b?.cost||0),j=Number(b?.revenue||0)>0?i/Number(b.revenue)*100:0;return e.jsxs("tr",{className:"hover:bg-emerald-50/30 transition-all duration-300 group",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900 font-bold text-sm group-hover:text-emerald-600 transition-colors",children:b?.name}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 bg-emerald-50 text-emerald-700 rounded-lg text-[8px] font-bold uppercase tracking-wider border border-emerald-100 shadow-sm",children:b?.type==="HAJJ"?"حج":b?.type==="UMRAH"?"عمرة":"عام"})}),e.jsx("td",{className:"px-4 py-3 text-center text-slate-500 tabular-nums",children:Number(b?.bookings||0)}),e.jsx("td",{className:"px-4 py-3 text-center text-emerald-600 font-bold tabular-nums tracking-tight",children:n?"****":Number(b?.revenue||0).toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-center text-rose-600 font-bold tabular-nums tracking-tight",children:n?"****":Number(b?.cost||0).toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-center bg-slate-50/50",children:e.jsx("div",{className:`inline-flex flex-col items-center px-4 py-1.5 rounded-xl border ${i>=0?"bg-emerald-500/10 border-emerald-500/20 text-emerald-700":"bg-rose-500/10 border-rose-500/20 text-rose-700"}`,children:e.jsx("span",{className:"text-base font-bold tabular-nums tracking-tight",children:n?"****":Number(i||0).toLocaleString()})})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-12 h-1.5 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${i>=0?"bg-emerald-500":"bg-rose-500"}`,style:{width:`${Math.min(Math.max(j,0),100)}%`}})}),e.jsxs("span",{className:`text-[9px] font-bold tabular-nums ${i>=0?"text-emerald-500":"text-rose-500"}`,children:[Number(j).toFixed(1),"%"]})]})})]},s)})})]})})]})})},Qe=A.memo(Mt),Yt=({agingData:c,isHidden:n,isPrint:m=!1})=>{const a=(d,u,o,t,r)=>{const l=r==="customer",b=l?"bg-slate-900":"bg-rose-900";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 px-2",children:[e.jsx("div",{className:`w-10 h-10 ${l?"bg-indigo-600":"bg-rose-600"} text-white rounded-2xl flex items-center justify-center shadow-lg`,children:o}),e.jsx("h4",{className:"text-xl font-bold text-slate-900 tracking-tight",children:u})]}),e.jsx("div",{className:`overflow-hidden ${m?"rounded-xl border border-slate-200":"rounded-3xl border border-white bg-white shadow-sm"}`,children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`${b} text-white`,children:[e.jsx("th",{className:"p-4 font-bold text-[10px] uppercase tracking-widest border-b border-white/10",children:l?"اسم العميل":"اسم المورد"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-white/10 bg-emerald-600/20",children:"حالي (0-30)"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-white/10 bg-amber-500/20",children:"31-60 يوم"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-white/10 bg-orange-600/20",children:"61-90 يوم"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-white/10 bg-rose-700/20",children:"أكثر من 90"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-white/10 bg-white/10",children:"الإجمالي"})]})}),e.jsx("tbody",{className:`divide-y divide-slate-50 font-medium ${m?"text-[9px]":"text-xs"}`,children:(d||[]).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-8 text-center text-slate-400 italic font-medium",children:"لا توجد بيانات متاحة لهذا القسم حالياً"})}):(d||[]).map((s,i)=>e.jsxs("tr",{className:`${m?i%2===0?"bg-white":"bg-slate-50/50":"hover:bg-slate-50/50 transition-all group"}`,children:[e.jsxs("td",{className:"p-4",children:[e.jsx("p",{className:"text-slate-900 font-bold group-hover:text-indigo-600 transition-colors text-sm",children:l?s?.name:s?.company||s?.name}),!m&&e.jsx("p",{className:"text-[9px] text-slate-400 font-bold uppercase mt-0.5 tracking-widest opacity-60 italic",children:l?"Verified Client":"Active Supplier"})]}),e.jsx("td",{className:"p-4 text-center text-emerald-600 font-bold text-base tabular-nums bg-emerald-50/5",children:n?"****":(s?.current||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center text-amber-600 font-bold text-base tabular-nums bg-amber-50/5",children:n?"****":(s?.[30]||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center text-orange-600 font-bold text-base tabular-nums bg-orange-50/5",children:n?"****":(s?.[60]||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center text-rose-700 font-bold text-base tabular-nums bg-rose-50/5",children:n?"****":(s?.over90||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center font-bold text-lg tabular-nums bg-slate-50/30 text-slate-900",children:n?"****":(s?.total||0).toLocaleString()})]},i))})]})})]})};return m?e.jsxs("div",{className:"space-y-12 animate-in fade-in duration-500 print:animate-none print:opacity-100 print:transform-none",children:[a(c?.customers||[],"تحليل أعمار ديون العملاء",e.jsx(Z,{size:28}),"indigo","customer"),a(c?.suppliers||[],"تحليل مستحقات الموردين",e.jsx(se,{size:28}),"rose","supplier")]}):e.jsxs("div",{className:"space-y-16 animate-in fade-in slide-in-from-bottom-4 duration-700 print:animate-none print:opacity-100 print:transform-none",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white p-6 rounded-3xl shadow-md border border-white relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 top-0 w-64 h-64 bg-indigo-50 rounded-full blur-[100px] -mr-32 -mt-32 opacity-60"}),e.jsxs("div",{className:"flex items-center gap-6 relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-indigo-600 text-white rounded-2xl flex items-center justify-center shadow-xl shadow-indigo-200 transform group-hover:scale-110 transition-transform duration-500",children:e.jsx(Tt,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight mb-1",children:"تقرير أعمار الديون"}),e.jsxs("p",{className:"text-indigo-400 font-bold uppercase tracking-[0.2em] text-[9px] opacity-70 flex items-center gap-2",children:[e.jsx(T,{size:12})," Aging Analysis Report • Debt Recovery Insights"]})]})]}),e.jsx("div",{className:"flex gap-4 relative z-10",children:e.jsxs("div",{className:"bg-indigo-50/50 px-6 py-4 rounded-2xl border border-indigo-100/50 text-center",children:[e.jsx("p",{className:"text-[9px] font-bold text-indigo-400 uppercase tracking-[0.2em] mb-1 opacity-60",children:"إجمالي المستحقات"}),e.jsxs("p",{className:"text-2xl font-bold text-indigo-600 tabular-nums tracking-tight",children:[n?"****":((c?.customers||[]).reduce((d,u)=>d+(u?.total||0),0)+(c?.suppliers||[]).reduce((d,u)=>d+(u?.total||0),0)).toLocaleString()," ",e.jsx("span",{className:"text-xs font-bold opacity-40",children:"ج.م"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-12",children:[a(c?.customers||[],"مديونيات العملاء المتأخرة",e.jsx(Z,{size:20}),"indigo","customer"),a(c?.suppliers||[],"مستحقات الموردين المتأخرة",e.jsx(se,{size:20}),"rose","supplier")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-emerald-50/50 p-6 rounded-3xl border border-emerald-100 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-500 text-white rounded-xl flex items-center justify-center shadow-lg shadow-emerald-200",children:e.jsx(mt,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-bold text-emerald-600 uppercase tracking-widest",children:"ديون مستقرة"}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:"0-30 يوم"})]})]}),e.jsxs("div",{className:"bg-amber-50/50 p-6 rounded-3xl border border-amber-100 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-500 text-white rounded-xl flex items-center justify-center shadow-lg shadow-amber-200",children:e.jsx(pt,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-bold text-amber-600 uppercase tracking-widest",children:"تحتاج متابعة"}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:"31-90 يوم"})]})]}),e.jsxs("div",{className:"bg-rose-50/50 p-6 rounded-3xl border border-rose-100 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-rose-500 text-white rounded-xl flex items-center justify-center shadow-lg shadow-rose-200",children:e.jsx(It,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-bold text-rose-600 uppercase tracking-widest",children:"ديون حرجة"}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:"+90 يوم"})]})]})]})]})},Ze=A.memo(Yt),Gt=({analyticsData:c,filteredTx:n,shouldMaskAggregate:m,fromDate:a,toDate:d,setActiveReport:u,setSelectedId:o,isPrint:t=!1})=>{const r=c?.employeePerf||[],l=r.reduce((s,i)=>s+i.commission,0),b=r.reduce((s,i)=>s+i.volume,0);return t?e.jsx("div",{className:"space-y-8 animate-in fade-in duration-500 print:animate-none print:opacity-100 print:transform-none",children:e.jsx("div",{className:"overflow-hidden rounded-2xl border-2 border-slate-900 shadow-sm",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white text-[11px] font-bold uppercase tracking-wider",children:[e.jsx("th",{className:"p-4 text-right border-b border-slate-700",children:"اسم الموظف"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"حجم المبيعات"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"العمولة المستحقة"}),e.jsx("th",{className:"p-4 text-center border-b border-slate-700",children:"عدد العمليات"})]})}),e.jsx("tbody",{className:"text-[10px] font-bold divide-y divide-slate-200",children:r.map((s,i)=>e.jsxs("tr",{className:i%2===0?"bg-white":"bg-slate-50/50",children:[e.jsx("td",{className:"p-3 border-x border-slate-200 text-slate-900 font-bold",children:s.name}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center",children:m?"****":(s.volume||0).toLocaleString()}),e.jsx("td",{className:"p-3 border-x border-slate-200 text-center text-amber-700 font-bold",children:m?"****":(s.commission||0).toLocaleString()}),e.jsxs("td",{className:"p-3 border-x border-slate-200 text-center",children:[(n||[]).filter(j=>j?.employeeId===s?.id).length," عملية"]})]},i))}),e.jsx("tfoot",{className:"bg-slate-900 text-white font-bold text-xs",children:e.jsxs("tr",{children:[e.jsx("td",{className:"p-4 text-right",children:"إجمالي العمولات المستحقة"}),e.jsx("td",{className:"p-4 text-center",children:m?"****":(b||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center text-amber-400",children:m?"****":(l||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center",children:"-"})]})})]})})}):e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white p-6 rounded-3xl shadow-sm border border-white relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 top-0 w-64 h-64 bg-amber-50 rounded-full blur-[100px] -mr-32 -mt-32 opacity-60"}),e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-500 text-white rounded-2xl flex items-center justify-center shadow-lg shadow-amber-200 transform group-hover:scale-110 transition-transform duration-500",children:e.jsx(it,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight mb-1",children:"عمولات الموظفين"}),e.jsxs("p",{className:"text-amber-600 font-bold uppercase tracking-[0.2em] text-[9px] opacity-70 flex items-center gap-2",children:[e.jsx(T,{size:12})," Sales Performance & Commissions Analysis"]})]})]}),e.jsx("div",{className:"flex gap-4 relative z-10",children:e.jsxs("div",{className:"bg-amber-50 px-6 py-4 rounded-2xl border border-amber-100 text-center",children:[e.jsx("p",{className:"text-[9px] font-bold text-amber-600 uppercase tracking-[0.2em] mb-1 opacity-60",children:"إجمالي العمولات المستحقة"}),e.jsxs("p",{className:"text-2xl font-bold text-amber-600 tabular-nums tracking-tight",children:[m?"****":l.toLocaleString()," ",e.jsx("span",{className:"text-xs font-bold opacity-40",children:"ج.م"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-indigo-900 p-6 rounded-3xl text-white shadow-lg relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 bottom-0 opacity-10 transform translate-x-10 translate-y-10 group-hover:translate-x-0 group-hover:translate-y-0 transition-transform duration-700",children:e.jsx(ne,{size:120})}),e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 mb-2",children:"إجمالي حجم المبيعات"}),e.jsxs("p",{className:"text-3xl font-bold tabular-nums",children:[m?"****":b.toLocaleString(),e.jsx("span",{className:"text-sm font-medium opacity-40 mr-2",children:"ج.م"})]})]}),e.jsxs("div",{className:"bg-emerald-900 p-6 rounded-3xl text-white shadow-lg relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 bottom-0 opacity-10 transform translate-x-10 translate-y-10 group-hover:translate-x-0 group-hover:translate-y-0 transition-transform duration-700",children:e.jsx(ke,{size:120})}),e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 mb-2",children:"متوسط عمولة الموظف"}),e.jsxs("p",{className:"text-3xl font-bold tabular-nums",children:[m?"****":Math.round(l/(r.length||1)).toLocaleString(),e.jsx("span",{className:"text-sm font-medium opacity-40 mr-2",children:"ج.م"})]})]})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl border border-white bg-white shadow-sm",children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white",children:[e.jsx("th",{className:"p-4 font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"اسم الموظف"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"حجم المبيعات (حسب الصرف)"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800 bg-amber-600/20",children:"العمولة المستحقة"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"عدد العمليات"}),e.jsx("th",{className:"p-4 text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800",children:"الإجراءات"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 font-medium text-xs",children:(r||[]).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-10 text-center text-slate-400 italic font-medium",children:"لا توجد بيانات عمولات متاحة"})}):(r||[]).map((s,i)=>{const j=(n||[]).filter(w=>w?.employeeId===s?.id).length;return e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-all group",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center text-slate-400 group-hover:bg-amber-500 group-hover:text-white transition-all duration-500",children:e.jsx(de,{size:14})}),e.jsx("p",{className:"text-slate-900 font-bold text-sm group-hover:text-amber-600 transition-colors",children:s.name})]})}),e.jsx("td",{className:"p-4 text-center text-slate-600 font-bold text-base tabular-nums",children:m?"****":(s.volume||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center text-amber-700 bg-amber-50/30 font-bold text-lg tabular-nums",children:m?"****":(s.commission||0).toLocaleString()}),e.jsx("td",{className:"p-4 text-center text-slate-400",children:e.jsxs("span",{className:"bg-slate-100 px-3 py-1 rounded-full text-[9px] font-bold text-slate-500 uppercase tracking-widest",children:[j," عملية"]})}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("button",{onClick:()=>{u("EMPLOYEE_LEDGER"),o(s.id)},className:"bg-indigo-50 text-indigo-600 hover:bg-indigo-600 hover:text-white px-4 py-2 rounded-xl flex items-center gap-2 justify-center mx-auto transition-all duration-500 font-bold text-[9px] uppercase tracking-widest active:scale-95 shadow-sm",children:[e.jsx(lt,{size:12})," كشف الحساب"]})})]},i)})})]})})]})},et=A.memo(Gt),Ft=({auditLogs:c,fromDate:n,toDate:m,searchTerm:a,isPrint:d=!1})=>{const{t:u}=nt(),o=(c||[]).filter(t=>t&&t.timestamp&&t.timestamp>=n&&t.timestamp<=m).filter(t=>!a||(t.details||"").toLowerCase().includes(a.toLowerCase())||(t.userName||"").toLowerCase().includes(a.toLowerCase())||(t.action||"").toLowerCase().includes(a.toLowerCase())).sort((t,r)=>(r.timestamp||"").localeCompare(t.timestamp||""));return e.jsxs("div",{className:`space-y-8 ${d?"":"animate-in fade-in slide-in-from-bottom-4 duration-700"}`,children:[!d&&e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white p-6 rounded-3xl shadow-sm border border-slate-100 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-50 rounded-full blur-3xl -mr-16 -mt-16 opacity-50 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-indigo-600 to-indigo-800 text-white rounded-2xl flex items-center justify-center shadow-lg shadow-indigo-200 transform group-hover:rotate-6 transition-transform duration-500",children:e.jsx(T,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:u("audit_trail")}),e.jsxs("p",{className:"text-slate-400 text-[9px] font-bold uppercase tracking-[0.2em] mt-0.5",children:[u("system_activity_monitor")," • ",n," - ",m]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-slate-900 text-white px-6 py-3 rounded-2xl shadow-lg relative z-10",children:[e.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs font-bold tabular-nums",children:o.length}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest opacity-60",children:u("recorded_actions")})]})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-500 ${d?"rounded-xl border border-slate-200":"rounded-3xl bg-white border border-slate-100 shadow-sm"}`,children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white",children:[e.jsx("th",{className:"px-6 py-4 text-right text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 border-b border-white/5",children:u("timestamp")}),e.jsx("th",{className:"px-6 py-4 text-right text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 border-b border-white/5",children:u("operator")}),e.jsx("th",{className:"px-6 py-4 text-right text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 border-b border-white/5",children:u("event_type")}),e.jsx("th",{className:"px-6 py-4 text-right text-[10px] font-bold uppercase tracking-[0.2em] opacity-60 border-b border-white/5",children:u("detailed_log")})]})}),e.jsx("tbody",{className:"text-[11px] font-medium bg-white",children:o.length>0?o.map((t,r)=>e.jsxs("tr",{className:"hover:bg-slate-50/80 transition-all duration-300 group border-b border-slate-50 last:border-0",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-900 tabular-nums",children:(t.timestamp||"").split(" ")[0]}),e.jsx("span",{className:"text-[9px] text-slate-400 font-medium tabular-nums",children:(t.timestamp||"").split(" ")[1]||""})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-gradient-to-br from-slate-100 to-slate-200 text-slate-600 flex items-center justify-center text-[10px] font-bold shadow-inner border border-white group-hover:scale-110 transition-transform duration-500",children:t.userName?.charAt(0)||"U"}),e.jsx("span",{className:"font-bold text-slate-900 tracking-tight",children:t.userName||"-"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1.5 rounded-lg text-[8px] font-bold uppercase tracking-wider shadow-sm border ${(t.action||"").includes("حذف")||(t.action||"").includes("DELETE")?"bg-rose-500/10 text-rose-700 border-rose-200/30":(t.action||"").includes("تعديل")||(t.action||"").includes("UPDATE")?"bg-amber-500/10 text-amber-700 border-amber-200/30":"bg-emerald-500/10 text-emerald-700 border-emerald-200/30"}`,children:t.action||"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-slate-600 font-medium leading-relaxed max-w-xl group-hover:text-slate-900 transition-colors",children:t.details||"-"})})]},r)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-10 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3 opacity-20",children:[e.jsx(T,{size:48,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-[0.2em] text-slate-400",children:u("no_logs_found")})]})})})})]})})]})},tt=A.memo(Ft),Vt=({transactions:c,treasuries:n,fromDate:m,toDate:a,isPrint:d,baseCurrency:u="EGP"})=>{const o=(c||[]).filter(s=>s&&!s.isVoided&&s.type==="TRANSFER"&&(s.date||"")>=m&&(s.date||"")<=a).sort((s,i)=>new Date(i.date||0).getTime()-new Date(s.date||0).getTime()),t=s=>(n||[]).find(i=>i&&i.id===s)?.name||"غير معروف",r=o.reduce((s,i)=>s+(i.amount||0),0),l=o.reduce((s,i)=>{if(!i)return s;const j=`${i.treasuryId}-${i.targetEntityId}`;return s[j]||(s[j]={from:i.treasuryId,to:i.targetEntityId,amount:0,count:0}),s[j].amount+=i.amount||0,s[j].count+=1,s},{}),b=Object.values(l).sort((s,i)=>i.amount-s.amount);return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[!d&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-indigo-50 text-indigo-600 rounded-xl flex items-center justify-center",children:e.jsx(le,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"إجمالي التحويلات"}),e.jsxs("p",{className:"text-xl font-bold text-slate-900",children:[r.toLocaleString()," ",e.jsx("span",{className:"text-xs opacity-50",children:u})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-50 text-emerald-600 rounded-xl flex items-center justify-center",children:e.jsx(bt,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"عدد العمليات"}),e.jsxs("p",{className:"text-xl font-bold text-slate-900",children:[o.length," عملية"]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-amber-50 text-amber-600 rounded-xl flex items-center justify-center",children:e.jsx(ge,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"الفترة الزمنية"}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:["من ",m," إلى ",a]})]})]})]}),e.jsx("div",{className:`${d?"":"bg-white rounded-3xl border border-slate-200 overflow-hidden shadow-sm"}`,children:e.jsxs("table",{className:"w-full text-right",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`${d?"bg-slate-900 text-white":"bg-slate-50 text-slate-600"} border-b border-slate-200`,children:[e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase tracking-widest",children:"التاريخ"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase tracking-widest",children:"من خزينة"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase tracking-widest text-center"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase tracking-widest",children:"إلى خزينة"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase tracking-widest",children:"المبلغ"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase tracking-widest",children:"البيان والتفاصيل"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:o.length>0?o.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-xs font-bold text-slate-900",children:s.date||"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-bold text-slate-700",children:t(s.treasuryId)})]})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(le,{size:14,className:"text-indigo-400 mx-auto"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{size:14,className:"text-emerald-400"}),e.jsx("span",{className:"text-xs font-bold text-slate-700",children:t(s.targetEntityId)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"text-xs font-black text-slate-900",children:[(s.amount||0).toLocaleString()," ",e.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:s.currencyCode||u})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-[11px] font-bold text-slate-500 leading-relaxed",children:s.description||"-"})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-20 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center text-slate-200",children:e.jsx(le,{size:32})}),e.jsx("p",{className:"text-slate-400 font-bold text-sm",children:"لا توجد عمليات تحويل بين الخزائن في هذه الفترة"})]})})})}),o.length>0&&e.jsx("tfoot",{className:"border-t-2 border-slate-900",children:e.jsxs("tr",{className:"bg-slate-50 font-black",children:[e.jsx("td",{colSpan:4,className:"px-6 py-4 text-xs text-slate-900 text-left",children:"إجمالي المبالغ المحولة:"}),e.jsxs("td",{className:"px-6 py-4 text-sm text-indigo-600 font-bold",children:[r.toLocaleString()," ",u]}),e.jsx("td",{})]})})]})}),o.length>0&&e.jsxs("div",{className:`mt-8 ${d?"border-t-2 border-slate-100 pt-8":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("div",{className:"w-8 h-8 bg-indigo-50 text-indigo-600 rounded-lg flex items-center justify-center",children:e.jsx(le,{size:16})}),e.jsx("h3",{className:"text-sm font-black text-slate-900",children:"ملخص التحويلات حسب المسار"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map((s,i)=>e.jsxs("div",{className:`${d?"bg-white border-2 border-slate-100":"bg-slate-50 border border-slate-200"} p-5 rounded-2xl transition-all hover:shadow-md`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[11px] font-black text-slate-600 bg-slate-100 px-2 py-1 rounded-md",children:t(s.from)}),e.jsx(Fe,{size:12,className:"text-indigo-400"}),e.jsx("span",{className:"text-[11px] font-black text-indigo-600 bg-indigo-50 px-2 py-1 rounded-md",children:t(s.to)})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter",children:"العمليات"}),e.jsx("span",{className:"text-xs font-black text-slate-700",children:s.count})]})]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-xl font-black text-slate-900",children:s.amount.toLocaleString()}),e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:u})]})]},i))})]})]})},Bt=({activeReport:c,selectedId:n,ledgerEntries:m,openingBalance:a,fromDate:d,toDate:u,isHidden:o,shouldMaskAggregate:t,customers:r,suppliers:l,employees:b,partners:s,treasuries:i,currencies:j,costCenters:w=[],masterTrips:I=[],programs:Y=[],isPrint:g=!1,onTransactionClick:X,baseCurrency:J="EGP",onUpdateTransaction:pe,onUpdateJournalEntry:ve,onVoidTransaction:be,onDeleteJournalEntry:we,transactions:ae=[],journalEntries:h=[]})=>{const[L,G]=S.useState(null),[_,V]=S.useState(null),[F,B]=S.useState({amount:0,description:""}),he=f=>{if(!f)return;const y=(ae||[]).find(N=>N?.id===f.id||N?.journalEntryId===f.id),p=(h||[]).find(N=>N?.id===f.id);V({...f,originalTx:y,originalJv:p}),B({amount:f.debit||f.credit||0,description:f.description||""})},q=()=>{if(_){if(_.originalTx)pe?.(_.originalTx.id,{amount:F.amount,description:F.description});else if(_.originalJv){const f=_.originalJv,y=[...f?.lines||[]],p=y.findIndex(N=>N?.accountId===n);if(p!==-1){const N=(y[p]?.debit||0)>0,v=y[p]?.exchangeRate||1,R=(F.amount||0)*v;if(N?y[p].debit=R:y[p].credit=R,y[p].originalAmount=F.amount,y.length===2){const P=p===0?1:0;if(y[P])if(N?y[P].credit=R:y[P].debit=R,y[P].currencyCode===y[p].currencyCode)y[P].originalAmount=F.amount;else{const ce=y[P].exchangeRate||1;y[P].originalAmount=R/ce}}}ve?.(f.id,{description:F.description,lines:y})}V(null)}},oe=f=>{navigator.clipboard.writeText(f),G(f),setTimeout(()=>G(null),2e3)};if(!n)return null;const k=c==="TREASURY_REPORT",ue=c==="CUSTOMER_LEDGER",C=c==="EMPLOYEE_LEDGER",je=c==="EMPLOYEE_ADVANCE",ee=c==="PARTNER_LEDGER",W=()=>{let f=0,y=J,p="",N="indigo",v=e.jsx(T,{size:24});if(k){const U=(i||[]).find(M=>M?.id===n);if(!U)return null;const O=(m||[])[(m||[]).length-1];f=O?O.runningBalance:a,y=J,U.type==="CUSTODY"?p=f>=0?"رصيد العهدة المتاح":"عجز في العهدة (مطلوب تسويته)":p=f>=0?"الخزينة في حالة وفرة":"عجز / سحب على المكشوف",N=f>=0?"emerald":"rose",v=f>=0?e.jsx(T,{size:24}):e.jsx(te,{size:24})}else{const U=ue?(r||[]).find(M=>M?.id===n):C||je?(b||[]).find(M=>M?.id===n):ee?(s||[]).find(M=>M?.id===n):(l||[]).find(M=>M?.id===n);if(!U)return null;y=U.openingBalanceCurrency||J;const O=(m||[])[(m||[]).length-1];f=O?O.runningBalance:a,ue?f>0?(p="إجمالي المديونية المستحقة (عليه للمؤسسة)",N="rose",v=e.jsx(me,{size:24})):f<0?(p="إجمالي الرصيد الدائن (له طرفنا)",N="emerald",v=e.jsx(te,{size:24})):(p="الحساب متزن (رصيد صفري)",N="slate",v=e.jsx(T,{size:24})):C?f>0?(p="إجمالي العمولات والمستحقات (له علينا)",N="rose",v=e.jsx(me,{size:24})):f<0?(p="إجمالي الرصيد المدين (عليه لنا)",N="emerald",v=e.jsx(te,{size:24})):(p="تم تسوية كافة المستحقات",N="slate",v=e.jsx(T,{size:24})):je?f>0?(p="إجمالي سلف الموظف المستحقة (عليه لنا)",N="rose",v=e.jsx(me,{size:24})):f<0?(p="إجمالي فائض تسديد السلف (له عندنا)",N="emerald",v=e.jsx(te,{size:24})):(p="تم تسديد كافة السلف",N="slate",v=e.jsx(T,{size:24})):f>0?(p="إجمالي المستحقات للمورد (له علينا)",N="rose",v=e.jsx(me,{size:24})):f<0?(p="إجمالي الرصيد المدين للمورد (عليه لنا)",N="emerald",v=e.jsx(te,{size:24})):(p="الحساب متزن (رصيد صفري)",N="slate",v=e.jsx(T,{size:24}))}const R=(j||[]).find(U=>U?.code===y)?.symbol||y,P={emerald:"bg-emerald-50 border-emerald-100 text-emerald-700",rose:"bg-rose-50 border-rose-100 text-rose-700",slate:"bg-slate-50 border-slate-200 text-slate-600",indigo:"bg-indigo-50 border-indigo-100 text-indigo-700"},ce={emerald:"bg-emerald-500",rose:"bg-rose-500",slate:"bg-slate-500",indigo:"bg-indigo-500"};return g?e.jsxs("div",{className:`mt-4 p-4 rounded-2xl border-2 flex justify-between items-center ${P[N]}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[9px] font-bold uppercase tracking-widest opacity-70",children:"الرصيد الختامي للفترة"}),e.jsx("p",{className:"text-sm font-bold",children:p})]}),e.jsx("div",{className:"text-left",children:e.jsxs("p",{className:"text-xl font-bold",children:[o?"****":Math.abs(f||0).toLocaleString()||"0"," ",e.jsx("span",{className:"text-[10px] font-bold",children:R})]})})]}):e.jsxs("div",{className:`mt-6 p-4 rounded-3xl border shadow-sm flex flex-col md:flex-row justify-between items-center gap-4 transition-all hover:shadow-md duration-500 ${P[N]}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 ${ce[N]} text-white rounded-xl flex items-center justify-center shadow-md`,children:A.cloneElement(v,{size:18})}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"text-[9px] font-bold uppercase tracking-widest opacity-60",children:"الرصيد الختامي للفترة المحددة"}),e.jsx("p",{className:"text-lg font-bold tracking-tight",children:p})]})]}),e.jsx("div",{className:"text-left bg-white/50 px-4 py-2 rounded-xl border border-white/50",children:e.jsxs("p",{className:"text-2xl font-bold tabular-nums tracking-tighter",children:[o?"****":Math.abs(f||0).toLocaleString()||"0",e.jsx("span",{className:"text-xs font-bold opacity-40 mr-2",children:R})]})})]})},ye=(m||[]).length>0?(m||[])[(m||[]).length-1].runningBalance:a,K=(f,y)=>{if(y){const p=(Y||[]).find(N=>N.id===y);if(p)return{name:p.name,type:"PROGRAM"}}if(f){const p=(I||[]).find(v=>v.id===f);if(p)return{name:p.name,type:"TRIP"};const N=(w||[]).find(v=>v.id===f);if(N)return{name:N.name,type:"COST_CENTER"}}return null};if(k){const f=(i||[]).find(p=>p.id===n),y=f?.type==="CUSTODY";return e.jsxs("div",{className:`space-y-6 ${g?"":"animate-in fade-in slide-in-from-bottom-4 duration-700"} print:animate-none print:opacity-100 print:transform-none`,children:[!g&&e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white p-6 rounded-3xl shadow-sm border border-slate-200 relative overflow-hidden group",children:[e.jsx("div",{className:`absolute right-0 top-0 w-32 h-32 ${y?"bg-indigo-50":"bg-amber-50"} rounded-full blur-[60px] -mr-16 -mt-16 opacity-60`}),e.jsxs("div",{className:"flex items-center gap-6 relative z-10",children:[e.jsx("div",{className:`w-16 h-16 ${y?"bg-indigo-600":"bg-amber-500"} text-white rounded-2xl flex items-center justify-center shadow-lg transform group-hover:scale-105 transition-transform duration-500`,children:y?e.jsx(Me,{size:28}):e.jsx(re,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight mb-1",children:y?`حركة العهدة: ${f?.name}`:"حركة الخزينة والمصارف"}),e.jsxs("p",{className:`${y?"text-indigo-600":"text-amber-600"} font-bold uppercase tracking-widest text-[9px] opacity-70 flex items-center gap-2`,children:[e.jsx(T,{size:12})," ",y?"Employee Custody Statement":"Cash & Bank Flow Statement"]})]})]}),e.jsxs("div",{className:`text-left ${y?"bg-indigo-50/50":"bg-amber-50/50"} px-6 py-4 rounded-2xl border ${y?"border-indigo-100/50":"border-amber-100/50"} relative z-10`,children:[e.jsx("p",{className:`text-[9px] font-bold ${y?"text-indigo-600":"text-amber-600"} uppercase tracking-widest mb-1 opacity-60`,children:"الرصيد النهائي حالياً"}),e.jsxs("p",{className:`text-3xl font-bold ${y?"text-indigo-600":"text-amber-600"} tabular-nums tracking-tighter`,children:[t?"****":ye.toLocaleString()," ",e.jsx("span",{className:"text-sm font-bold opacity-40",children:J})]})]})]}),e.jsx("div",{className:`overflow-hidden ${g?"rounded-2xl border-2 border-slate-900":"rounded-3xl border border-slate-200 bg-white shadow-sm"}`,children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white",children:[e.jsx("th",{className:`${g?"p-2":"p-4"} font-bold text-[10px] uppercase tracking-widest border-b border-slate-800`,children:"التاريخ"}),e.jsx("th",{className:`${g?"p-2":"p-4"} font-bold text-[10px] uppercase tracking-widest border-b border-slate-800`,children:"تفاصيل العملية"}),e.jsx("th",{className:`${g?"p-2":"p-4"} text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800`,children:"وارد (+)"}),e.jsx("th",{className:`${g?"p-2":"p-4"} text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800`,children:"صادر (-)"}),e.jsx("th",{className:`${g?"p-2":"p-4"} text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800 bg-slate-900`,children:"الرصيد التراكمي"}),!g&&e.jsx("th",{className:"p-4 border-b border-slate-800"})]})}),e.jsxs("tbody",{className:`divide-y divide-slate-50 font-bold ${g?"text-[10px]":"text-sm"}`,children:[e.jsxs("tr",{className:"bg-indigo-50/30",children:[e.jsx("td",{className:`p-2 text-slate-400 font-medium italic ${g?"text-[9px]":""}`,children:d}),e.jsxs("td",{className:"p-2 text-slate-900 font-bold italic flex items-center gap-3",children:[e.jsx("div",{className:`${g?"w-6 h-6":"w-8 h-8"} bg-white rounded-lg flex items-center justify-center shadow-sm`,children:e.jsx(le,{size:g?10:14,className:"text-indigo-400"})}),"رصيد ما قبل الفترة (منقول)"]}),e.jsx("td",{className:"p-2 text-center text-slate-300",children:"---"}),e.jsx("td",{className:"p-2 text-center text-slate-300",children:"---"}),e.jsx("td",{className:`p-2 text-center text-indigo-900 font-bold bg-indigo-50/50 tabular-nums ${g?"text-[10px]":"text-base"}`,children:t?"****":(a||0).toLocaleString()}),!g&&e.jsx("td",{})]}),(m||[]).map((p,N)=>_?.id===p.id?e.jsxs("tr",{className:"bg-indigo-50 animate-in slide-in-from-right-2 duration-300",children:[e.jsx("td",{className:"p-2 text-slate-400 font-medium",children:p.date}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"text",className:"w-full p-2 rounded-xl border-2 border-indigo-200 focus:border-indigo-500 outline-none text-sm font-bold",value:F.description,onChange:R=>B({...F,description:R.target.value}),autoFocus:!0})}),e.jsx("td",{className:"p-2",colSpan:2,children:e.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[e.jsx("input",{type:"number",className:"w-32 p-2 rounded-xl border-2 border-indigo-200 focus:border-indigo-500 outline-none text-sm font-bold text-center",value:F.amount,onChange:R=>B({...F,amount:Number(R.target.value)})}),e.jsx("span",{className:"text-[10px] text-slate-400 font-bold",children:"ج.م"})]})}),e.jsx("td",{className:"p-2 text-center text-indigo-900 font-bold tabular-nums",children:t?"****":p.runningBalance.toLocaleString()}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:q,className:"p-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 shadow-sm transition-all transform active:scale-95",title:"حفظ التعديلات",children:e.jsx(Ye,{size:16})}),e.jsx("button",{onClick:()=>V(null),className:"p-2 bg-slate-200 text-slate-600 rounded-xl hover:bg-slate-300 transition-all transform active:scale-95",title:"إلغاء",children:e.jsx(xe,{size:16})})]})})]},N):e.jsxs("tr",{className:`${g?N%2===0?"bg-white":"bg-slate-50/50":"hover:bg-slate-50/50 transition-all group"}`,children:[e.jsx("td",{className:`p-2 text-slate-400 font-medium ${g?"text-[9px]":""}`,children:p.date}),e.jsxs("td",{className:"p-2",children:[e.jsx("p",{className:`text-slate-900 font-bold ${g?"text-[9px] leading-tight":"text-sm"}`,children:p.description}),K(p.costCenterId,p.programId)&&e.jsxs("div",{className:"flex items-center gap-1.5 mt-1",children:[K(p.costCenterId,p.programId)?.type==="PROGRAM"?e.jsx(Re,{size:10,className:"text-indigo-400"}):e.jsx(Ne,{size:10,className:"text-indigo-400"}),e.jsx("span",{className:"text-[10px] font-bold text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded-md border border-indigo-100",children:K(p.costCenterId,p.programId)?.name})]}),!g&&e.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[e.jsx("span",{className:`text-[8px] px-2 py-0.5 rounded-full font-bold uppercase tracking-tighter ${p.debit>0?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:p.debit>0?"سند قبض / توريد":"سند صرف / مدفوعات"}),p.refNo&&e.jsxs("button",{onClick:R=>{R.stopPropagation(),oe(p.refNo)},className:`flex items-center gap-2 px-2 py-0.5 rounded-md border transition-all duration-300 ${L===p.refNo?"bg-emerald-500 text-white border-emerald-500 shadow-sm":"bg-indigo-50 text-indigo-500 border-indigo-100 hover:bg-indigo-600 hover:text-white hover:border-indigo-600"}`,title:"انقر لنسخ رقم المرجع للبحث",children:[L===p.refNo?e.jsx(zt,{size:8}):e.jsx(ht,{size:8}),e.jsx("span",{className:"text-[9px] font-bold",children:L===p.refNo?"تم النسخ":`REF: ${p.refNo}`})]})]})]}),e.jsx("td",{className:`p-2 text-center text-emerald-600 font-bold tabular-nums ${g?"text-[10px]":"text-base"}`,children:p.debit>0?t?"****":(p.debit||0).toLocaleString():e.jsx("span",{className:"text-slate-200",children:"-"})}),e.jsx("td",{className:`p-2 text-center text-rose-600 font-bold tabular-nums ${g?"text-[10px]":"text-base"}`,children:p.credit>0?t?"****":(p.credit||0).toLocaleString():e.jsx("span",{className:"text-slate-200",children:"-"})}),e.jsx("td",{className:`p-2 text-center font-bold tabular-nums ${g?"text-[10px]":"text-base"} ${p.runningBalance>=0?"bg-emerald-50/30 text-emerald-700":"bg-rose-50/30 text-rose-700"}`,children:t?"****":(p.runningBalance||0).toLocaleString()}),!g&&e.jsxs("td",{className:"p-2 text-center opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>he(p),className:"p-2 bg-indigo-50 text-indigo-600 rounded-xl hover:bg-indigo-600 hover:text-white transition-all shadow-sm transform active:scale-95",title:"تعديل سريع",children:e.jsx(Ge,{size:14})}),e.jsx("button",{onClick:()=>{const R=(ae||[]).find(P=>P?.id===p?.id||P?.journalEntryId===p?.id&&P?.category!=="JOURNAL_ENTRY");R?be?.(R.id):we?.(p?.id)},className:"p-2 bg-rose-50 text-rose-600 rounded-xl hover:bg-rose-600 hover:text-white transition-all shadow-sm transform active:scale-95",title:"إلغاء / حذف العملية",children:e.jsx(xe,{size:14})})]})]},N))]})]})}),W()]})}return e.jsxs("div",{className:`space-y-6 ${g?"":"animate-in fade-in slide-in-from-bottom-4 duration-700"} print:animate-none print:opacity-100 print:transform-none`,children:[!g&&e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white p-6 rounded-3xl shadow-sm border border-slate-200 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 top-0 w-32 h-32 bg-indigo-50 rounded-full blur-[60px] -mr-16 -mt-16 opacity-60"}),e.jsxs("div",{className:"flex items-center gap-6 relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-indigo-600 text-white rounded-2xl flex items-center justify-center shadow-lg transform group-hover:scale-105 transition-transform duration-500",children:e.jsx(Me,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight mb-1",children:"كشف الحساب التفصيلي"}),e.jsxs("p",{className:"text-indigo-400 font-bold uppercase tracking-widest text-[9px] opacity-70 flex items-center gap-2",children:[e.jsx(dt,{size:12})," Detailed Account Ledger"]})]})]}),e.jsxs("div",{className:"flex gap-3 relative z-10",children:[e.jsxs("div",{className:"bg-slate-50 px-6 py-3 rounded-2xl border border-slate-100 text-center",children:[e.jsxs("p",{className:"text-[8px] font-bold text-slate-400 uppercase tracking-widest mb-1 flex items-center justify-center gap-1.5",children:[e.jsx(ge,{size:10})," من تاريخ"]}),e.jsx("p",{className:"text-xs font-bold text-slate-800",children:d})]}),e.jsxs("div",{className:"bg-slate-50 px-6 py-3 rounded-2xl border border-slate-100 text-center",children:[e.jsxs("p",{className:"text-[8px] font-bold text-slate-400 uppercase tracking-widest mb-1 flex items-center justify-center gap-1.5",children:[e.jsx(ge,{size:10})," إلى تاريخ"]}),e.jsx("p",{className:"text-xs font-bold text-slate-800",children:u})]})]})]}),e.jsx("div",{className:`overflow-hidden ${g?"rounded-2xl border-2 border-slate-900":"rounded-3xl border border-slate-200 bg-white shadow-sm"}`,children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-white",children:[e.jsx("th",{className:`${g?"p-2":"p-4"} font-bold text-[10px] uppercase tracking-widest border-b border-slate-800`,children:"التاريخ"}),e.jsx("th",{className:`${g?"p-2":"p-4"} font-bold text-[10px] uppercase tracking-widest border-b border-slate-800`,children:"البيان والتفاصيل"}),e.jsx("th",{className:`${g?"p-2":"p-4"} text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800`,children:"مدين (+)"}),e.jsx("th",{className:`${g?"p-2":"p-4"} text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800`,children:"دائن (-)"}),e.jsx("th",{className:`${g?"p-2":"p-4"} text-center font-bold text-[10px] uppercase tracking-widest border-b border-slate-800 bg-slate-900`,children:"الرصيد التراكمي"}),!g&&e.jsx("th",{className:"p-4 border-b border-slate-800"})]})}),e.jsxs("tbody",{className:`divide-y divide-slate-50 font-bold ${g?"text-[10px]":"text-sm"}`,children:[e.jsxs("tr",{className:"bg-indigo-50/30",children:[e.jsx("td",{className:`p-2 text-slate-400 font-medium italic ${g?"text-[9px]":""}`,children:d}),e.jsxs("td",{className:"p-2 text-slate-900 font-bold italic flex items-center gap-3",children:[e.jsx("div",{className:`${g?"w-6 h-6":"w-8 h-8"} bg-white rounded-lg flex items-center justify-center shadow-sm`,children:e.jsx(le,{size:g?10:14,className:"text-indigo-400"})}),"رصيد ما قبل الفترة (رصيد منقول)"]}),e.jsx("td",{className:"p-2 text-center text-slate-300",children:"---"}),e.jsx("td",{className:"p-2 text-center text-slate-300",children:"---"}),e.jsx("td",{className:`p-2 text-center text-indigo-900 font-bold bg-indigo-50/50 tabular-nums ${g?"text-[10px]":"text-base"}`,children:o?"****":(a||0).toLocaleString()}),!g&&e.jsx("td",{})]}),m.map((f,y)=>_?.id===f.id?e.jsxs("tr",{className:"bg-indigo-50 animate-in slide-in-from-right-2 duration-300",children:[e.jsx("td",{className:"p-2 text-slate-400 font-medium",children:f.date}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"text",className:"w-full p-2 rounded-xl border-2 border-indigo-200 focus:border-indigo-500 outline-none text-sm font-bold",value:F.description,onChange:N=>B({...F,description:N.target.value}),autoFocus:!0})}),e.jsx("td",{className:"p-2",colSpan:2,children:e.jsx("div",{className:"flex items-center gap-2 justify-center",children:e.jsx("input",{type:"number",className:"w-32 p-2 rounded-xl border-2 border-indigo-200 focus:border-indigo-500 outline-none text-sm font-bold text-center",value:F.amount,onChange:N=>B({...F,amount:Number(N.target.value)})})})}),e.jsx("td",{className:"p-2 text-center text-indigo-900 font-bold tabular-nums",children:o?"****":f.runningBalance.toLocaleString()}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:q,className:"p-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 shadow-sm transition-all transform active:scale-95",title:"حفظ التعديلات",children:e.jsx(Ye,{size:16})}),e.jsx("button",{onClick:()=>V(null),className:"p-2 bg-slate-200 text-slate-600 rounded-xl hover:bg-slate-300 transition-all transform active:scale-95",title:"إلغاء",children:e.jsx(xe,{size:16})})]})})]},y):e.jsxs("tr",{className:`${g?y%2===0?"bg-white":"bg-slate-50/50":"hover:bg-slate-50/50 transition-all group"}`,children:[e.jsx("td",{className:`p-2 text-slate-400 font-medium ${g?"text-[9px]":""}`,children:f.date}),e.jsxs("td",{className:"p-2",children:[e.jsx("p",{className:`text-slate-900 font-bold ${g?"text-[9px] leading-tight":"text-sm"}`,children:f.description}),K(f.costCenterId,f.programId)&&e.jsxs("div",{className:"flex items-center gap-1.5 mt-1",children:[K(f.costCenterId,f.programId)?.type==="PROGRAM"?e.jsx(Re,{size:10,className:"text-indigo-400"}):e.jsx(Ne,{size:10,className:"text-indigo-400"}),e.jsx("span",{className:"text-[10px] font-bold text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded-md border border-indigo-100",children:K(f.costCenterId,f.programId)?.name})]}),!g&&e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsxs("span",{className:"text-[9px] text-indigo-400 font-bold uppercase tracking-widest opacity-60 bg-indigo-50 px-1.5 py-0.5 rounded cursor-text select-all",title:"انقر لنسخ رقم المرجع للبحث",onClick:N=>{N.stopPropagation(),navigator.clipboard.writeText(f?.refNo||f?.id?.split("-")[0]||"")},children:["REF: ",f?.refNo||f?.id?.split("-")[0]||"N/A"]})})]}),e.jsx("td",{className:`p-2 text-center text-emerald-600 font-bold tabular-nums ${g?"text-[10px]":"text-base"}`,children:f.debit>0?o?"****":(f.debit||0).toLocaleString():e.jsx("span",{className:"text-slate-200",children:"-"})}),e.jsx("td",{className:`p-2 text-center text-rose-600 font-bold tabular-nums ${g?"text-[10px]":"text-base"}`,children:f.credit>0?o?"****":(f.credit||0).toLocaleString():e.jsx("span",{className:"text-slate-200",children:"-"})}),e.jsx("td",{className:`p-2 text-center font-bold tabular-nums ${g?"text-[10px]":"text-base"} ${f.runningBalance>=0?"bg-emerald-50/30 text-emerald-700":"bg-rose-50/30 text-rose-700"}`,children:o?"****":(f.runningBalance||0).toLocaleString()}),!g&&e.jsxs("td",{className:"p-2 text-center opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>he(f),className:"p-2 bg-indigo-50 text-indigo-600 rounded-xl hover:bg-indigo-600 hover:text-white transition-all shadow-sm transform active:scale-95",title:"تعديل سريع",children:e.jsx(Ge,{size:14})}),e.jsx("button",{onClick:()=>{const N=(ae||[]).find(v=>v?.id===f?.id||v?.journalEntryId===f?.id&&v?.category!=="JOURNAL_ENTRY");N?be?.(N.id):we?.(f?.id)},className:"p-2 bg-rose-50 text-rose-600 rounded-xl hover:bg-rose-600 hover:text-white transition-all shadow-sm transform active:scale-95",title:"إلغاء / حذف العملية",children:e.jsx(xe,{size:14})})]})]},y))]})]})}),W()]})},st=A.memo(Bt),Jt=({customers:c,transactions:n,masterTrips:m,programs:a,balanceMap:d,isHidden:u,currencies:o,searchTerm:t})=>{const r=S.useMemo(()=>{const s={};return(m||[]).forEach(i=>{s[i.id]=i.name}),(a||[]).forEach(i=>{s[i.id]=i.name}),s},[m,a]),l=S.useMemo(()=>{const s={};return(n||[]).forEach(i=>{i&&!i.isVoided&&i.relatedEntityId&&(i.masterTripId||i.programId)&&(s[i.relatedEntityId]||(s[i.relatedEntityId]=new Set),i.masterTripId&&s[i.relatedEntityId].add(i.masterTripId),i.programId&&s[i.relatedEntityId].add(i.programId))}),s},[n]),b=S.useMemo(()=>{const s=[];if((c||[]).forEach(j=>{const w=(d||{})[`CUSTOMER-${j.id}`]?.base||0;if(w<0){const Y=Array.from(l[j.id]||[]).map(g=>r[g]).filter(Boolean);s.push({...j,advance:Math.abs(w),trips:Y.length>0?Y:["حجز غير محدد"]})}}),s.sort((j,w)=>w.advance-j.advance),!t)return s;const i=t.toLowerCase();return s.filter(j=>(j.name||"").toLowerCase().includes(i)||j.trips.some(w=>w.toLowerCase().includes(i)))},[c,d,l,r,t]);return e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white p-6 rounded-3xl shadow-sm border border-white relative overflow-hidden group",children:[e.jsx("div",{className:"absolute right-0 top-0 w-64 h-64 bg-emerald-50 rounded-full blur-[100px] -mr-32 -mt-32 opacity-60"}),e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-600 text-white rounded-2xl flex items-center justify-center shadow-lg shadow-emerald-200 transform group-hover:scale-110 transition-transform duration-500",children:e.jsx(Ce,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 tracking-tight mb-1",children:"دفعات العملاء والحجوزات"}),e.jsxs("p",{className:"text-emerald-500 font-bold uppercase tracking-[0.2em] text-[9px] opacity-70 flex items-center gap-2",children:[e.jsx(T,{size:12})," Customer Advances • Active Bookings"]})]})]})]}),e.jsx("div",{className:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 text-slate-400",children:[e.jsx("th",{className:"p-4 font-bold text-[9px] uppercase tracking-widest border-b border-slate-100",children:"العميل"}),e.jsx("th",{className:"p-4 font-bold text-[9px] uppercase tracking-widest border-b border-slate-100 text-center",children:"الرحلات المحجوزة"}),e.jsx("th",{className:"p-4 font-bold text-[9px] uppercase tracking-widest border-b border-slate-100 text-center",children:"المبلغ المودع (لصالح العميل)"}),e.jsx("th",{className:"p-4 font-bold text-[9px] uppercase tracking-widest border-b border-slate-100 text-center",children:"الإجراء"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-12 text-center text-slate-400 font-medium",children:"لا يوجد عملاء لديهم مبالغ مودعة حالياً"})}):b.map((s,i)=>e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors group",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center text-slate-400",children:e.jsx(de,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900 text-sm",children:s.name||"-"}),e.jsx("p",{className:"text-[10px] text-slate-500",children:s.phone||"بدون هاتف"})]})]})}),e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"flex flex-wrap gap-1 justify-center",children:s.trips.map((j,w)=>e.jsxs("span",{className:"bg-indigo-50 text-indigo-600 text-[10px] px-2 py-1 rounded-md font-bold flex items-center gap-1",children:[e.jsx(ge,{size:10})," ",j]},w))})}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("span",{className:"font-bold text-emerald-600 tabular-nums text-lg",children:[u?"****":s.advance.toLocaleString()," ",e.jsx("span",{className:"text-[10px] opacity-40 font-normal",children:"ج.م"})]})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("div",{className:"flex items-center justify-center gap-2",children:s.phone&&e.jsxs(e.Fragment,{children:[e.jsx("a",{href:`tel:${s.phone}`,className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",children:e.jsx(Te,{size:14})}),e.jsx("a",{href:`https://wa.me/${s.phone.replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",children:e.jsx(at,{size:14})})]})})})]},i))})]})})})]})},qt=A.memo(Jt),ms=({transactions:c,journalEntries:n,customers:m,suppliers:a,partners:d,treasuries:u,settings:o,currentUser:t,currencies:r,employees:l,programs:b,masterTrips:s,auditLogs:i,costCenters:j,initialState:w,onStateApplied:I,onTransactionClick:Y,searchTerm:g="",formatCurrency:X,onUpdateTransaction:J,onUpdateJournalEntry:pe,onVoidTransaction:ve,onDeleteJournalEntry:be})=>{const{t:we}=nt(),ae=S.useRef(null),[h,L]=S.useState(()=>w?w.type:t?.role==="ADMIN"?"SUMMARY":"EMPLOYEE_LEDGER"),[G,_]=S.useState(()=>{if(w)return w.id;if(t?.employeeId)return t.employeeId;if(t?.role!=="ADMIN"){const x=(l||[]).find(E=>(E.name||"").trim()===(t?.name||"").trim());return x?x.id:""}return""}),[V,F]=S.useState("ALL"),[B,he]=S.useState(()=>(j||[]).length>0?j[0].id:""),[q,oe]=S.useState("FINANCIAL"),[k,ue]=S.useState(()=>{const x=new Date;return new Date(x.getFullYear(),0,1).toISOString().split("T")[0]}),[C,je]=S.useState(()=>new Date().toISOString().split("T")[0]),{effectiveFromDate:ee,effectiveToDate:W}=S.useMemo(()=>k>C?{effectiveFromDate:C,effectiveToDate:k}:{effectiveFromDate:k,effectiveToDate:C},[k,C]),[ye,K]=S.useState(!1),[f,y]=S.useState(""),p=g||f,N=t?.permissions?.includes("HIDE_FINANCIAL_AMOUNTS"),v=N||t.role==="BOOKING_EMPLOYEE";S.useEffect(()=>{w&&(L(w.type),_(w.id),I&&I())},[w,I]),S.useEffect(()=>{const x=E=>{(E.ctrlKey||E.metaKey)&&E.key==="f"&&(E.preventDefault(),ae.current?.focus())};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[]),S.useEffect(()=>{if(t&&t.role!=="ADMIN"&&h==="EMPLOYEE_LEDGER"){const x=t.employeeId||(l||[]).find(E=>ut(E.name||"",t.name||""))?.id;x&&G!==x&&_(x)}},[h,t,l]);const R=S.useMemo(()=>(c||[]).filter(x=>{const E=!x.isVoided&&(x.date||"")>=ee&&(x.date||"")<=W;if(V==="ALL")return E;const H=x.costCenterId||"GENERAL";return E&&H===V}),[c,ee,W,V]),P=S.useMemo(()=>V==="ALL"?n||[]:(n||[]).map(x=>({...x,lines:(x.lines||[]).filter(E=>(E.costCenterId||"GENERAL")===V)})).filter(x=>(x.lines||[]).length>0),[n,V]);S.useMemo(()=>{if(!p)return m||[];const x=p.toLowerCase();return(m||[]).filter(E=>(E.name||"").toLowerCase().includes(x))},[m,p]),S.useMemo(()=>{if(!p)return a||[];const x=p.toLowerCase();return(a||[]).filter(E=>(E.company||"").toLowerCase().includes(x)||(E.name||"").toLowerCase().includes(x))},[a,p]);const ce=S.useMemo(()=>{const x=(R||[]).filter($=>$.type==="INCOME"&&$.category!=="CASH").reduce(($,Q)=>$+(Q.amountInBase||0),0),E=(R||[]).filter($=>$.type==="EXPENSE"&&$.category!=="CASH").reduce(($,Q)=>$+(Q.amountInBase||0),0),H=x-E,z=(R||[]).length;return{revenue:x,expenses:E,profit:H,txCount:z}},[R]),U=vt(P,m,a,d,l,u,r,ee,W,c);S.useMemo(()=>{if(!p)return U||[];const x=p.toLowerCase();return(U||[]).filter(E=>(E.name||"").toLowerCase().includes(x)||(E.type||"").toLowerCase().includes(x))},[U,p]);const O=S.useMemo(()=>{const x={};let E=0,H=0;return(U||[]).forEach(z=>{let $=0;const Q=z.balanceInAccountCurrency||0,Ue=(z.type==="CUSTOMER"||z.type==="SUPPLIER")&&((m||[]).find(Ee=>Ee.id===z.id)?.openingBalanceCurrency!==(o.baseCurrency||"EGP")||(a||[]).find(Ee=>Ee.id===z.id)?.openingBalanceCurrency!==(o.baseCurrency||"EGP"));z.type==="CUSTOMER"||z.type==="TREASURY"||z.type==="ASSET"||z.type==="EMPLOYEE_ADVANCE"?($=(z.debit||0)-(z.credit||0),Ue&&Math.abs(Q)<.01&&($=0),x[`${z.type}-${z.id}`]={base:$,currency:Q},z.type==="CUSTOMER"&&$>0&&(E+=$)):($=(z.credit||0)-(z.debit||0),Ue&&Math.abs(Q)<.01&&($=0),x[`${z.type}-${z.id}`]={base:$,currency:Q},z.type==="SUPPLIER"&&$>0&&(H+=$))}),{map:x,totalCustDebt:E,totalSuppCredit:H}},[U,m,a,o.baseCurrency]),M=wt(U,P),Ie=yt(U),ze=Et(b,R),Ae=St(c,j,B,ee,W),_e=Lt(s,P,c),Pe=Rt(m,a,P,O.map,W),Oe=Ct(M,l,R,t),{entries:$e,openingBalance:De}=kt(h,G,P,ee,W,p,m,a,l,d,u,r,c),ot=()=>{const x=document.getElementById("report-to-print"),E=document.getElementById("print-section");if(x&&E){E.innerHTML="";const H=x.cloneNode(!0);E.appendChild(H),document.body.classList.add("printing-mode"),setTimeout(()=>{window.print(),setTimeout(()=>{document.body.classList.remove("printing-mode")},1e3)},300)}},ct=()=>{switch(h){case"SUMMARY":return"ميزان المراجعة العام (Trial Balance)";case"P_L":return"بيان الأرباح والخسائر (Income Statement)";case"BALANCE_SHEET":return"قائمة المركز المالي (Balance Sheet)";case"CUSTOMER_LEDGER":return`كشف حساب عميل: ${(m||[]).find(x=>x.id===G)?.name||""}`;case"SUPPLIER_LEDGER":return`كشف حساب مورد: ${(a||[]).find(x=>x.id===G)?.company||""}`;case"EMPLOYEE_LEDGER":return`كشف حساب موظف: ${(l||[]).find(x=>x.id===G)?.name||""}`;case"EMPLOYEE_ADVANCE":return`كشف سلف موظف: ${(l||[]).find(x=>x.id===G)?.name||""}`;case"PARTNER_LEDGER":return`كشف حساب جاري شريك: ${(d||[]).find(x=>x.id===G)?.name||""}`;case"TREASURY_REPORT":return`تقرير حركة خزينة: ${(u||[]).find(x=>x.id===G)?.name||""}`;case"TREASURY_TRANSFERS":return"تقرير التحويلات النقدية البينية";case"AUDIT_LOG":return"سجل مراقبة النظام (Audit Trail)";case"CUSTOMERS_SUMMARY":return"تقرير إجمالي مديونيات العملاء";case"SUPPLIERS_SUMMARY":return"تقرير إجمالي مستحقات الموردين";case"ADVANCED_ANALYTICS":return"التحليلات المتقدمة وذكاء الأعمال";case"HAJJ_UMRAH_P_L":return"تقرير أرباح وخسائر برامج الحج والعمرة";case"CUSTOMER_ADVANCES":return"تقرير دفعات العملاء والحجوزات";case"MASTER_TRIP_REPORT":return"التقرير المجمع للرحلات (Master Trip Report)";case"COMMISSION_REPORT":return"تقرير عمولات المبيعات";case"DEBT_FOLLOWUP":return"تقرير متابعة تحصيل المديونيات";case"AGING_REPORT":return"تقرير أعمار الديون";case"COST_CENTER_ANALYSIS":return`تحليل أرباح: ${(j||[]).find(E=>E.id===B)?.name||"مركز تكلفة"}`;default:return""}};return e.jsxs("div",{className:"space-y-6 pb-10 font-['Cairo'] animate-in fade-in duration-500 print:animate-none print:opacity-100 print:transform-none",children:[t.role!=="BOOKING_EMPLOYEE"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 no-print",children:[e.jsx(fe,{title:"إجمالي المبيعات",value:M.totalSales,icon:e.jsx(ie,{size:18}),trend:`${ce.txCount} عملية`,color:"emerald",isHidden:v}),e.jsx(fe,{title:"تكلفة العمليات",value:M.totalDirectCosts,icon:e.jsx(ne,{size:18}),color:"amber",isHidden:v}),e.jsx(fe,{title:"المصروفات العامة",value:M.expenses,icon:e.jsx(te,{size:18}),color:"rose",isHidden:v}),e.jsx(fe,{title:"صافي الربح النهائي",value:M.netProfit,icon:e.jsx(it,{size:18}),highlight:!0,color:M.netProfit>=0?"emerald":"rose",isHidden:v})]}),e.jsx("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-200 no-print",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex bg-slate-50 p-1.5 rounded-2xl gap-1.5 w-full border border-slate-200 shadow-inner",children:[e.jsxs("button",{onClick:()=>oe("FINANCIAL"),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl font-bold text-xs transition-all duration-300 transform active:scale-95 ${q==="FINANCIAL"?"bg-slate-900 text-indigo-400 shadow-md":"text-slate-500 hover:bg-white hover:text-slate-900"}`,children:[e.jsx(re,{size:16})," التقارير المالية"]}),e.jsxs("button",{onClick:()=>oe("OPERATIONAL"),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl font-bold text-xs transition-all duration-300 transform active:scale-95 ${q==="OPERATIONAL"?"bg-slate-900 text-indigo-400 shadow-md":"text-slate-500 hover:bg-white hover:text-slate-900"}`,children:[e.jsx(se,{size:16})," تقارير التشغيل"]}),e.jsxs("button",{onClick:()=>oe("ANALYTICS"),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl font-bold text-xs transition-all duration-300 transform active:scale-95 ${q==="ANALYTICS"?"bg-slate-900 text-indigo-400 shadow-md":"text-slate-500 hover:bg-white hover:text-slate-900"}`,children:[e.jsx(ne,{size:16})," التحليلات"]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-center",children:[e.jsxs("div",{className:"flex bg-slate-50 p-1.5 rounded-2xl gap-1.5 overflow-x-auto w-full lg:w-auto scrollbar-hide border border-slate-200 shadow-inner",children:[q==="FINANCIAL"&&e.jsxs(e.Fragment,{children:[e.jsx(D,{active:h==="SUMMARY",onClick:()=>L("SUMMARY"),label:"ميزان المراجعة"}),e.jsx(D,{active:h==="P_L",onClick:()=>L("P_L"),label:"الأرباح والخسائر"}),e.jsx(D,{active:h==="BALANCE_SHEET",onClick:()=>L("BALANCE_SHEET"),label:"المركز المالي"}),e.jsx(D,{active:h==="CUSTOMER_LEDGER",onClick:()=>{L("CUSTOMER_LEDGER"),_("")},label:"كشف حساب عميل"}),e.jsx(D,{active:h==="SUPPLIER_LEDGER",onClick:()=>{L("SUPPLIER_LEDGER"),_("")},label:"كشف حساب مورد"}),t.role==="ADMIN"&&e.jsxs(e.Fragment,{children:[e.jsx(D,{active:h==="PARTNER_LEDGER",onClick:()=>{L("PARTNER_LEDGER"),_("")},label:"جاري الشركاء"}),e.jsx(D,{active:h==="TREASURY_REPORT",onClick:()=>{L("TREASURY_REPORT"),_("")},label:"تقرير الخزينة"}),e.jsx(D,{active:h==="TREASURY_TRANSFERS",onClick:()=>L("TREASURY_TRANSFERS"),label:"التحويلات البينية"})]})]}),q==="OPERATIONAL"&&e.jsxs(e.Fragment,{children:[e.jsx(D,{active:h==="HAJJ_UMRAH_P_L",onClick:()=>L("HAJJ_UMRAH_P_L"),label:"أرباح الحج والعمرة"}),e.jsx(D,{active:h==="CUSTOMER_ADVANCES",onClick:()=>L("CUSTOMER_ADVANCES"),label:"دفعات العملاء والحجوزات"}),t.role==="ADMIN"&&e.jsx(D,{active:h==="MASTER_TRIP_REPORT",onClick:()=>L("MASTER_TRIP_REPORT"),label:"تقرير الرحلات المجمع"}),e.jsx(D,{active:h==="DEBT_FOLLOWUP",onClick:()=>L("DEBT_FOLLOWUP"),label:"متابعة تحصيل الديون"}),e.jsx(D,{active:h==="COMMISSION_REPORT",onClick:()=>L("COMMISSION_REPORT"),label:"تقرير العمولات"}),e.jsx(D,{active:h==="AGING_REPORT",onClick:()=>L("AGING_REPORT"),label:"أعمار الديون"}),e.jsx(D,{active:h==="EMPLOYEE_LEDGER",onClick:()=>{L("EMPLOYEE_LEDGER"),_("")},label:"كشف حساب موظف"}),e.jsx(D,{active:h==="EMPLOYEE_ADVANCE",onClick:()=>{L("EMPLOYEE_ADVANCE"),_("")},label:"سلف الموظفين"})]}),q==="ANALYTICS"&&e.jsxs(e.Fragment,{children:[e.jsx(D,{active:h==="CUSTOMERS_SUMMARY",onClick:()=>L("CUSTOMERS_SUMMARY"),label:"ملخص مديونيات العملاء"}),e.jsx(D,{active:h==="SUPPLIERS_SUMMARY",onClick:()=>L("SUPPLIERS_SUMMARY"),label:"ملخص مستحقات الموردين"}),t.role==="ADMIN"&&e.jsxs(e.Fragment,{children:[e.jsx(D,{active:h==="COST_CENTER_ANALYSIS",onClick:()=>L("COST_CENTER_ANALYSIS"),label:"تحليل أرباح مراكز التكلفة"}),e.jsx(D,{active:h==="AUDIT_LOG",onClick:()=>L("AUDIT_LOG"),label:"سجل المراقبة"})]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-4 justify-end w-full",children:[e.jsxs("div",{className:"relative group min-w-[200px]",children:[e.jsx(dt,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-indigo-500",size:16}),e.jsx("input",{ref:ae,type:"text",placeholder:"بحث في التقارير...",className:"w-full pr-12 pl-4 py-3 bg-slate-50 border border-slate-200 rounded-2xl text-xs font-bold focus:outline-none focus:border-indigo-500 focus:bg-white transition-all",value:f,onChange:x=>y(x.target.value)})]}),e.jsxs("div",{className:"flex items-center bg-slate-50 border border-slate-200 rounded-2xl p-1 shadow-inner",children:[e.jsxs("div",{className:"flex flex-col px-3 border-l border-slate-200",children:[e.jsx("span",{className:"text-[9px] text-slate-400 font-bold uppercase tracking-widest",children:"من تاريخ"}),e.jsx("input",{type:"date",className:"bg-transparent text-slate-900 font-bold text-[10px] outline-none",value:k,onChange:x=>ue(x.target.value)})]}),e.jsxs("div",{className:"flex flex-col px-3 border-l border-slate-200",children:[e.jsx("span",{className:"text-[9px] text-slate-400 font-bold uppercase tracking-widest",children:"إلى تاريخ"}),e.jsx("input",{type:"date",className:"bg-transparent text-slate-900 font-bold text-[10px] outline-none",value:C,onChange:x=>je(x.target.value)})]}),e.jsxs("div",{className:"flex flex-col px-3",children:[e.jsx("span",{className:"text-[9px] text-slate-400 font-bold uppercase tracking-widest",children:"مركز التكلفة"}),e.jsxs("select",{className:"bg-transparent text-slate-900 font-bold text-[10px] outline-none min-w-[120px] cursor-pointer",value:V,onChange:x=>F(x.target.value),children:[e.jsx("option",{value:"ALL",children:"كافة المراكز"}),e.jsx("option",{value:"GENERAL",children:"المركز الرئيسي"}),(j||[]).filter(x=>x.isActive).map(x=>e.jsx("option",{value:x.id,children:x.name},x.id))]})]})]}),e.jsxs("button",{onClick:()=>K(!0),className:"bg-slate-900 text-indigo-400 px-8 py-3 rounded-2xl font-bold text-xs flex items-center gap-2 hover:bg-slate-800 transition-all shadow-lg active:scale-95",children:[e.jsx(lt,{size:16})," عرض الطباعة"]})]})]})]})}),(h==="CUSTOMER_LEDGER"||h==="SUPPLIER_LEDGER"||h==="EMPLOYEE_LEDGER"||h==="EMPLOYEE_ADVANCE"||h==="PARTNER_LEDGER")&&e.jsxs("div",{className:"bg-slate-50 p-6 rounded-3xl border border-slate-200 flex items-center gap-6 no-print",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-900 rounded-2xl flex items-center justify-center text-indigo-400 shadow-lg",children:h==="CUSTOMER_LEDGER"?e.jsx(de,{size:24}):h==="SUPPLIER_LEDGER"?e.jsx(se,{size:24}):h==="PARTNER_LEDGER"?e.jsx(jt,{size:24}):e.jsx(de,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase mb-1 block tracking-widest",children:"اختر الحساب المطلوب للمراجعة"}),e.jsx(Se,{options:h==="CUSTOMER_LEDGER"?(m||[]).map(x=>({id:x.id,name:x.name,subtext:`الرصيد: ${N?"****":(O.map[`CUSTOMER-${x.id}`]?.base||0).toLocaleString()||"0"} ج.م`})):h==="SUPPLIER_LEDGER"?(a||[]).map(x=>({id:x.id,name:x.company||x.name,subtext:`الرصيد: ${N?"****":(O.map[`SUPPLIER-${x.id}`]?.base||0).toLocaleString()||"0"} ج.م`})):h==="PARTNER_LEDGER"?(d||[]).map(x=>({id:x.id,name:x.name,subtext:`الرصيد: ${N?"****":(O.map[`PARTNER-${x.id}`]?.base||0).toLocaleString()||"0"} ج.م`})):h==="EMPLOYEE_ADVANCE"?(l||[]).map(x=>({id:x.id,name:x.name,subtext:`رصيد السلف: ${N?"****":(O.map[`EMPLOYEE_ADVANCE-${x.id}`]?.base||0).toLocaleString()||"0"} ج.م`})):(l||[]).map(x=>({id:x.id,name:x.name,subtext:`الرصيد: ${N?"****":(O.map[`LIABILITY-${x.id}`]?.base||0).toLocaleString()||"0"} ج.م`})),value:G,onChange:_,disabled:t.role!=="ADMIN"&&(h==="EMPLOYEE_LEDGER"||h==="EMPLOYEE_ADVANCE"),placeholder:t.role!=="ADMIN"&&(h==="EMPLOYEE_LEDGER"||h==="EMPLOYEE_ADVANCE")?"حسابي الشخصي":"اختر من السجل المحاسبي"})]})]}),h==="TREASURY_REPORT"&&e.jsxs("div",{className:"bg-slate-50 p-6 rounded-3xl border border-slate-200 flex items-center gap-6 no-print",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-900 rounded-2xl flex items-center justify-center text-indigo-400 shadow-lg",children:e.jsx(re,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase mb-1 block tracking-widest",children:"اختر الخزينة المطلوبة للمراجعة"}),e.jsx(Se,{options:(u||[]).map(x=>({id:x.id,name:x.name,subtext:`الرصيد: ${v?"****":(O.map[`TREASURY-${x.id}`]?.base||0).toLocaleString()} ج.م`})),value:G,onChange:_,placeholder:"اختر من الخزائن"})]})]}),h==="COST_CENTER_ANALYSIS"&&e.jsxs("div",{className:"bg-slate-50 p-6 rounded-3xl border border-slate-200 flex items-center gap-6 no-print",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-900 rounded-2xl flex items-center justify-center text-indigo-400 shadow-lg",children:e.jsx(Ne,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase mb-1 block tracking-widest",children:"اختر مركز التكلفة المطلوب تحليله"}),e.jsx(Se,{options:(j||[]).map(x=>({id:x.id,name:x.name})),value:B,onChange:he,placeholder:"اختر مركز التكلفة"})]})]}),e.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-sm border border-slate-100 no-print min-h-[400px]",children:[h==="CUSTOMERS_SUMMARY"&&e.jsx(Ke,{customers:m,balanceMap:O.map,isHidden:N,currencies:r,searchTerm:p}),h==="SUPPLIERS_SUMMARY"&&e.jsx(Xe,{suppliers:a,balanceMap:O.map,isHidden:N,currencies:r,searchTerm:p}),h==="SUMMARY"&&e.jsx(Je,{trialBalance:U,shouldMaskAggregate:v}),h==="P_L"&&e.jsx(qe,{stats:M,fromDate:k,toDate:C,formatCurrency:X,shouldMaskAggregate:v}),h==="BALANCE_SHEET"&&e.jsx(We,{totals:Ie,trialBalance:U,formatCurrency:X,shouldMaskAggregate:v,isHidden:N,toDate:C}),h==="HAJJ_UMRAH_P_L"&&e.jsx(Be,{stats:ze,fromDate:k,toDate:C,shouldMaskAggregate:v}),h==="CUSTOMER_ADVANCES"&&e.jsx(qt,{customers:m,transactions:c,masterTrips:s,programs:b,balanceMap:O.map,isHidden:N,currencies:r,searchTerm:p}),h==="COST_CENTER_ANALYSIS"&&e.jsx(Ve,{stats:Ae,costCenterName:j.find(x=>x.id===B)?.name||"مركز غير معروف",fromDate:k,toDate:C,shouldMaskAggregate:v}),h==="COMMISSION_REPORT"&&e.jsx(et,{analyticsData:Oe,filteredTx:R,fromDate:k,toDate:C,shouldMaskAggregate:v,setActiveReport:L,setSelectedId:_}),h==="MASTER_TRIP_REPORT"&&e.jsx(Qe,{stats:_e,fromDate:k,toDate:C,shouldMaskAggregate:v}),h==="AGING_REPORT"&&e.jsx(Ze,{agingData:Pe,isHidden:N}),h==="AUDIT_LOG"&&e.jsx(tt,{auditLogs:i,fromDate:k,toDate:C,searchTerm:p}),h==="DEBT_FOLLOWUP"&&e.jsx(He,{customers:m,employees:l,transactions:c,balanceMap:O.map,isHidden:N,currencies:r,searchTerm:p}),(h==="CUSTOMER_LEDGER"||h==="SUPPLIER_LEDGER"||h==="EMPLOYEE_LEDGER"||h==="EMPLOYEE_ADVANCE"||h==="PARTNER_LEDGER"||h==="TREASURY_REPORT")&&G&&e.jsx(st,{activeReport:h,selectedId:G,ledgerEntries:$e,openingBalance:De,fromDate:k,toDate:C,isHidden:N,shouldMaskAggregate:v,customers:m,suppliers:a,employees:l,partners:d,treasuries:u,currencies:r,onTransactionClick:Y,onUpdateTransaction:J,onUpdateJournalEntry:pe,onVoidTransaction:ve,onDeleteJournalEntry:be,transactions:c,journalEntries:n,costCenters:j,masterTrips:s,programs:b})]}),ye&&e.jsxs("div",{className:"fixed inset-0 z-[200] bg-slate-900 bg-opacity-95 backdrop-blur-xl flex flex-col items-center p-6 overflow-y-auto no-print",children:[e.jsxs("div",{className:"w-full max-w-5xl flex justify-between items-center mb-6 text-white animate-in slide-in-from-top-4 duration-500",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center shadow-lg shadow-indigo-500/20 text-white",children:e.jsx(T,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:"مركز التقارير والتدقيق المالي"}),e.jsx("p",{className:"text-slate-400 text-[10px] font-bold uppercase tracking-[0.2em]",children:"Financial Intelligence Unit"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:ot,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-2xl font-bold flex items-center gap-2 shadow-xl shadow-indigo-500/20 transition-all hover:scale-105 active:scale-95",children:[e.jsx(At,{size:20})," طباعة المستند"]}),e.jsx("button",{onClick:()=>K(!1),className:"bg-white/10 hover:bg-white/20 text-white p-3 rounded-2xl transition-all hover:rotate-90",children:e.jsx(xe,{size:24})})]})]}),e.jsxs("div",{id:"report-to-print",className:"bg-white w-full max-w-[210mm] min-h-[297mm] p-[10mm] shadow-2xl relative text-slate-900 animate-in zoom-in-95 duration-700",children:[e.jsx("style",{children:`
                @media print {
                   @page { size: A4; margin: 10mm; }
                   body { -webkit-print-color-adjust: exact; }
                   .no-print { display: none !important; }
                   table { page-break-inside: auto; width: 100%; border-collapse: collapse; }
                   tr { page-break-inside: avoid; page-break-after: auto; }
                   thead { display: table-header-group; }
                   tfoot { display: table-footer-group; }
                   .report-content { min-height: 150mm; }
                   .avoid-page-break { break-inside: avoid; page-break-inside: avoid; }
                }
             `}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none overflow-hidden opacity-[0.03] select-none z-0",children:e.jsx("div",{className:"text-[8rem] font-bold rotate-[-35deg] whitespace-nowrap uppercase",children:o.name})}),e.jsxs("div",{className:"relative z-10 flex justify-between items-start border-b-2 border-slate-900 pb-4 mb-4",children:[e.jsxs("div",{className:"space-y-2 text-right flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 leading-tight",children:o.name}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:[e.jsxs("p",{className:"text-xs font-bold text-slate-700 flex items-center gap-2 justify-end",children:[o.address," ",e.jsx(ft,{size:12,className:"text-slate-400"})]}),e.jsxs("p",{className:"text-xs font-bold text-slate-700 flex items-center gap-2 justify-end",children:[o.phone," ",e.jsx(Te,{size:12,className:"text-slate-400"})]}),e.jsxs("p",{className:"text-xs font-bold text-slate-700 flex items-center gap-2 justify-end",children:[o.email," ",e.jsx(_t,{size:12,className:"text-slate-400"})]}),e.jsxs("p",{className:"text-xs font-bold text-slate-700 flex items-center gap-2 justify-end",children:[o.facebook," ",e.jsx(Pt,{size:12,className:"text-slate-400"})]})]}),e.jsxs("div",{className:"pt-1 border-t border-slate-100",children:[e.jsx("p",{className:"text-xs font-bold text-indigo-600",children:"قسم الحسابات والتدقيق المالي"}),e.jsx("p",{className:"text-[8px] font-bold text-slate-400 uppercase tracking-widest italic leading-none",children:"Department of Financial Compliance & Internal Audit"})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2 mr-6",children:[o.logo&&e.jsx("img",{src:o.logo,className:"w-16 h-16 rounded-2xl object-cover border-2 border-slate-50 shadow-md"}),e.jsx("div",{className:"px-3 py-1 bg-slate-900 text-white rounded-full shadow-md",children:e.jsx("p",{className:"text-[7px] font-bold uppercase tracking-[0.2em]",children:"Official Statement"})})]})]}),e.jsx("div",{className:"relative z-10 mb-6 flex justify-center",children:e.jsxs("div",{className:"relative flex flex-col items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-1 bg-slate-900 rounded-xl blur-sm opacity-5"}),e.jsx("h2",{className:"relative text-lg font-bold px-8 py-2 bg-white text-slate-900 rounded-xl border-2 border-slate-900 shadow-sm",children:ct()})]}),V!=="ALL"&&e.jsx("div",{className:"px-4 py-1 bg-slate-100 border border-slate-200 text-slate-900 rounded-full font-bold text-xs shadow-sm",children:V==="GENERAL"?"المركز الرئيسي":(j||[]).find(x=>x.id===V)?.name})]})}),e.jsxs("div",{className:"report-content min-h-[400px]",children:[h==="CUSTOMERS_SUMMARY"&&e.jsx(Ke,{customers:m,balanceMap:O.map,isHidden:N,currencies:r,searchTerm:p,isPrint:!0}),h==="SUPPLIERS_SUMMARY"&&e.jsx(Xe,{suppliers:a,balanceMap:O.map,isHidden:N,currencies:r,searchTerm:p,isPrint:!0}),h==="SUMMARY"&&e.jsx(Je,{trialBalance:U,shouldMaskAggregate:v,isPrint:!0}),h==="P_L"&&e.jsx(qe,{stats:M,fromDate:k,toDate:C,formatCurrency:X,shouldMaskAggregate:v,isPrint:!0}),h==="BALANCE_SHEET"&&e.jsx(We,{totals:Ie,trialBalance:U,formatCurrency:X,shouldMaskAggregate:v,isHidden:N,toDate:C,isPrint:!0}),h==="HAJJ_UMRAH_P_L"&&e.jsx(Be,{stats:ze,fromDate:k,toDate:C,shouldMaskAggregate:v,isPrint:!0}),h==="COST_CENTER_ANALYSIS"&&e.jsx(Ve,{stats:Ae,costCenterName:j.find(x=>x.id===B)?.name||"مركز غير معروف",fromDate:k,toDate:C,shouldMaskAggregate:v,isPrint:!0}),h==="COMMISSION_REPORT"&&e.jsx(et,{analyticsData:Oe,filteredTx:R,fromDate:k,toDate:C,shouldMaskAggregate:v,setActiveReport:L,setSelectedId:_,isPrint:!0}),h==="MASTER_TRIP_REPORT"&&e.jsx(Qe,{stats:_e,fromDate:k,toDate:C,shouldMaskAggregate:v,isPrint:!0}),h==="AGING_REPORT"&&e.jsx(Ze,{agingData:Pe,isHidden:N,isPrint:!0}),h==="TREASURY_TRANSFERS"&&e.jsx(Vt,{transactions:c,treasuries:u,fromDate:k,toDate:C,isPrint:!0,baseCurrency:o.baseCurrency}),h==="AUDIT_LOG"&&e.jsx(tt,{auditLogs:i,fromDate:k,toDate:C,searchTerm:p,isPrint:!0}),h==="DEBT_FOLLOWUP"&&e.jsx(He,{customers:m,employees:l,transactions:c,balanceMap:O.map,isHidden:N,currencies:r,searchTerm:p,isPrint:!0}),(h==="CUSTOMER_LEDGER"||h==="SUPPLIER_LEDGER"||h==="EMPLOYEE_LEDGER"||h==="EMPLOYEE_ADVANCE"||h==="PARTNER_LEDGER"||h==="TREASURY_REPORT")&&G&&e.jsx(st,{activeReport:h,selectedId:G,ledgerEntries:$e,openingBalance:De,fromDate:k,toDate:C,isHidden:N,shouldMaskAggregate:v,customers:m,suppliers:a,employees:l,partners:d,treasuries:u,currencies:r,isPrint:!0,baseCurrency:o.baseCurrency,transactions:c,journalEntries:n,onUpdateTransaction:J,onUpdateJournalEntry:pe,costCenters:j,masterTrips:s,programs:b})]}),e.jsx("div",{className:"mt-8 pt-4 border-t-2 border-slate-900 avoid-page-break",children:e.jsxs("div",{className:"bg-slate-900 text-white p-4 rounded-2xl border-r-4 border-indigo-500 shadow-xl",children:[e.jsxs("p",{className:"text-[10px] font-bold uppercase mb-1 flex items-center gap-2 text-indigo-400 tracking-widest",children:[e.jsx(T,{size:14})," إقرار واعتماد (Official Verification)"]}),e.jsx("p",{className:"text-[9px] font-bold leading-tight text-slate-300",children:"يعتبر هذا المستند مستخرجاً رسمياً من الأنظمة المحاسبية المعتمدة للمؤسسة، وهو تقرير نهائي وقطعي ملزم لجميع الأطراف المذكورة فيه. يعتبر المستند والبيانات الواردة فيه صحيحة ونهائية ما لم يتم الاعتراض عليها خطياً وبمستندات رسمية خلال مدة أقصاها (72 ساعة)."})]})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200 avoid-page-break",children:e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{className:"text-center flex-1",children:[e.jsx("p",{className:"text-xs font-bold text-slate-700 mb-1",children:"توقيع الإدارة المالية"}),e.jsx("div",{className:"border-b border-slate-400 w-32 mx-auto mb-1"}),e.jsx("p",{className:"text-[8px] text-slate-500",children:"المحاسب المسؤول"})]}),e.jsxs("div",{className:"text-center flex-1",children:[e.jsx("p",{className:"text-sm font-bold text-slate-700 mb-2",children:"ختم الاعتماد"}),e.jsx("div",{className:"w-24 h-24 border-2 border-dashed border-slate-300 rounded-full mx-auto flex items-center justify-center bg-slate-50",children:e.jsx("p",{className:"text-xs text-slate-400 font-bold",children:"STAMP"})}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"تاريخ الاعتماد"})]})]})}),e.jsxs("div",{className:"absolute bottom-6 right-10 left-10 flex justify-between items-center text-[9px] text-slate-400 font-bold pt-5 border-t z-10",children:[e.jsxs("span",{className:"uppercase tracking-widest",children:["VERIFICATION ID: NB-",h.replace("_","-"),"-",Date.now().toString().slice(-6)]}),e.jsxs("span",{className:"uppercase tracking-widest",children:["Internal Audit Copy • ",o.name]}),e.jsx("span",{children:"Page 1 of 1"})]})]})]})]})};export{ms as default};
