import{r as p,j as e,X as R,N as U,h as z}from"./index-CH8mRu_9-v301.js";import{S as f}from"./shield-zA6GZuaa-v301.js";import{T as j}from"./trash-2-gL00B5Qr-v301.js";import{U as N}from"./user-plus-CYsQrYCE-v301.js";import{P as M}from"./pen-CLDoIvYH-v301.js";const _=({users:g,setUsers:h,deleteUser:b,currentUser:d,addAuditLog:u,employees:v})=>{const[w,r]=p.useState(!1),[n,c]=p.useState([]),[o,x]=p.useState(null),[l,a]=p.useState({username:"",password:"",name:"",role:"USER",permissions:[],employeeId:""}),y=s=>{s.preventDefault();let t=l.permissions;l.role==="BOOKING_EMPLOYEE"&&(t=["MANAGE_CUSTOMERS","MANAGE_SUPPLIERS","MANAGE_TREASURY","MANAGE_BOOKINGS","VIEW_REPORTS"]);const i={id:Date.now().toString(),...l,permissions:t};h(m=>[...m,i]),u("CREATE","SETTINGS",i.id,`إضافة مستخدم جديد: ${i.name} (@${i.username})`,void 0,i),r(!1),a({username:"",password:"",name:"",role:"USER",permissions:[],employeeId:""})},S=s=>{a(t=>({...t,permissions:(t.permissions||[]).includes(s)?(t.permissions||[]).filter(i=>i!==s):[...t.permissions||[],s]}))},E=s=>{x(s),a({username:s?.username||"",password:s?.password||"",name:s?.name||"",role:s?.role||"USER",permissions:s?.permissions||[],employeeId:s?.employeeId||""}),r(!0)},k=s=>{if(s.preventDefault(),!o)return;const t={...o,...l};h(i=>(i||[]).map(m=>m.id===o.id?t:m)),u("UPDATE","SETTINGS",o.id,`تعديل بيانات المستخدم: ${t.name} (@${t.username})`,o,t),r(!1),x(null),a({username:"",password:"",name:"",role:"USER",permissions:[],employeeId:""})},I=()=>{const s=(g||[]).filter(t=>t&&t.id!=="admin"&&t.id!==d?.id);n.length===s.length?c([]):c(s.map(t=>t.id))},A=s=>{c(t=>(t||[]).includes(s)?t.filter(i=>i!==s):[...t||[],s])},C=()=>{confirm(`هل أنت متأكد من حذف ${n.length} من المستخدمين المحددين؟`)&&(n.forEach(s=>b(s)),c([]))};return e.jsxs("div",{className:"space-y-8 pb-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center bg-white p-8 rounded-3xl shadow-sm border border-slate-200 gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-4 bg-slate-900 text-indigo-400 rounded-2xl shadow-lg shadow-slate-200",children:e.jsx(f,{size:24,strokeWidth:2})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"إدارة مستخدمي النظام"}),e.jsx("p",{className:"text-slate-500 font-medium text-xs mt-1",children:"التحكم في صلاحيات الوصول وأمن الحسابات"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[n.length>0&&e.jsxs("button",{onClick:C,className:"bg-rose-500 text-white px-8 py-3 rounded-xl font-bold text-sm flex items-center gap-3 shadow-lg hover:bg-rose-600 transition-all active:scale-95 animate-in zoom-in",children:[e.jsx(j,{size:18})," حذف (",n.length,")"]}),e.jsx("button",{onClick:I,className:"bg-slate-100 text-slate-900 px-8 py-3 rounded-xl font-bold text-sm flex items-center gap-3 hover:bg-slate-200 transition-all active:scale-95",children:n.length===g.filter(s=>s.id!=="admin"&&s.id!==d.id).length?"إلغاء تحديد الكل":"تحديد الكل"}),e.jsxs("button",{onClick:()=>r(!0),className:"bg-slate-900 text-white px-8 py-3 rounded-xl font-bold text-sm flex items-center gap-3 shadow-sm hover:bg-slate-800 transition-all active:scale-95",children:[e.jsx(N,{size:18}),"إضافة مستخدم جديد"]})]})]}),w&&e.jsxs("div",{className:"bg-white p-8 rounded-3xl border border-slate-200 border-b-4 border-b-slate-900 shadow-xl animate-in fade-in zoom-in duration-300",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-slate-900 text-indigo-400 rounded-xl",children:e.jsx(N,{size:20})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:o?"تعديل بيانات المستخدم":"إضافة مستخدم جديد للنظام"})]}),e.jsx("button",{onClick:()=>{r(!1),x(null),a({username:"",password:"",name:"",role:"USER",permissions:[],employeeId:""})},className:"w-10 h-10 flex items-center justify-center rounded-full bg-slate-50 text-slate-400 hover:bg-rose-500 hover:text-white transition-all duration-300",children:e.jsx(R,{size:20})})]}),e.jsxs("form",{onSubmit:o?k:y,className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 px-1 uppercase tracking-wider",children:"اسم الموظف"}),e.jsx("input",{required:!0,className:"p-3 bg-slate-50 border border-slate-200 rounded-xl font-bold text-slate-900 outline-none focus:ring-2 focus:ring-slate-900 ring-opacity-10 focus:border-slate-900 transition-all",value:l.name,onChange:s=>a({...l,name:s.target.value})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 px-1 uppercase tracking-wider",children:"اسم المستخدم"}),e.jsx("input",{required:!0,className:"p-3 bg-slate-50 border border-slate-200 rounded-xl font-bold text-slate-900 outline-none focus:ring-2 focus:ring-slate-900 ring-opacity-10 focus:border-slate-900 transition-all",value:l.username,onChange:s=>a({...l,username:s.target.value})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 px-1 uppercase tracking-wider",children:"كلمة المرور"}),e.jsx("input",{required:!0,type:"password",className:"p-3 bg-slate-50 border border-slate-200 rounded-xl font-bold text-slate-900 outline-none focus:ring-2 focus:ring-slate-900 ring-opacity-10 focus:border-slate-900 transition-all",value:l.password,onChange:s=>a({...l,password:s.target.value})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 px-1 uppercase tracking-wider",children:"الدور الوظيفي"}),e.jsxs("select",{className:"p-3 bg-slate-50 border border-slate-200 rounded-xl font-bold text-slate-900 outline-none focus:ring-2 focus:ring-slate-900 ring-opacity-10 focus:border-slate-900 transition-all",value:l.role,onChange:s=>a({...l,role:s.target.value}),children:[e.jsx("option",{value:"USER",className:"font-bold",children:"موظف عادي"}),e.jsx("option",{value:"BOOKING_EMPLOYEE",className:"font-bold",children:"موظف حجز"}),e.jsx("option",{value:"ADMIN",className:"font-bold",children:"مدير نظام (Full Access)"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 px-1 uppercase tracking-wider",children:"ربط بسجل موظف"}),e.jsxs("select",{className:"p-3 bg-slate-50 border border-slate-200 rounded-xl font-bold text-slate-900 outline-none focus:ring-2 focus:ring-slate-900 ring-opacity-10 focus:border-slate-900 transition-all",value:l.employeeId,onChange:s=>a({...l,employeeId:s.target.value}),children:[e.jsx("option",{value:"",children:"غير مرتبط"}),(v||[]).map(s=>e.jsx("option",{value:s?.id,children:s?.name},s?.id))]})]})]}),e.jsxs("div",{className:"space-y-4 pt-6 border-t border-slate-100",children:[e.jsxs("label",{className:"text-sm font-bold text-slate-900 block flex items-center gap-2",children:[e.jsx(f,{size:16,className:"text-indigo-600"}),"تحديد صلاحيات الوصول والعمليات"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:U.map(s=>e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-xl border transition-all cursor-pointer ${l.permissions.includes(s.id)?"bg-slate-900 text-indigo-400 border-slate-900 shadow-md":"bg-white border-slate-200 text-slate-500 hover:border-indigo-500 hover:bg-indigo-50 bg-opacity-30"}`,children:[e.jsx("input",{type:"checkbox",className:"hidden",checked:l.permissions.includes(s.id),onChange:()=>S(s.id)}),e.jsx("span",{className:"font-bold text-[10px] uppercase tracking-tighter",children:s.label})]},s.id))})]}),e.jsxs("div",{className:"flex justify-end pt-8 border-t border-slate-100 gap-4",children:[e.jsx("button",{type:"button",onClick:()=>{r(!1),x(null),a({username:"",password:"",name:"",role:"USER",permissions:[],employeeId:""})},className:"px-8 py-3 text-slate-400 font-bold hover:text-rose-600 transition-colors text-sm",children:"إلغاء"}),e.jsx("button",{type:"submit",className:"bg-slate-900 text-white px-12 py-3 rounded-xl font-bold text-sm shadow-lg hover:bg-indigo-600 transition-all active:scale-95",children:o?"تحديث بيانات المستخدم":"إصدار حساب مستخدم جديد"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:(g||[]).map(s=>e.jsxs("div",{className:`bg-white p-6 rounded-3xl shadow-sm border relative group transition-all duration-300 hover:border-indigo-200 overflow-hidden ${s?.id&&n.includes(s.id)?"ring-2 ring-indigo-500 border-indigo-500":"border-slate-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[s?.id&&s.id!=="admin"&&s.id!==d?.id&&e.jsx("input",{type:"checkbox",className:"w-5 h-5 accent-slate-900 rounded cursor-pointer",checked:n.includes(s.id),onChange:()=>A(s.id)}),e.jsx("div",{className:"w-12 h-12 bg-slate-50 text-slate-600 rounded-xl flex items-center justify-center group-hover:bg-indigo-600 group-hover:text-white transition-all duration-300",children:e.jsx(z,{size:24})})]}),e.jsxs("div",{className:"flex gap-1",children:[d?.role==="ADMIN"&&s?.id!==d?.id&&s?.id!=="admin"&&e.jsx("button",{onClick:()=>E(s),className:"p-2 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-all",title:"تعديل",children:e.jsx(M,{size:16})}),s?.id&&s.id!=="admin"&&e.jsx("button",{onClick:()=>b(s.id),className:"p-2 text-slate-400 hover:text-rose-600 hover:bg-rose-50 rounded-lg transition-all",title:"حذف",children:e.jsx(j,{size:16})})]})]}),e.jsx("h4",{className:"text-xl font-bold text-slate-900 tracking-tight",children:s?.name}),e.jsxs("p",{className:"text-[10px] font-bold text-indigo-600 uppercase tracking-widest mt-1",children:["@",s?.username," • ",s?.role]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-slate-50 flex flex-wrap gap-1.5",children:(s?.permissions||[]).map(t=>e.jsx("span",{className:"text-[9px] font-bold bg-slate-100 text-slate-500 px-2 py-0.5 rounded-md uppercase",children:t},t))})]},s?.id))})]})};export{_ as default};
